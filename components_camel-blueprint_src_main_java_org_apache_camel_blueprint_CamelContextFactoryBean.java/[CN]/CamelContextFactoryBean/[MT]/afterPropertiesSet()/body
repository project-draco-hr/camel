{
  super.afterPropertiesSet();
  ClassLoader cl=new BundleDelegatingClassLoader(((ExtendedBlueprintContainer)blueprintContainer).getBundleContext().getBundle());
  LOG.debug("Set the application context classloader to: {}",cl);
  getContext().setApplicationContextClassLoader(cl);
  getContext().getManagementStrategy().addEventNotifier(new OsgiCamelContextPublisher(bundleContext));
  try {
    getClass().getClassLoader().loadClass("org.osgi.service.event.EventAdmin");
    getContext().getManagementStrategy().addEventNotifier(new OsgiEventAdminNotifier(bundleContext));
  }
 catch (  Throwable t) {
    LOG.debug("EventAdmin package is not available, just don't use it");
  }
}
