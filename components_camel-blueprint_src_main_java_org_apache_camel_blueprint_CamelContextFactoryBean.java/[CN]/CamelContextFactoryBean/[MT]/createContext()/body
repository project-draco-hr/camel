{
  BlueprintCamelContext ctx=new BlueprintCamelContext();
  ctx.setName(getId());
  BundleContext bundleContext=FrameworkUtil.getBundle(this.getClass()).getBundleContext();
  OsgiServiceRegistry registry=new OsgiServiceRegistry(bundleContext);
  ctx.setRegistry(registry);
  OsgiCamelContextHelper.updateRegistry(ctx,bundleContext);
  ctx.setClassResolver(new OsgiClassResolver(bundleContext));
  ctx.setFactoryFinderResolver(new OsgiFactoryFinderResolver());
  ctx.setPackageScanClassResolver(new OsgiPackageScanClassResolver(bundleContext));
  ctx.setComponentResolver(new OsgiComponentResolver());
  ctx.setLanguageResolver(new OsgiLanguageResolver());
  OsgiAnnotationTypeConverterLoader typeConverterLoader=new OsgiAnnotationTypeConverterLoader(new OsgiPackageScanClassResolver(bundleContext));
  try {
    typeConverterLoader.load(ctx.getTypeConverterRegistry());
  }
 catch (  Exception e) {
    throw ObjectHelper.wrapRuntimeCamelException(e);
  }
  return ctx;
}
