{
  if (result instanceof DataSet) {
    DataSet dsResults=(DataSet)result;
    if (getEndpoint().isCollect()) {
      exchange.getIn().setBody(dsResults.collect());
    }
 else {
      exchange.getIn().setBody(result);
      exchange.getIn().setHeader(FlinkConstants.FLINK_DATASET_HEADER,result);
    }
  }
 else {
    exchange.getIn().setBody(result);
  }
}
