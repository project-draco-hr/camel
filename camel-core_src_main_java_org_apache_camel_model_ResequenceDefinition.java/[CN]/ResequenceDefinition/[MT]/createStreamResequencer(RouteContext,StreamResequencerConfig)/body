{
  Processor processor=this.createChildProcessor(routeContext,true);
  Expression expression=getExpression().createExpression(routeContext);
  ObjectHelper.notNull(config,"config",this);
  ObjectHelper.notNull(expression,"expression",this);
  ExpressionResultComparator comparator=config.getComparator();
  comparator.setExpression(expression);
  StreamResequencer resequencer=new StreamResequencer(routeContext.getCamelContext(),processor,comparator);
  resequencer.setTimeout(config.getTimeout());
  resequencer.setCapacity(config.getCapacity());
  if (config.getIgnoreInvalidExchanges() != null) {
    resequencer.setIgnoreInvalidExchanges(config.getIgnoreInvalidExchanges());
  }
  return resequencer;
}
