{
  boolean fixed=false;
  if (remaining.startsWith("fixed:")) {
    fixed=true;
    remaining=remaining.substring("fixed:".length());
  }
 else   if (remaining.startsWith("delim:")) {
    remaining=remaining.substring("delim:".length());
  }
 else {
    remaining="";
  }
  Resource resource=null;
  if (fixed) {
    resource=resolveMandatoryResource(remaining);
  }
 else {
    if (ObjectHelper.isNotEmpty(remaining)) {
      resource=getResourceLoader().getResource(remaining);
    }
  }
  if (log.isDebugEnabled()) {
    log.debug(this + " using flatpack map resource: " + resource);
  }
  FixedLengthEndpoint answer;
  if (fixed) {
    answer=new FixedLengthEndpoint(uri,resource);
  }
 else {
    answer=new DelimitedEndpoint(uri,resource);
  }
  answer.setCamelContext(getCamelContext());
  setProperties(answer,parameters);
  return answer;
}
