{
  InputStream is=exchange.getContext().getTypeConverter().convertTo(InputStream.class,graph);
  if (is == null) {
    throw new IllegalArgumentException("Cannot get the inputstream for ZipDataFormat mashalling");
  }
  DeflaterOutputStream zipOutput=new DeflaterOutputStream(stream,new Deflater(compressionLevel));
  try {
    IOConverter.copy(is,zipOutput);
  }
  finally {
    zipOutput.close();
  }
}
