{
  HttpContext context=conn.getContext();
  try {
    HttpResponse response=this.responseFactory.newHttpResponse(HttpVersion.HTTP_1_0,HttpStatus.SC_INTERNAL_SERVER_ERROR,context);
    response.setParams(this.params);
    handleException(httpex,response);
    response.setEntity(null);
    sendResponse(conn,response);
  }
 catch (  IOException ex) {
    shutdownConnection(conn,ex);
    if (this.eventListener != null) {
      this.eventListener.fatalIOException(ex,conn);
    }
  }
catch (  HttpException ex) {
    closeConnection(conn,ex);
    if (this.eventListener != null) {
      this.eventListener.fatalProtocolException(ex,conn);
    }
  }
}
