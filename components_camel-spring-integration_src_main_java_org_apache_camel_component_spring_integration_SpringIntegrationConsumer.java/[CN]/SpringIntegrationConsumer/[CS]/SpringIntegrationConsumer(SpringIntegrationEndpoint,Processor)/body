{
  super(endpoint,processor);
  this.endpoint=endpoint;
  context=(SpringCamelContext)endpoint.getCamelContext();
  if (context != null && endpoint.getMessageChannel() == null) {
    channelResolver=new BeanFactoryChannelResolver(context.getApplicationContext());
    inputChannelName=endpoint.getDefaultChannel();
    if (ObjectHelper.isEmpty(inputChannelName)) {
      inputChannelName=endpoint.getInputChannel();
    }
    if (!ObjectHelper.isEmpty(inputChannelName)) {
      inputChannel=(DirectChannel)channelResolver.resolveChannelName(inputChannelName);
      ObjectHelper.notNull(inputChannel,"The inputChannel with the name [" + inputChannelName + "]");
    }
 else {
      throw new RuntimeCamelException("Can't find the right inputChannelName, please check your configuration.");
    }
  }
 else {
    if (endpoint.getMessageChannel() != null) {
      inputChannel=(DirectChannel)endpoint.getMessageChannel();
    }
 else {
      throw new RuntimeCamelException("Can't find the right message channel, please check your configuration.");
    }
  }
  if (endpoint.isInOut()) {
    endpoint.setExchangePattern(ExchangePattern.InOut);
  }
}
