{
  super(endpoint,processor);
  this.endpoint=endpoint;
  context=(SpringCamelContext)endpoint.getCamelContext();
  if (context != null && endpoint.getMessageChannel() == null) {
    channelRegistry=(ChannelRegistry)context.getApplicationContext().getBean(MessageBusParser.MESSAGE_BUS_BEAN_NAME);
    inputChannelName=endpoint.getDefaultChannel();
    if (ObjectHelper.isNullOrBlank(inputChannelName)) {
      inputChannelName=endpoint.getInputChannel();
    }
    if (!ObjectHelper.isNullOrBlank(inputChannelName)) {
      inputChannel=(AbstractPollableChannel)channelRegistry.lookupChannel(inputChannelName);
      ObjectHelper.notNull(inputChannel,"The inputChannel with the name [" + inputChannelName + "]");
    }
 else {
      throw new RuntimeCamelException("Can't find the right inputChannelName, , please check your configuration.");
    }
  }
 else {
    if (endpoint.getMessageChannel() != null) {
      inputChannel=(AbstractPollableChannel)endpoint.getMessageChannel();
    }
 else {
      throw new RuntimeCamelException("Can't find the right message channel, please check your configuration.");
    }
  }
  if (endpoint.isInOut()) {
    endpoint.setExchangePattern(ExchangePattern.InOut);
  }
}
