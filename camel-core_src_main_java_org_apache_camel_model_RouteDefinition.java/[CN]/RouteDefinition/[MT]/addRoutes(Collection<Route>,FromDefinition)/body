{
  RouteContext routeContext=new DefaultRouteContext(getCamelContext(),this,fromType,routes);
  if (trace != null) {
    routeContext.setTracing(isTrace());
    if (isTrace()) {
      if (log.isDebugEnabled()) {
        log.debug("Tracing is enabled on route: " + this);
      }
    }
  }
  if (streamCache != null) {
    routeContext.setStreamCaching(isStreamCache());
    if (isStreamCache()) {
      if (log.isDebugEnabled()) {
        log.debug("StreamCaching is enabled on route: " + this);
      }
      if (StreamCaching.getStreamCaching(getCamelContext()) == null) {
        addInterceptStrategy(new StreamCaching());
      }
    }
  }
  if (handleFault != null) {
    routeContext.setHandleFault(isHandleFault());
    if (isHandleFault()) {
      if (log.isDebugEnabled()) {
        log.debug("HandleFault is enabled on route: " + this);
      }
      if (HandleFault.getHandleFault(getCamelContext()) == null) {
        addInterceptStrategy(new HandleFault());
      }
    }
  }
  if (delayer != null) {
    routeContext.setDelayer(getDelayer());
    if (getDelayer() != null) {
      long millis=getDelayer();
      if (millis > 0) {
        if (log.isDebugEnabled()) {
          log.debug("Delayer is enabled with: " + millis + " ms. on route: "+ this);
        }
        addInterceptStrategy(new Delayer(millis));
      }
 else {
        if (log.isDebugEnabled()) {
          log.debug("Delayer is disabled on route: " + this);
        }
      }
    }
  }
  if (routePolicy != null) {
    if (log.isDebugEnabled()) {
      log.debug("RoutePolicy is enabled: " + routePolicy + " on route: "+ this);
    }
    routeContext.setRoutePolicy(getRoutePolicy());
  }
 else   if (routePolicyRef != null) {
    RoutePolicy policy=CamelContextHelper.mandatoryLookup(getCamelContext(),routePolicyRef,RoutePolicy.class);
    if (log.isDebugEnabled()) {
      log.debug("RoutePolicy is enabled: " + policy + " on route: "+ this);
    }
    routeContext.setRoutePolicy(policy);
  }
  if (autoStartup != null) {
    if (log.isDebugEnabled()) {
      log.debug("Using AutoStartup " + isAutoStartup() + " on route: "+ this);
    }
    routeContext.setAutoStartup(isAutoStartup());
  }
  if (shutdownRoute != null) {
    if (log.isDebugEnabled()) {
      log.debug("Using ShutdownRoute " + getShutdownRoute() + " on route: "+ this);
    }
    routeContext.setShutdownRoute(getShutdownRoute());
  }
  if (shutdownRunningTask != null) {
    if (log.isDebugEnabled()) {
      log.debug("Using ShutdownRunningTask " + getShutdownRunningTask() + " on route: "+ this);
    }
    routeContext.setShutdownRunningTask(getShutdownRunningTask());
  }
  routeContext.setInterceptStrategies(this.getInterceptStrategies());
  routeContext.getEndpoint();
  if (camelContext != null) {
    for (    LifecycleStrategy strategy : camelContext.getLifecycleStrategies()) {
      strategy.onRouteContextCreate(routeContext);
    }
  }
  if (!ProcessorDefinitionHelper.hasOutputs(outputs,true)) {
    RouteDefinition route=routeContext.getRoute();
    String at=fromType.toString();
    Exception cause=new IllegalArgumentException("Route " + route.getId() + " has no output processors."+ " You need to add outputs to the route such as to(\"log:foo\").");
    throw new FailedToCreateRouteException(route.getId(),route.toString(),at,cause);
  }
  List<ProcessorDefinition> list=new ArrayList<ProcessorDefinition>(outputs);
  for (  ProcessorDefinition output : list) {
    try {
      output.addRoutes(routeContext,routes);
    }
 catch (    Exception e) {
      RouteDefinition route=routeContext.getRoute();
      throw new FailedToCreateRouteException(route.getId(),route.toString(),output.toString(),e);
    }
  }
  routeContext.commit();
  return routeContext;
}
