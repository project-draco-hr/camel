{
  if (optimistic) {
    throw new UnsupportedOperationException();
  }
  LOG.trace("Adding an Exchange with ID {} for key {} in a thread-safe manner.",exchange.getExchangeId(),key);
  DefaultExchangeHolder newHolder=DefaultExchangeHolder.marshal(exchange,true,allowSerializedHeaders);
  DefaultExchangeHolder oldHolder=cache.getAndPut(key,newHolder);
  return unmarshallExchange(camelContext,oldHolder);
}
