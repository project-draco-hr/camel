{
  if (type == null) {
    ObjectHelper.notNull(ref,"ref or dataFormat");
    return routeContext.getCamelContext().resolveDataFormat(ref);
  }
 else {
    return type.createDataFormat(routeContext);
  }
}
