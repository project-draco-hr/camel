{
  Processor prepared=producer;
  Exchange copy=ExchangeHelper.createCorrelatedCopy(exchange,false);
  if (isShareUnitOfWork()) {
    prepareSharedUnitOfWork(copy,exchange);
  }
  setToEndpoint(copy,prepared);
  RouteContext routeContext=exchange.getUnitOfWork() != null ? exchange.getUnitOfWork().getRouteContext() : null;
  prepared=createErrorHandler(routeContext,copy,prepared);
  if (onPrepare != null) {
    try {
      onPrepare.process(copy);
    }
 catch (    Exception e) {
      copy.setException(e);
    }
  }
  return new RecipientProcessorExchangePair(index,producerCache,endpoint,producer,prepared,copy,pattern);
}
