{
  ApplicationContext applicationContext=contextRefreshedEvent.getApplicationContext();
  if (applicationContext.getParent() == null) {
    CamelContext camelContext=contextRefreshedEvent.getApplicationContext().getBean(CamelContext.class);
    LOG.debug("Post-processing CamelContext bean: {}",camelContext.getName());
    for (    RoutesBuilder routesBuilder : applicationContext.getBeansOfType(RoutesBuilder.class).values()) {
      try {
        LOG.debug("Injecting following route into the CamelContext: {}",routesBuilder);
        camelContext.addRoutes(routesBuilder);
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
    loadXmlRoutes(applicationContext,camelContext);
    if (camelContextConfigurations != null) {
      for (      CamelContextConfiguration camelContextConfiguration : camelContextConfigurations) {
        LOG.debug("CamelContextConfiguration found. Invoking: {}",camelContextConfiguration);
        camelContextConfiguration.beforeApplicationStart(camelContext);
      }
    }
    try {
      camelContext.start();
    }
 catch (    Exception e) {
      throw new CamelSpringBootInitializationException(e);
    }
  }
 else {
    LOG.debug("Not at root context - defer adding routes");
  }
}
