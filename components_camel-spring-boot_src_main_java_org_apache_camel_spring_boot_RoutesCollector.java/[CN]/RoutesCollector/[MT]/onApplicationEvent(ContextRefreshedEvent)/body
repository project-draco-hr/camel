{
  ApplicationContext applicationContext=contextRefreshedEvent.getApplicationContext();
  CamelContext camelContext=contextRefreshedEvent.getApplicationContext().getBean(CamelContext.class);
  if (camelContext.getStatus() == ServiceStatus.Stopped) {
    LOG.debug("Post-processing CamelContext bean: {}",camelContext.getName());
    for (    RoutesBuilder routesBuilder : applicationContext.getBeansOfType(RoutesBuilder.class).values()) {
      try {
        LOG.debug("Injecting following route into the CamelContext: {}",routesBuilder);
        camelContext.addRoutes(routesBuilder);
      }
 catch (      Exception e) {
        throw new CamelSpringBootInitializationException(e);
      }
    }
    try {
      loadXmlRoutes(applicationContext,camelContext);
      for (      CamelContextConfiguration camelContextConfiguration : camelContextConfigurations) {
        LOG.debug("CamelContextConfiguration found. Invoking: {}",camelContextConfiguration);
        camelContextConfiguration.beforeApplicationStart(camelContext);
      }
      camelContext.start();
    }
 catch (    Exception e) {
      throw new CamelSpringBootInitializationException(e);
    }
  }
 else {
    LOG.debug("Camel already started, not adding routes.");
  }
}
