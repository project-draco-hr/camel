{
  Consumer result=new FileConsumer(this,processor);
  if (isIdempotent() && idempotentRepository == null) {
    LOG.info("Using default memory based idempotent repository with cache max size: " + DEFAULT_IDEMPOTENT_CACHE_SIZE);
    idempotentRepository=MemoryMessageIdRepository.memoryMessageIdRepository(DEFAULT_IDEMPOTENT_CACHE_SIZE);
  }
  configureConsumer(result);
  return result;
}
