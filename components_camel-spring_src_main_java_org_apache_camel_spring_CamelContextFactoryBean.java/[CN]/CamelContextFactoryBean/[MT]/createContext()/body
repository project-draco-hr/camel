{
  SpringCamelContext ctx=new SpringCamelContext(getApplicationContext());
  ctx.setName(getId());
  if (trace != null) {
    ctx.setTrace(trace);
  }
  if (errorHandlerRef != null) {
    ErrorHandlerBuilder errorHandlerBuilder=(ErrorHandlerBuilder)getApplicationContext().getBean(errorHandlerRef,ErrorHandlerBuilder.class);
    if (errorHandlerBuilder == null) {
      throw new IllegalArgumentException("Could not find bean: " + errorHandlerRef);
    }
    ctx.setErrorHandlerBuilder(errorHandlerBuilder);
  }
  return ctx;
}
