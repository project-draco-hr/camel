{
  PackageScanClassResolver resolver=getContext().getPackageScanClassResolver();
  addPackageElementContentsToScanDefinition();
  PackageScanDefinition packageScanDef=getPackageScan();
  if (packageScanDef != null && packageScanDef.getPackages().size() > 0) {
    PatternBasedPackageScanFilter filter=new PatternBasedPackageScanFilter();
    for (    String include : packageScanDef.getIncludes()) {
      include=getContext().resolvePropertyPlaceholders(include);
      filter.addIncludePattern(include);
    }
    for (    String exclude : packageScanDef.getExcludes()) {
      exclude=getContext().resolvePropertyPlaceholders(exclude);
      filter.addExcludePattern(exclude);
    }
    resolver.addFilter(filter);
    String[] normalized=normalizePackages(getContext(),packageScanDef.getPackages());
    RouteBuilderFinder finder=new RouteBuilderFinder(getContext(),normalized,getContextClassLoaderOnStart(),getBeanPostProcessor(),getContext().getPackageScanClassResolver());
    finder.appendBuilders(builders);
  }
}
