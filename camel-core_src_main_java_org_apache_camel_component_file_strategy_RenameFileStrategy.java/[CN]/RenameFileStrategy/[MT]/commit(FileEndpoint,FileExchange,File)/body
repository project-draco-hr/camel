{
  File parent=file.getParentFile();
  String name=getNamePrefix() + file.getName() + getNamePostfix();
  File newName=new File(parent,name);
  newName.getParentFile().mkdirs();
  if (log.isDebugEnabled()) {
    log.debug("Renaming file: " + file + " to: "+ newName);
  }
  boolean renamed=file.renameTo(newName);
  if (!renamed) {
    throw new IOException("Could not rename file from: " + file + " to "+ newName);
  }
  super.commit(endpoint,exchange,file);
}
