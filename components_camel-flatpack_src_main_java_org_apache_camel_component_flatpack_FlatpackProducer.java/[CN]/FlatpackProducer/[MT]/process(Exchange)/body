{
  Parser parser=endpoint.createParser(exchange);
  DataSet dataSet=parser.parse();
  if (endpoint.isSplitRows()) {
    int counter=0;
    while (dataSet.next()) {
      endpoint.processDataSet(exchange,dataSet,counter++);
    }
  }
 else {
    endpoint.processDataSet(exchange,dataSet,dataSet.getRowCount());
  }
}
