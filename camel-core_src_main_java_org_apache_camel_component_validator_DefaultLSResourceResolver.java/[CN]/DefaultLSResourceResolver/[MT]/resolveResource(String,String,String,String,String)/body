{
  if (systemId == null) {
    throw new IllegalArgumentException(String.format("Resource: %s refers an invalid resource without SystemId." + " Invalid resource has type: %s, namespaceURI: %s, publicId: %s, systemId: %s, baseURI: %s",resourceUri,type,namespaceURI,publicId,systemId,baseURI));
  }
  String relatedPath=null;
  if (baseURI == null) {
    relatedURI=getUri(systemId);
    relatedPath=relatedURI.intern();
  }
 else {
    relatedPath=relatedURIMap.get(baseURI);
    if (relatedPath == null) {
      relatedURI=FileUtil.onlyPath(relatedURI) + "/" + systemId;
      relatedPath=relatedURI.intern();
      relatedURIMap.put(baseURI,relatedPath);
    }
 else {
      relatedPath=FileUtil.onlyPath(relatedPath) + "/" + systemId;
    }
  }
  return new DefaultLSInput(publicId,systemId,baseURI,relatedPath);
}
