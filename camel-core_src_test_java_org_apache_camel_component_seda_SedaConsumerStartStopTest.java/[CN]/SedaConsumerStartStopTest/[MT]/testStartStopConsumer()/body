{
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedMessageCount(20);
  mock.expectsAscending(body());
  initRoute();
  sendMessagesToQueue();
  consumer.start();
  for (int i=0; i < 20; i++) {
    if (i == 10) {
      consumer.stop();
      Thread.sleep(900);
      consumer.start();
    }
    Exchange exchange=consumer.receive(1000);
    template.send("mock:result",exchange);
  }
  assertMockEndpointsSatisfied();
}
