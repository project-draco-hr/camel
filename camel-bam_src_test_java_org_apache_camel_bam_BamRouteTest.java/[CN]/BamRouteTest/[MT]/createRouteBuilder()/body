{
  jpaTemplate=getMandatoryBean(JpaTemplate.class,"jpaTemplate");
  transactionTemplate=getMandatoryBean(TransactionTemplate.class,"transactionTemplate");
  return new ProcessBuilder(jpaTemplate,transactionTemplate){
    public void configure() throws Exception {
      ActivityBuilder a=activity("direct:a").name("a").correlate(header("foo"));
      ActivityBuilder b=activity("direct:b").name("b").correlate(header("foo"));
      ActivityBuilder c=activity("direct:c").name("c").correlate(header("foo"));
      b.starts().after(a.completes()).expectWithin(seconds(1)).errorIfOver(seconds(2)).to("mock:overdue");
    }
  }
;
}
