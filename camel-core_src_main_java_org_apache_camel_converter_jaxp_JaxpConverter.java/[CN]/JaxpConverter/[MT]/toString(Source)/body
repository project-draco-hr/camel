{
  if (source == null) {
    return null;
  }
 else   if (source instanceof StringSource) {
    return ((StringSource)source).getText();
  }
 else   if (source instanceof BytesSource) {
    return new String(((BytesSource)source).getData());
  }
 else {
    StringWriter buffer=new StringWriter();
    toResult(source,new StreamResult(buffer));
    return buffer.toString();
  }
}
