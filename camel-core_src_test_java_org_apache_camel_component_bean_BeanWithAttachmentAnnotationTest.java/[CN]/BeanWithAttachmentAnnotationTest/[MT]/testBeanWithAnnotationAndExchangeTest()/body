{
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedBodiesReceived("attachment");
  template.send("direct:in",new Processor(){
    public void process(    Exchange exchange) throws Exception {
      exchange.setPattern(ExchangePattern.InOut);
      Message m=exchange.getIn();
      m.addAttachment("attachment",new DataHandler(new FileDataSource("src/test/org/apache/camel/component/bean/BeanWithAttachmentAnnotationTest.java")));
    }
  }
);
  mock.assertIsSatisfied();
}
