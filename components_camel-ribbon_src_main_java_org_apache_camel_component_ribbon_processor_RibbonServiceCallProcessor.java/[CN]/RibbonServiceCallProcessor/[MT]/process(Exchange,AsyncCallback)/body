{
  Server server=null;
  try {
    server=ribbonLoadBalancer.chooseServer();
    if (server == null) {
      exchange.setException(new RejectedExecutionException("No active services with name " + name));
    }
  }
 catch (  Throwable e) {
    exchange.setException(e);
  }
  if (exchange.getException() != null) {
    callback.done(true);
    return true;
  }
  String ip=server.getHost();
  int port=server.getPort();
  LOG.debug("Service {} active at server: {}:{}",name,ip,port);
  exchange.getIn().setHeader(ServiceCallConstants.SERVER_IP,ip);
  exchange.getIn().setHeader(ServiceCallConstants.SERVER_PORT,port);
  exchange.getIn().setHeader(ServiceCallConstants.SERVICE_NAME,name);
  return processor.process(exchange,callback);
}
