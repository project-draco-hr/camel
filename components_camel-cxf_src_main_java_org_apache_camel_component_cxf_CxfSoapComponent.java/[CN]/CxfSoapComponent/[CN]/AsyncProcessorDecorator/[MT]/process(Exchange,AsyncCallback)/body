{
  try {
    before.process(exchange);
  }
 catch (  Throwable t) {
    exchange.setException(t);
    callback.done(true);
    return true;
  }
  return processor.process(exchange,new AsyncCallback(){
    public void done(    boolean doneSynchronously){
      try {
        after.process(exchange);
        callback.done(doneSynchronously);
      }
 catch (      Throwable t) {
        exchange.setException(t);
      }
    }
  }
);
}
