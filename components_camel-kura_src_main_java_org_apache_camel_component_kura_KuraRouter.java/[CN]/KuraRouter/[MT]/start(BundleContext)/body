{
  try {
    this.bundleContext=bundleContext;
    log.debug("Initializing bundle {}.",bundleContext.getBundle().getBundleId());
    camelContext=createCamelContext();
    camelContext.addRoutes(this);
    beforeStart(camelContext);
    log.debug("About to start Camel Kura router: {}",getClass().getName());
    camelContext.start();
    producerTemplate=camelContext.createProducerTemplate();
    log.debug("Bundle {} started.",bundleContext.getBundle().getBundleId());
  }
 catch (  Throwable e) {
    String errorMessage="Problem when starting Kura module " + getClass().getName() + ":";
    log.warn(errorMessage,e);
    System.err.println(errorMessage);
    e.printStackTrace();
    throw e;
  }
}
