{
  int count=totalCount.decrementAndGet();
  LOG.trace("Total {} inflight exchanges. Last removed: {}",count,exchange.getExchangeId());
  if (exchange.getFromEndpoint() == null) {
    return;
  }
  String key=exchange.getFromEndpoint().getEndpointKey();
synchronized (endpointCount) {
    AtomicInteger existing=endpointCount.get(key);
    if (existing != null) {
      if (existing.decrementAndGet() <= 0) {
        endpointCount.remove(key);
      }
    }
  }
}
