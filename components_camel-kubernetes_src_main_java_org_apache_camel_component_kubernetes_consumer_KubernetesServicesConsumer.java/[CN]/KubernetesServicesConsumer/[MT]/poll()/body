{
  int mapSize=map.size();
  for (  ConcurrentMap.Entry<Long,ServiceEvent> entry : map.entrySet()) {
    ServiceEvent serviceEvent=(ServiceEvent)entry.getValue();
    Exchange e=getEndpoint().createExchange();
    e.getIn().setBody(serviceEvent.getService());
    e.getIn().setHeader(KubernetesConstants.KUBERNETES_EVENT_ACTION,serviceEvent.getAction());
    e.getIn().setHeader(KubernetesConstants.KUBERNETES_EVENT_TIMESTAMP,entry.getKey());
    getProcessor().process(e);
    map.remove(entry.getKey());
  }
  return mapSize;
}
