{
  String ssn=exchange.getIn().getHeader(Constants.PROPERTY_SSN,String.class);
  Integer historyLength=exchange.getIn().getHeader(Constants.PROPERTY_HISTORYLENGTH,Integer.class);
  double rate=primeRate + (double)(historyLength / 12) / 10 + (double)(Math.random() * 10) / 10;
  LOG.info("The bank: " + bankName + " for client: "+ ssn+ " 's rate "+ rate);
  exchange.getOut().setHeader(Constants.PROPERTY_RATE,new Double(rate));
  exchange.getOut().setHeader(Constants.PROPERTY_BANK,bankName);
  exchange.getOut().setHeader(Constants.PROPERTY_SSN,ssn);
  exchange.getOut().setBody("Bank processed the request.");
  try {
    Thread.sleep((int)(Math.random() * 10) * 100);
  }
 catch (  InterruptedException e) {
  }
}
