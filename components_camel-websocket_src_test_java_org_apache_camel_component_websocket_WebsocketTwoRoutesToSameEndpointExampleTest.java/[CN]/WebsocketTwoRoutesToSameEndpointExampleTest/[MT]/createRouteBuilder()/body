{
  return new RouteBuilder(){
    public void configure(){
      WebsocketComponent websocketComponent=(WebsocketComponent)context.getComponent("websocket");
      websocketComponent.setMinThreads(1);
      websocketComponent.setMaxThreads(11);
      from("websocket://localhost:" + port + "/bar").log(">>> Message received from BAR WebSocket Client : ${body}").transform().simple("The bar has ${body}").to("websocket://localhost:" + port + "/bar");
      from("timer://foo?fixedRate=true&period=12000").setBody(constant("Broadcasting to Bar")).log(">>> Broadcasting message to Bar WebSocket Client").to("websocket://localhost:" + port + "/bar?sendToAll=true");
    }
  }
;
}
