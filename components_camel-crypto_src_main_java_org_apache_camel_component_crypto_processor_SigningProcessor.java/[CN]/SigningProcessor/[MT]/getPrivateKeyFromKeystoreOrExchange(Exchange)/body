{
  PrivateKey pk=config.getPrivateKey(getAlias(exchange),getKeyPassword(exchange));
  if (pk == null) {
    pk=exchange.getIn().getHeader(DigitalSignatureConstants.SIGNATURE_PRIVATE_KEY,PrivateKey.class);
    if (pk == null) {
      throw new IllegalStateException(format("Cannot sign message as no Private Key has been supplied. " + "Either supply one in the route definition sign(keystore, alias) or sign(privateKey) " + "or via the message header '%s'",DigitalSignatureConstants.SIGNATURE_PRIVATE_KEY));
    }
  }
  return pk;
}
