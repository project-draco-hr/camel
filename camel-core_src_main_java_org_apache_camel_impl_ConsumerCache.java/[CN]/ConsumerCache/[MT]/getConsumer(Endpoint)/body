{
  String key=endpoint.getEndpointUri();
  PollingConsumer answer=consumers.get(key);
  if (answer == null) {
    try {
      answer=endpoint.createPollingConsumer();
      answer.start();
    }
 catch (    Exception e) {
      throw new FailedToCreateConsumerException(endpoint,e);
    }
    boolean singleton=true;
    if (answer instanceof IsSingleton) {
      singleton=((IsSingleton)answer).isSingleton();
    }
    if (singleton) {
      LOG.debug("Adding to consumer cache with key: {} for consumer: {}",endpoint,answer);
      consumers.put(key,answer);
    }
 else {
      LOG.debug("Consumer for endpoint: {} is not singleton and thus not added to consumer cache",key);
    }
  }
  return answer;
}
