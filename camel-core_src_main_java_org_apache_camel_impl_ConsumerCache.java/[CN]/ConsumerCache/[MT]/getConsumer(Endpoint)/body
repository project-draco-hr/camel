{
  String key=endpoint.getEndpointUri();
  PollingConsumer answer=consumers.get(key);
  if (answer == null) {
    try {
      answer=endpoint.createPollingConsumer();
      answer.start();
    }
 catch (    Exception e) {
      throw new FailedToCreateConsumerException(endpoint,e);
    }
    boolean singleton=true;
    if (answer instanceof IsSingleton) {
      singleton=((IsSingleton)answer).isSingleton();
    }
    if (singleton) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Adding to consumer cache with key: " + endpoint + " for consumer: "+ answer);
      }
      consumers.put(key,answer);
    }
 else {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Consumer for endpoint: " + key + " is not singleton and thus not added to consumer cache");
      }
    }
  }
  return answer;
}
