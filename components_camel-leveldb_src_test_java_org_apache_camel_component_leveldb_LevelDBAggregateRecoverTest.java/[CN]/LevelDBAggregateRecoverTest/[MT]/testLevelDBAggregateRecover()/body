{
  getMockEndpoint("mock:aggregated").expectedMessageCount(3);
  getMockEndpoint("mock:result").expectedBodiesReceived("ABCDE");
  getMockEndpoint("mock:result").message(0).header(Exchange.REDELIVERED).isEqualTo(Boolean.TRUE);
  getMockEndpoint("mock:result").message(0).header(Exchange.REDELIVERY_COUNTER).isEqualTo(2);
  template.sendBodyAndHeader("direct:start","A","id",123);
  template.sendBodyAndHeader("direct:start","B","id",123);
  template.sendBodyAndHeader("direct:start","C","id",123);
  template.sendBodyAndHeader("direct:start","D","id",123);
  template.sendBodyAndHeader("direct:start","E","id",123);
  assertMockEndpointsSatisfied(30,TimeUnit.SECONDS);
}
