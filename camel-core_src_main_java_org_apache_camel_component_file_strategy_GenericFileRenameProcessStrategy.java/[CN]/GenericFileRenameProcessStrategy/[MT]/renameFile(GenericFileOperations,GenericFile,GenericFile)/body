{
  try {
    operations.deleteFile(to.getAbsoluteFileName());
  }
 catch (  GenericFileOperationFailedException e) {
  }
  String parent=to.getParent();
  boolean mkdir=operations.buildDirectory(parent);
  if (!mkdir) {
    throw new GenericFileOperationFailedException("Cannot create directory: " + parent + " (could be because of denied permissions)");
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Renaming file: " + from + " to: "+ to);
  }
  boolean renamed=operations.renameFile(from.getAbsoluteFileName(),to.getAbsoluteFileName());
  if (!renamed) {
    throw new GenericFileOperationFailedException("Cannot rename file: " + from + " to: "+ to);
  }
  return to;
}
