{
  try {
    operations.deleteFile(to.getAbsoluteFileName());
  }
 catch (  GenericFileOperationFailedException e) {
  }
  boolean mkdir=operations.buildDirectory(to.getParent(),true);
  if (!mkdir) {
    throw new GenericFileOperationFailedException("Cannot create directory: " + to.getParent() + " (could be because of denied permissions)");
  }
  if (log.isDebugEnabled()) {
    log.debug("Renaming file: " + from + " to: "+ to);
  }
  boolean renamed=operations.renameFile(from.getAbsoluteFileName(),to.getAbsoluteFileName());
  if (!renamed) {
    throw new GenericFileOperationFailedException("Cannot rename file: " + from + " to: "+ to);
  }
  return to;
}
