{
  Object attachements=message.get(CxfConstants.CAMEL_CXF_ATTACHMENTS);
  if (attachements != null) {
    message.setAttachments((Collection<Attachment>)attachements);
    message.remove(CxfConstants.CAMEL_CXF_ATTACHMENTS);
  }
  if (DataFormat.PAYLOAD == message.get(DataFormat.class)) {
    CxfPayload<?> payload=(CxfPayload<?>)params[0];
    List<Element> elements=payload.getBody();
    BindingOperationInfo boi=message.get(BindingOperationInfo.class);
    MessageContentsList content=new MessageContentsList();
    int i=0;
    for (    MessagePartInfo partInfo : boi.getOperationInfo().getInput().getMessageParts()) {
      if (elements.size() > i && partInfo.getConcreteName().getLocalPart().equals(elements.get(i).getLocalName())) {
        content.put(partInfo,elements.get(i++));
      }
    }
    if (content.size() < elements.size()) {
      LOG.warn("Cannot set right payload paremeters. Please check the BindingOperation and PayLoadMessage.");
      throw new IllegalArgumentException("The PayLoad elements cannot fit with the message parts of the BindingOperation. Please check the BindingOperation and PayLoadMessage.");
    }
    message.setContent(List.class,content);
    message.put(Header.HEADER_LIST,payload.getHeaders());
  }
 else {
    super.setParameters(params,message);
  }
  message.remove(DataFormat.class);
}
