{
  int total=10000;
  final int group=total / 20;
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedMessageCount(total);
  ThreadPoolTaskExecutor executor=new ThreadPoolTaskExecutor();
  executor.setCorePoolSize(20);
  executor.afterPropertiesSet();
  for (int i=0; i < 20; i++) {
    final int threadCount=i;
    executor.execute(new Runnable(){
      public void run(){
        int start=threadCount * group;
        for (int i=0; i < group; i++) {
          try {
            Thread.sleep(new Random().nextInt(10));
          }
 catch (          InterruptedException e) {
          }
          template.sendBody("seda:in?size=10000","" + (start + i));
        }
      }
    }
);
  }
  mock.assertIsSatisfied();
  mock.expectsNoDuplicates(body());
}
