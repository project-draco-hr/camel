{
  getMockEndpoint("mock:result").expectedMessageCount(10);
  for (int i=0; i < 10; i++) {
    if (i % 2 == 0) {
      template.sendBody("seda:foo","Hello " + i);
    }
 else {
      template.sendBody("seda:bar","Hello " + i);
    }
  }
  assertMockEndpointsSatisfied();
  assertEquals(8,registry.getNames().size());
  Set<ObjectName> set=getMBeanServer().queryNames(new ObjectName("org.apache.camel.metrics:*"),null);
  assertEquals(8,set.size());
}
