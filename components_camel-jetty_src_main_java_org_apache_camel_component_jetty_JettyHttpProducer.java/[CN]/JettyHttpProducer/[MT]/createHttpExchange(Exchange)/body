{
  String url=HttpProducerHelper.createURL(exchange,getEndpoint());
  HttpMethods methodToUse=HttpProducerHelper.createMethod(exchange,getEndpoint(),exchange.getIn().getBody() != null);
  String method=methodToUse.createMethod(url).getName();
  JettyContentExchange httpExchange=new JettyContentExchange();
  httpExchange.setMethod(method);
  httpExchange.setURL(url);
  doSetQueryParameters(exchange,httpExchange);
  Message in=exchange.getIn();
  HeaderFilterStrategy strategy=getEndpoint().getHeaderFilterStrategy();
  for (  String headerName : in.getHeaders().keySet()) {
    String headerValue=in.getHeader(headerName,String.class);
    if (strategy != null && !strategy.applyFilterToCamelHeaders(headerName,headerValue,exchange)) {
      httpExchange.addRequestHeader(headerName,headerValue);
    }
  }
  return httpExchange;
}
