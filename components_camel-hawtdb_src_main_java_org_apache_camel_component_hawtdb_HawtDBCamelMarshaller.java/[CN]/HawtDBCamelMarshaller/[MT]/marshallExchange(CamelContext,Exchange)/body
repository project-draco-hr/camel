{
  DataByteArrayOutputStream baos=new DataByteArrayOutputStream();
  DefaultExchangeHolder pe=DefaultExchangeHolder.marshal(exchange,false);
  DefaultExchangeHolder.addProperty(pe,Exchange.AGGREGATED_SIZE,exchange.getProperty(Exchange.AGGREGATED_SIZE,Integer.class));
  DefaultExchangeHolder.addProperty(pe,Exchange.AGGREGATED_COMPLETED_BY,exchange.getProperty(Exchange.AGGREGATED_COMPLETED_BY,String.class));
  DefaultExchangeHolder.addProperty(pe,Exchange.AGGREGATED_CORRELATION_KEY,exchange.getProperty(Exchange.AGGREGATED_CORRELATION_KEY,Serializable.class));
  if (exchange.getFromEndpoint() != null) {
    DefaultExchangeHolder.addProperty(pe,"CamelAggregatedFromEndpoint",exchange.getFromEndpoint().getEndpointUri());
  }
  exchangeMarshaller.writePayload(pe,baos);
  return baos.toBuffer();
}
