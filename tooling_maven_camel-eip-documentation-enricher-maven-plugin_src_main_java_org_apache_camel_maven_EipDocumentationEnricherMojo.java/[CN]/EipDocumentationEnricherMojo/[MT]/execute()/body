{
  Set<String> injectedTypes=new HashSet<>();
  File rootDir=new File(camelCoreDir,Constants.PATH_TO_MODEL_DIR);
  DomFinder domFinder=new DomFinder();
  DocumentationEnricher documentationEnricher=new DocumentationEnricher();
  Map<String,File> jsonFiles=PackageHelper.findJsonFiles(rootDir);
  XPath xPath=buildXPath(new CamelSpringNamespace());
  Document document=buildNamespaceAwareDocument(inputCamelSchemaFile);
  try {
    NodeList elementsAndTypes=domFinder.findElementsAndTypes(document,xPath);
    documentationEnricher.enrichTopLevelElementsDocumentation(document,elementsAndTypes,jsonFiles);
    Map<String,String> typeToNameMap=buildTypeToNameMap(elementsAndTypes);
    for (    Map.Entry<String,String> entry : typeToNameMap.entrySet()) {
      String elementType=entry.getKey();
      String elementName=entry.getValue();
      if (jsonFileExistsForElement(jsonFiles,elementName)) {
        injectAttributesDocumentation(domFinder,documentationEnricher,jsonFiles.get(elementName),xPath,document,elementType,injectedTypes);
      }
    }
    saveToFile(document,outputCamelSchemaFile,buildTransformer());
  }
 catch (  XPathExpressionException|IOException e) {
    throw new MojoExecutionException("Error during documentation enrichment",e);
  }
}
