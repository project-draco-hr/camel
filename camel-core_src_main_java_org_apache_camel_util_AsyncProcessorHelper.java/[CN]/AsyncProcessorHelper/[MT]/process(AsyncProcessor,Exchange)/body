{
  final CountDownLatch latch=new CountDownLatch(1);
  boolean sync=processor.process(exchange,new AsyncCallback(){
    public void done(    boolean doneSync){
      if (!doneSync) {
        if (LOG.isWarnEnabled()) {
          LOG.warn("Asynchronous callback received for exchangeId: " + exchange.getExchangeId());
        }
        latch.countDown();
      }
    }
    @Override public String toString(){
      return "Done " + processor;
    }
  }
);
  if (!sync) {
    if (LOG.isWarnEnabled()) {
      LOG.warn("Waiting for asynchronous callback before continuing for exchangeId: " + exchange.getExchangeId());
    }
    latch.await();
  }
}
