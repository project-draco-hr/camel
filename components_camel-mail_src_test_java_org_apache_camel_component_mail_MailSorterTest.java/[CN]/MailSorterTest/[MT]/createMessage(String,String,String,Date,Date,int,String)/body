{
  final Message msg=Mockito.mock(Message.class);
  when(msg.getFrom()).thenReturn(new Address[]{new InternetAddress(from)});
  when(msg.getRecipients(Message.RecipientType.TO)).thenReturn(new Address[]{new InternetAddress(to)});
  when(msg.getRecipients(Message.RecipientType.CC)).thenReturn(new Address[]{new InternetAddress(cc)});
  when(msg.getSentDate()).thenReturn(sent);
  when(msg.getReceivedDate()).thenReturn(received);
  when(msg.getSize()).thenReturn(size);
  when(msg.getSubject()).thenReturn(subject);
  return msg;
}
