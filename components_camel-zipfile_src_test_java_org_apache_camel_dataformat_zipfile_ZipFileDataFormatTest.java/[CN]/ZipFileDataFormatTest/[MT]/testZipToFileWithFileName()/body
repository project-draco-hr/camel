{
  NotifyBuilder notify=new NotifyBuilder(context).whenDone(1).create();
  MockEndpoint mock=getMockEndpoint("mock:zipToFile");
  mock.expectedMessageCount(1);
  File file=new File(TEST_DIR,"poem.txt.zip");
  assertFalse(file.exists());
  template.sendBodyAndHeader("direct:zipToFile",TEXT,FILE_NAME,"poem.txt");
  mock.assertIsSatisfied();
  assertTrue(notify.matches(5,TimeUnit.SECONDS));
  assertTrue(file.exists());
  assertTrue(ObjectHelper.equalByteArray(getZippedText("poem.txt"),getBytes(file)));
}
