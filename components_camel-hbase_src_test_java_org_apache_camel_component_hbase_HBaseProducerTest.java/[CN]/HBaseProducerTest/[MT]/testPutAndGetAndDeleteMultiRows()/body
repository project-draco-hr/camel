{
  testPutMultiRows();
  if (systemReady) {
    ProducerTemplate template=context.createProducerTemplate();
    Endpoint endpoint=context.getEndpoint("direct:start");
    Exchange exchange1=endpoint.createExchange(ExchangePattern.InOnly);
    exchange1.getIn().setHeader(HbaseAttribute.HBASE_ROW_ID.asHeader(),key[0]);
    exchange1.getIn().setHeader(HBaseConstants.OPERATION,HBaseConstants.DELETE);
    template.send(endpoint,exchange1);
    Exchange exchange2=endpoint.createExchange(ExchangePattern.InOut);
    exchange2.getIn().setHeader(HbaseAttribute.HBASE_ROW_ID.asHeader(),key[0]);
    exchange2.getIn().setHeader(HbaseAttribute.HBASE_FAMILY.asHeader(),family[0]);
    exchange2.getIn().setHeader(HbaseAttribute.HBASE_QUALIFIER.asHeader(),column[0]);
    exchange2.getIn().setHeader(HbaseAttribute.HBASE_ROW_ID.asHeader(2),key[1]);
    exchange2.getIn().setHeader(HbaseAttribute.HBASE_FAMILY.asHeader(2),family[0]);
    exchange2.getIn().setHeader(HbaseAttribute.HBASE_QUALIFIER.asHeader(2),column[0]);
    exchange2.getIn().setHeader(HBaseConstants.OPERATION,HBaseConstants.GET);
    Exchange resp=template.send(endpoint,exchange2);
    assertEquals(null,resp.getOut().getHeader(HbaseAttribute.HBASE_VALUE.asHeader()));
    assertEquals(body[1],resp.getOut().getHeader(HbaseAttribute.HBASE_VALUE.asHeader(2)));
  }
}
