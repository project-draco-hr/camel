{
  final String hello="Hello Thai Elephant \u0E08";
  final String bye="Hello Thai Elephant \u0E08";
  final String uri="mina:udp://localhost:8080?sync=true&encoding=UTF-8";
  this.context.addRoutes(new RouteBuilder(){
    public void configure(){
      from(uri).process(new Processor(){
        public void process(        Exchange exchange) throws Exception {
          byte[] in=exchange.getIn().getBody(byte[].class);
          String s=new String(in,"UTF-8");
          assertEquals(hello,s);
          exchange.getOut().setBody(bye);
        }
      }
);
    }
  }
);
  Endpoint endpoint=context.getEndpoint(uri);
  Producer producer=endpoint.createProducer();
  Exchange exchange=producer.createExchange();
  exchange.getIn().setBody(hello);
  producer.start();
  producer.process(exchange);
  producer.stop();
  byte[] out=exchange.getOut().getBody(byte[].class);
  String s=new String(out,"UTF-8");
  assertEquals(bye,s);
}
