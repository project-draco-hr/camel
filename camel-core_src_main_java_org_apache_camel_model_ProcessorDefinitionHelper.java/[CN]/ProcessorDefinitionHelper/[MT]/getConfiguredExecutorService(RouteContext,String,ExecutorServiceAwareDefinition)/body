{
  ExecutorServiceManager manager=routeContext.getCamelContext().getExecutorServiceManager();
  ObjectHelper.notNull(manager,"ExecutorServiceManager",routeContext.getCamelContext());
  if (definition.getExecutorService() != null) {
    return definition.getExecutorService();
  }
 else   if (definition.getExecutorServiceRef() != null) {
    ExecutorService answer=routeContext.getCamelContext().getRegistry().lookup(definition.getExecutorServiceRef(),ExecutorService.class);
    if (answer == null) {
      answer=manager.newThreadPool(definition,name,definition.getExecutorServiceRef());
    }
    if (answer == null) {
      throw new NoSuchBeanException(definition.getExecutorServiceRef(),"ExecutorService");
    }
    return answer;
  }
  return null;
}
