{
  message.setBody(file);
  if (flattern) {
    message.setHeader(Exchange.FILE_NAME,file.getFileNameOnly());
  }
 else {
    String name=file.isAbsolute() ? file.getAbsoluteFilePath() : file.getRelativeFilePath();
    String endpointPath=getConfiguration().getDirectory();
    if (ObjectHelper.isNotEmpty(endpointPath) && name.startsWith(endpointPath)) {
      name=ObjectHelper.after(name,getConfiguration().getDirectory() + File.separator);
    }
    message.setHeader(Exchange.FILE_NAME,name);
  }
}
