{
  LOG.debug("Indexing {}",exchange);
  openIndexWriter();
  Map<String,Object> headers=exchange.getIn().getHeaders();
  add("exchangeId",exchange.getExchangeId(),true);
  for (  Entry<String,Object> entry : headers.entrySet()) {
    String field=entry.getKey();
    String value=exchange.getContext().getTypeConverter().mandatoryConvertTo(String.class,entry.getValue());
    add(field,value,true);
  }
  add("contents",exchange.getIn().getMandatoryBody(String.class),true);
  closeIndexWriter();
}
