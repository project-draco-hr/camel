{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Indexing " + exchange);
  }
  openIndexWriter();
  Map<String,Object> headers=exchange.getIn().getHeaders();
  add("exchangeId",exchange.getExchangeId(),true);
  Iterator<String> iterator=headers.keySet().iterator();
  while (iterator.hasNext()) {
    String field=iterator.next();
    String value=(String)headers.get(field);
    add(field,value,true);
  }
  add("contents",exchange.getIn().getMandatoryBody(String.class),true);
  closeIndexWriter();
}
