{
  if (suspended) {
    if (LOG.isTraceEnabled()) {
      LOG.trace("Cannot start to poll: " + this.getEndpoint() + " as its suspended");
    }
    return;
  }
  int retryCounter=-1;
  boolean done=false;
  while (!done) {
    try {
      done=true;
      if (isPollAllowed()) {
        if (retryCounter == -1) {
          if (LOG.isTraceEnabled()) {
            LOG.trace("Starting to poll: " + this.getEndpoint());
          }
        }
 else {
          if (LOG.isDebugEnabled()) {
            LOG.debug("Retrying attempt " + retryCounter + " to poll: "+ this.getEndpoint());
          }
        }
        pollStrategy.begin(this,getEndpoint());
        retryCounter++;
        poll();
        pollStrategy.commit(this,getEndpoint());
      }
      if (LOG.isTraceEnabled()) {
        LOG.trace("Finished polling: " + this.getEndpoint());
      }
    }
 catch (    Exception e) {
      try {
        boolean retry=pollStrategy.rollback(this,getEndpoint(),retryCounter,e);
        if (retry) {
          done=false;
        }
      }
 catch (      Exception re) {
        throw ObjectHelper.wrapRuntimeCamelException(re);
      }
    }
catch (    Error e) {
      log.fatal("Consumer " + this + " could not poll endpoint: "+ getEndpoint().getEndpointUri()+ " caused by: "+ e.getMessage(),e);
      throw e;
    }
  }
}
