{
  MessageConsumer messageConsumer=null;
  if (topic) {
    TopicSession ts=(TopicSession)session;
    if (ObjectHelper.isNotEmpty(durableSubscriptionId)) {
      if (ObjectHelper.isNotEmpty(messageSelector)) {
        messageConsumer=ts.createDurableSubscriber((Topic)destination,durableSubscriptionId,messageSelector,noLocal);
      }
 else {
        messageConsumer=ts.createDurableSubscriber((Topic)destination,durableSubscriptionId);
      }
    }
 else {
      if (ObjectHelper.isNotEmpty(messageSelector)) {
        messageConsumer=ts.createSubscriber((Topic)destination,messageSelector,noLocal);
      }
 else {
        messageConsumer=ts.createSubscriber((Topic)destination);
      }
    }
  }
 else {
    if (ObjectHelper.isNotEmpty(messageSelector)) {
      messageConsumer=session.createConsumer(destination,messageSelector);
    }
 else {
      messageConsumer=session.createConsumer(destination);
    }
  }
  return messageConsumer;
}
