{
  Object correlationKey=correlationExpression.evaluate(exchange);
  Exchange oldExchange=map.get(correlationKey);
  Exchange newExchange=exchange;
  if (oldExchange != null) {
    newExchange=aggregationStrategy.aggregate(oldExchange,newExchange);
  }
  if (newExchange != oldExchange) {
    LOG.debug("put exchange:" + newExchange + " for key:"+ correlationKey);
    map.put(correlationKey,newExchange);
  }
  onAggregation(correlationKey,newExchange);
  return true;
}
