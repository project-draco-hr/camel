{
  int total=exchanges.size();
  for (int index=0; index < total && isRunAllowed(); index++) {
    GenericFileExchange<T> exchange=(GenericFileExchange<T>)exchanges.poll();
    exchange.setProperty(Exchange.BATCH_INDEX,index);
    exchange.setProperty(Exchange.BATCH_SIZE,total);
    exchange.setProperty(Exchange.BATCH_COMPLETE,index == total - 1);
    processExchange(exchange);
  }
}
