{
  if (log.isTraceEnabled()) {
    log.trace("Processing remote file: " + exchange.getGenericFile());
  }
  try {
    final GenericFileProcessStrategy<T> processStrategy=endpoint.getGenericFileProcessStrategy();
    if (processStrategy.begin(operations,endpoint,exchange,exchange.getGenericFile())) {
      final GenericFile<T> target=exchange.getGenericFile();
      final String name=target.getAbsoluteFilePath();
      if (log.isTraceEnabled()) {
        log.trace("Retreiving file: " + name + " from: "+ endpoint);
      }
      operations.retrieveFile(name,exchange);
      if (log.isTraceEnabled()) {
        log.trace("Retrieved file: " + name + " from: "+ endpoint);
      }
      if (log.isDebugEnabled()) {
        log.debug("About to process file: " + target + " using exchange: "+ exchange);
      }
      getAsyncProcessor().process(exchange,new AsyncCallback(){
        public void done(        boolean sync){
          final GenericFile<T> file=exchange.getGenericFile();
          boolean failed=exchange.isFailed();
          boolean handled=DeadLetterChannel.isFailureHandled(exchange);
          if (log.isDebugEnabled()) {
            log.debug("Done processing file: " + file + ". Status is: "+ (failed ? "failed: " + failed + ", handled by failure processor: "+ handled : "processed OK"));
          }
          boolean committed=false;
          try {
            if (!failed || handled) {
              processStrategyCommit(processStrategy,exchange,file,handled);
              committed=true;
            }
 else {
              handleException(exchange.getException());
            }
          }
  finally {
            if (!committed) {
              processStrategyRollback(processStrategy,exchange,file);
            }
          }
        }
      }
);
    }
 else {
      log.warn(endpoint + " cannot process remote file: " + exchange.getGenericFile());
    }
  }
 catch (  Exception e) {
    handleException(e);
  }
}
