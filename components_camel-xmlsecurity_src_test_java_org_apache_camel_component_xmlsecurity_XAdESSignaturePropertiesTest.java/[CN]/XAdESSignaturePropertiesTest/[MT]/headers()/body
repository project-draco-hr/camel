{
  Map<String,Object> header=new TreeMap<String,Object>();
  header.put(XmlSignatureConstants.HEADER_XADES_PREFIX,"ns1");
  header.put(XmlSignatureConstants.HEADER_XADES_NAMESPACE,XAdESSignatureProperties.HTTP_URI_ETSI_ORG_01903_V1_2_2);
  header.put(XmlSignatureConstants.HEADER_XADES_QUALIFYING_PROPERTIES_ID,"QualId");
  header.put(XmlSignatureConstants.HEADER_XADES_SIGNED_DATA_OBJECT_PROPERTIES_ID,"ObjId");
  header.put(XmlSignatureConstants.HEADER_XADES_SIGNED_SIGNATURE_PROPERTIES_ID,"SigId");
  header.put(XmlSignatureConstants.HEADER_XADES_DATA_OBJECT_FORMAT_ENCODING,"base64");
  XmlSignerEndpoint endpoint=getSignerEndpoint();
  XAdESSignatureProperties props=(XAdESSignatureProperties)endpoint.getProperties();
  props.setSigPolicyQualifiers(Collections.<String>emptyList());
  props.setSignerClaimedRoles(Collections.<String>emptyList());
  props.setCommitmentTypeQualifiers(Collections.<String>emptyList());
  Document doc=testEnveloping("direct:enveloping",header);
  Map<String,String> prefix2Namespace=new TreeMap<String,String>();
  prefix2Namespace.put("ds",XMLSignature.XMLNS);
  prefix2Namespace.put("etsi",XAdESSignatureProperties.HTTP_URI_ETSI_ORG_01903_V1_2_2);
  XPathExpression expr=getXpath("/ds:Signature/ds:Object/etsi:QualifyingProperties",prefix2Namespace);
  Object result=expr.evaluate(doc,XPathConstants.NODE);
  assertNotNull(result);
  Node node=(Node)result;
  assertEquals("ns1",node.getPrefix());
  assertEquals(XAdESSignatureProperties.HTTP_URI_ETSI_ORG_01903_V1_2_2,node.getNamespaceURI());
  checkXpath(doc,"/ds:Signature/ds:Object/etsi:QualifyingProperties/@Id",prefix2Namespace,"QualId");
  checkXpath(doc,"/ds:Signature/ds:Object/etsi:QualifyingProperties/etsi:SignedProperties/etsi:SignedDataObjectProperties/@Id",prefix2Namespace,"ObjId");
  checkXpath(doc,"/ds:Signature/ds:Object/etsi:QualifyingProperties/etsi:SignedProperties/etsi:SignedSignatureProperties/@Id",prefix2Namespace,"SigId");
  checkXpath(doc,"/ds:Signature/ds:Object/etsi:QualifyingProperties/etsi:SignedProperties/etsi:SignedDataObjectProperties/etsi:DataObjectFormat/etsi:Encoding/text()",prefix2Namespace,"base64");
}
