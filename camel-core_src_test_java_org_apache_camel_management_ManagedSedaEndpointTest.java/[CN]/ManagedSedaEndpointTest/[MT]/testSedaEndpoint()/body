{
  getMockEndpoint("mock:result").expectedMessageCount(2);
  template.sendBody("seda:start","Hello World");
  template.sendBody("seda:start","Bye World");
  assertMockEndpointsSatisfied();
  MBeanServer mbeanServer=getMBeanServer();
  ObjectName name=ObjectName.getInstance("org.apache.camel:context=localhost/camel-1,type=endpoints,name=\"seda://start\"");
  String uri=(String)mbeanServer.getAttribute(name,"EndpointUri");
  assertEquals("seda://start",uri);
  Long timeout=(Long)mbeanServer.getAttribute(name,"Timeout");
  assertEquals(30000,timeout.intValue());
  Integer size=(Integer)mbeanServer.getAttribute(name,"CurrentQueueSize");
  assertEquals(0,size.intValue());
  context.stopRoute("foo");
  template.sendBody("seda:start","Hi World");
  size=(Integer)mbeanServer.getAttribute(name,"CurrentQueueSize");
  assertEquals(1,size.intValue());
  mbeanServer.invoke(name,"purgeQueue",null,null);
  size=(Integer)mbeanServer.getAttribute(name,"CurrentQueueSize");
  assertEquals(0,size.intValue());
}
