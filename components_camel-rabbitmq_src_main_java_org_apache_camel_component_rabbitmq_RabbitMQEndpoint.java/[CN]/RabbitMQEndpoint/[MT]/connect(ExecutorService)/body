{
  ConnectionFactory factory=new ConnectionFactory();
  factory.setUsername(getUsername());
  factory.setPassword(getPassword());
  if (getVhost() == null) {
    factory.setVirtualHost("/");
  }
 else {
    factory.setVirtualHost(getVhost());
  }
  factory.setHost(getHostname());
  factory.setPort(getPortNumber());
  if (getAddresses() == null) {
    return factory.newConnection(executor);
  }
 else {
    return factory.newConnection(executor,getAddresses());
  }
}
