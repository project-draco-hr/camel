{
  miniCluster=new MiniSolrCloudCluster(1,"/solr",new File(solrHome,"solr-no-core.xml"),null,null);
  String zkAddr=miniCluster.getZkServer().getZkAddress();
  String zkHost=miniCluster.getZkServer().getZkHost();
  buildZooKeeper(zkHost,zkAddr,new File(solrHome),"solrconfig.xml","schema.xml");
  List<JettySolrRunner> jettys=miniCluster.getJettySolrRunners();
  for (  JettySolrRunner jetty : jettys) {
    if (!jetty.isRunning()) {
      System.out.println("JETTY NOT RUNNING!");
    }
 else {
      System.out.println("JETTY RUNNING");
      System.out.println("AT:  " + jetty.getBaseUrl());
      System.out.println("PORTT" + jetty.getLocalPort());
    }
  }
  solrClient=new CloudSolrServer(zkAddr,true);
  solrClient.connect();
  createCollection(solrClient,"collection1",1,1,"conf1");
  Thread.sleep(1000);
  solrClient.setDefaultCollection("collection1");
  SolrInputDocument doc=new SolrInputDocument();
  doc.setField("id","1");
  solrClient.add(doc);
  solrClient.commit();
}
