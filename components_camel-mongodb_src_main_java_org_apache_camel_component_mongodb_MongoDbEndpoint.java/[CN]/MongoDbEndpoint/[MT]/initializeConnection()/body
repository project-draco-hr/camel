{
  LOG.info("Initialising MongoDb endpoint: {}",this.toString());
  if (database == null || (collection == null && !(MongoDbOperation.getDbStats.equals(operation) || MongoDbOperation.command.equals(operation)))) {
    throw new CamelMongoDbException("Missing required endpoint configuration: database and/or collection");
  }
  db=mongoConnection.getDB(database);
  mongoDatabase=mongoConnection.getDatabase(database);
  if (db == null) {
    throw new CamelMongoDbException("Could not initialise MongoDbComponent. Database " + database + " does not exist.");
  }
  if (collection != null) {
    if (!createCollection && !db.collectionExists(collection)) {
      throw new CamelMongoDbException("Could not initialise MongoDbComponent. Collection " + collection + " and createCollection is false.");
    }
    dbCollection=db.getCollection(collection);
    mongoCollection=mongoDatabase.getCollection(collection,BasicDBObject.class);
    LOG.debug("MongoDb component initialised and endpoint bound to MongoDB collection with the following parameters. Address list: {}, Db: {}, Collection: {}",new Object[]{mongoConnection.getAllAddress().toString(),db.getName(),dbCollection.getName()});
    try {
      if (ObjectHelper.isNotEmpty(collectionIndex)) {
        ensureIndex(dbCollection,createIndex());
      }
    }
 catch (    Exception e) {
      throw new CamelMongoDbException("Error creating index",e);
    }
  }
}
