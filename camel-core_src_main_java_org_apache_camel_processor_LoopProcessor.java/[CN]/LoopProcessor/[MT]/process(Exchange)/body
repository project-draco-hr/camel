{
  String text=expression.evaluate(exchange,String.class);
  Integer value=ExchangeHelper.convertToType(exchange,Integer.class,text);
  if (value == null) {
    throw new RuntimeCamelException("Expression \"" + expression + "\" is not convertable to an Integer.");
  }
  int count=value;
  exchange.setProperty(Exchange.LOOP_SIZE,count);
  for (int i=0; i < count; i++) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("LoopProcessor: iteration #" + i);
    }
    exchange.setProperty(Exchange.LOOP_INDEX,i);
    super.process(exchange);
  }
}
