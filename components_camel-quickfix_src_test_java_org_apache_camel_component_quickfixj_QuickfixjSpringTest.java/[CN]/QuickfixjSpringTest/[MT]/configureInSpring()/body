{
  SessionID sessionID=new SessionID("FIX.4.2:INITIATOR->ACCEPTOR");
  QuickfixjConfiguration configuration=context.getRegistry().lookupByNameAndType("quickfixjConfiguration",QuickfixjConfiguration.class);
  SessionSettings springSessionSettings=configuration.createSessionSettings();
  Properties sessionProperties=springSessionSettings.getSessionProperties(sessionID,true);
  assertThat(sessionProperties.get("ConnectionType").toString(),CoreMatchers.is("initiator"));
  assertThat(sessionProperties.get("SocketConnectProtocol").toString(),CoreMatchers.is("VM_PIPE"));
  QuickfixjComponent component=context.getComponent("quickfix",QuickfixjComponent.class);
  QuickfixjEngine engine=component.getEngines().values().iterator().next();
  assertThat(engine.getMessageFactory(),is(instanceOf(CustomMessageFactory.class)));
}
