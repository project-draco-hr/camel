{
  ByteBuffer body=exchange.getIn().getBody(ByteBuffer.class);
  Object partitionKey=exchange.getIn().getHeader(KinesisConstants.PARTITION_KEY);
  Object sequenceNumber=exchange.getIn().getHeader(KinesisConstants.SEQUENCE_NUMBER);
  PutRecordRequest putRecordRequest=new PutRecordRequest();
  putRecordRequest.setData(body);
  putRecordRequest.setStreamName(getEndpoint().getStreamName());
  if (sequenceNumber != null) {
    putRecordRequest.setSequenceNumberForOrdering(sequenceNumber.toString());
  }
  if (partitionKey != null) {
    putRecordRequest.setPartitionKey(partitionKey.toString());
  }
  return putRecordRequest;
}
