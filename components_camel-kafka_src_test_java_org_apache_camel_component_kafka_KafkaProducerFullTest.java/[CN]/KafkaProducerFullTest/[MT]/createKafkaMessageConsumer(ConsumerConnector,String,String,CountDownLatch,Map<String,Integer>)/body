{
  Map<String,List<KafkaStream<byte[],byte[]>>> consumerMap=consumerConn.createMessageStreams(topicCountMap);
  ExecutorService executor=Executors.newFixedThreadPool(10);
  for (  final KafkaStream<byte[],byte[]> stream : consumerMap.get(topic)) {
    executor.submit(new KakfaTopicConsumer(stream,messagesLatch));
  }
  for (  final KafkaStream<byte[],byte[]> stream : consumerMap.get(topicInHeader)) {
    executor.submit(new KakfaTopicConsumer(stream,messagesLatch));
  }
}
