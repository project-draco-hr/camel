{
  super.doParse(element,parserContext,builder);
  String contextId=element.getAttribute("id");
  if (ObjectHelper.isNullOrBlank(contextId)) {
    contextId="camelContext";
    element.setAttribute("id",contextId);
  }
  Object value=parseUsingJaxb(element,parserContext);
  if (value instanceof CamelContextFactoryBean) {
    CamelContextFactoryBean factoryBean=(CamelContextFactoryBean)value;
    builder.addPropertyValue("id",contextId);
    builder.addPropertyValue("routes",factoryBean.getRoutes());
    if (factoryBean.getPackages().length > 0) {
      builder.addPropertyValue("packages",factoryBean.getPackages());
    }
  }
  boolean createdBeanPostProcessor=false;
  NodeList list=element.getChildNodes();
  int size=list.getLength();
  for (int i=0; i < size; i++) {
    Node child=list.item(i);
    if (child instanceof Element) {
      Element childElement=(Element)child;
      String localName=child.getLocalName();
      if (localName.equals("beanPostProcessor")) {
        createBeanPostProcessor(parserContext,contextId,childElement);
        createdBeanPostProcessor=true;
      }
 else       if (localName.equals("endpoint")) {
        BeanDefinition definition=endpointParser.parse(childElement,parserContext);
        String id=childElement.getAttribute("id");
        if (ObjectHelper.isNotNullAndNonEmpty(id)) {
          definition.getPropertyValues().addPropertyValue("camelContext",new RuntimeBeanReference(contextId));
          parserContext.registerComponent(new BeanComponentDefinition(definition,id));
        }
      }
 else {
        BeanDefinitionParser parser=parserMap.get(localName);
        if (parser != null) {
          BeanDefinition definition=parser.parse(childElement,parserContext);
          String id=childElement.getAttribute("id");
          if (ObjectHelper.isNotNullAndNonEmpty(id)) {
            parserContext.registerComponent(new BeanComponentDefinition(definition,id));
          }
        }
      }
    }
  }
  if (!createdBeanPostProcessor) {
    Element childElement=element.getOwnerDocument().createElement("beanPostProcessor");
    element.appendChild(childElement);
    createBeanPostProcessor(parserContext,contextId,childElement);
  }
}
