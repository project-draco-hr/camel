{
  renameNamespaceRecursive(element);
  super.doParse(element,parserContext,builder);
  String contextId=element.getAttribute("id");
  boolean implicitId=false;
  if (ObjectHelper.isEmpty(contextId)) {
    CamelContextNameStrategy strategy=new DefaultCamelContextNameStrategy();
    contextId=strategy.getName();
    element.setAttributeNS(null,"id",contextId);
    implicitId=true;
  }
  Binder<Node> binder;
  try {
    binder=getJaxbContext().createBinder();
  }
 catch (  JAXBException e) {
    throw new BeanDefinitionStoreException("Failed to create the JAXB binder",e);
  }
  Object value=parseUsingJaxb(element,parserContext,binder);
  if (value instanceof CamelContextFactoryBean) {
    CamelContextFactoryBean factoryBean=(CamelContextFactoryBean)value;
    builder.addPropertyValue("id",contextId);
    builder.addPropertyValue("implicitId",implicitId);
    builder.addPropertyValue("restConfiguration",factoryBean.getRestConfiguration());
    builder.addPropertyValue("rests",factoryBean.getRests());
    builder.addPropertyValue("routes",factoryBean.getRoutes());
    builder.addPropertyValue("intercepts",factoryBean.getIntercepts());
    builder.addPropertyValue("interceptFroms",factoryBean.getInterceptFroms());
    builder.addPropertyValue("interceptSendToEndpoints",factoryBean.getInterceptSendToEndpoints());
    builder.addPropertyValue("dataFormats",factoryBean.getDataFormats());
    builder.addPropertyValue("onCompletions",factoryBean.getOnCompletions());
    builder.addPropertyValue("onExceptions",factoryBean.getOnExceptions());
    builder.addPropertyValue("builderRefs",factoryBean.getBuilderRefs());
    builder.addPropertyValue("routeRefs",factoryBean.getRouteRefs());
    builder.addPropertyValue("restRefs",factoryBean.getRestRefs());
    builder.addPropertyValue("properties",factoryBean.getProperties());
    builder.addPropertyValue("packageScan",factoryBean.getPackageScan());
    builder.addPropertyValue("contextScan",factoryBean.getContextScan());
    if (factoryBean.getPackages().length > 0) {
      builder.addPropertyValue("packages",factoryBean.getPackages());
    }
    builder.addPropertyValue("camelPropertyPlaceholder",factoryBean.getCamelPropertyPlaceholder());
    builder.addPropertyValue("camelJMXAgent",factoryBean.getCamelJMXAgent());
    builder.addPropertyValue("camelStreamCachingStrategy",factoryBean.getCamelStreamCachingStrategy());
    builder.addPropertyValue("threadPoolProfiles",factoryBean.getThreadPoolProfiles());
    addDependsOn(factoryBean,builder);
  }
  NodeList list=element.getChildNodes();
  int size=list.getLength();
  for (int i=0; i < size; i++) {
    Node child=list.item(i);
    if (child instanceof Element) {
      Element childElement=(Element)child;
      String localName=child.getLocalName();
      if (localName.equals("endpoint")) {
        registerEndpoint(childElement,parserContext,contextId);
      }
 else       if (localName.equals("routeBuilder")) {
        addDependsOnToRouteBuilder(childElement,parserContext,contextId);
      }
 else {
        BeanDefinitionParser parser=parserMap.get(localName);
        if (parser != null) {
          BeanDefinition definition=parser.parse(childElement,parserContext);
          String id=childElement.getAttribute("id");
          if (ObjectHelper.isNotEmpty(id)) {
            parserContext.registerComponent(new BeanComponentDefinition(definition,id));
            if (localName.equals("template") || localName.equals("consumerTemplate") || localName.equals("proxy")|| localName.equals("export")) {
              definition.getPropertyValues().addPropertyValue("camelContext",new RuntimeBeanReference(contextId));
            }
          }
        }
      }
    }
  }
  registerEndpointsWithIdsDefinedInFromOrToTypes(element,parserContext,contextId,binder);
  registerTemplates(element,parserContext,contextId);
  injectNamespaces(element,binder);
  injectBeanPostProcessor(element,parserContext,contextId,builder);
}
