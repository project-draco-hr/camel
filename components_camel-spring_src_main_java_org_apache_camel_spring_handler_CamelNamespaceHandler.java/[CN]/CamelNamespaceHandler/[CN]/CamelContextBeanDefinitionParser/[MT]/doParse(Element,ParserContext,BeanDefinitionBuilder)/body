{
  renameNamespaceRecursive(element);
  super.doParse(element,parserContext,builder);
  String contextId=element.getAttribute("id");
  if (ObjectHelper.isEmpty(contextId)) {
    contextId="camelContext";
    element.setAttribute("id",contextId);
  }
  Binder<Node> binder=null;
  try {
    binder=getJaxbContext().createBinder();
  }
 catch (  JAXBException e) {
    throw new BeanDefinitionStoreException("Failed to create the JAXB binder : " + e,e);
  }
  Object value=parseUsingJaxb(element,parserContext,binder);
  if (value instanceof CamelContextFactoryBean) {
    CamelContextFactoryBean factoryBean=(CamelContextFactoryBean)value;
    builder.addPropertyValue("id",contextId);
    builder.addPropertyValue("routes",factoryBean.getRoutes());
    builder.addPropertyValue("intercepts",factoryBean.getIntercepts());
    builder.addPropertyValue("interceptFroms",factoryBean.getInterceptFroms());
    builder.addPropertyValue("interceptSendToEndpoints",factoryBean.getInterceptSendToEndpoints());
    builder.addPropertyValue("dataFormats",factoryBean.getDataFormats());
    builder.addPropertyValue("onCompletions",factoryBean.getOnCompletions());
    builder.addPropertyValue("onExceptions",factoryBean.getOnExceptions());
    builder.addPropertyValue("builderRefs",factoryBean.getBuilderRefs());
    builder.addPropertyValue("properties",factoryBean.getProperties());
    builder.addPropertyValue("packageScan",factoryBean.getPackageScan());
    if (factoryBean.getPackages().length > 0) {
      builder.addPropertyValue("packages",factoryBean.getPackages());
    }
    builder.addPropertyValue("camelPropertyPlaceholder",factoryBean.getCamelPropertyPlaceholder());
    builder.addPropertyValue("camelJMXAgent",factoryBean.getCamelJMXAgent());
  }
  boolean createdBeanPostProcessor=false;
  NodeList list=element.getChildNodes();
  int size=list.getLength();
  for (int i=0; i < size; i++) {
    Node child=list.item(i);
    if (child instanceof Element) {
      Element childElement=(Element)child;
      String localName=child.getLocalName();
      if (localName.equals("beanPostProcessor")) {
        createBeanPostProcessor(parserContext,contextId,childElement,builder);
        createdBeanPostProcessor=true;
      }
 else       if (localName.equals("endpoint")) {
        registerEndpoint(childElement,parserContext,contextId);
      }
 else {
        BeanDefinitionParser parser=parserMap.get(localName);
        if (parser != null) {
          BeanDefinition definition=parser.parse(childElement,parserContext);
          String id=childElement.getAttribute("id");
          if (ObjectHelper.isNotEmpty(id)) {
            parserContext.registerComponent(new BeanComponentDefinition(definition,id));
            if (localName.equals("template") || localName.equals("consumerTemplate") || localName.equals("proxy")|| localName.equals("export")) {
              definition.getPropertyValues().addPropertyValue("camelContext",new RuntimeBeanReference(contextId));
            }
          }
        }
      }
    }
  }
  registerEndpointsWithIdsDefinedInFromOrToTypes(element,parserContext,contextId,binder);
  registerTemplates(element,parserContext,contextId);
  injectNamespaces(element,binder);
  if (!createdBeanPostProcessor) {
    Element childElement=element.getOwnerDocument().createElement("beanPostProcessor");
    element.appendChild(childElement);
    createBeanPostProcessor(parserContext,contextId,childElement,builder);
  }
}
