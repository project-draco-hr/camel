{
  InputStream payload=exchange.getIn().getBody(InputStream.class);
  final String endpointFile=endpoint.getConfiguration().getFile();
  client.changeWorkingDirectory(endpointFile);
  String fileName=createFileName(exchange.getIn(),endpoint.getConfiguration());
  buildDirectory(client,fileName.substring(0,fileName.lastIndexOf('/')));
  final boolean success=client.storeFile(fileName,payload);
  if (!success) {
    throw new RuntimeCamelException("error sending file");
  }
}
