{
  if (log.isTraceEnabled()) {
    log.trace("Processing " + endpoint.getConfiguration());
  }
  connectIfNecessary();
  try {
    process(endpoint.createExchange(exchange));
  }
 catch (  Exception e) {
    if (isStopping() || isStopped()) {
      log.warn("Producer is stopping. Ignoring caught exception: " + e.getClass().getCanonicalName() + " message: "+ e.getMessage());
    }
 else {
      log.warn("Exception occured during processing: " + e.getClass().getCanonicalName() + " message: "+ e.getMessage());
      disconnect();
      throw e;
    }
  }
}
