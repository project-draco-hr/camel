{
  getMockEndpoint("mock:result").expectedMessageCount(1);
  template.sendBodyAndHeader("direct:foo","Hello World","foo","direct:cool,direct:start");
  assertMockEndpointsSatisfied();
  Thread.sleep(100);
  assertEquals(6,events.size());
  ExchangeSentEvent e0=assertIsInstanceOf(ExchangeSentEvent.class,events.get(0));
  ExchangeSentEvent e1=assertIsInstanceOf(ExchangeSentEvent.class,events.get(1));
  ExchangeSentEvent e2=assertIsInstanceOf(ExchangeSentEvent.class,events.get(2));
  ExchangeSentEvent e3=assertIsInstanceOf(ExchangeSentEvent.class,events.get(3));
  ExchangeSentEvent e4=assertIsInstanceOf(ExchangeSentEvent.class,events.get(4));
  ExchangeSentEvent e5=assertIsInstanceOf(ExchangeSentEvent.class,events.get(5));
  assertEquals("direct://cool",e0.getEndpoint().getEndpointUri());
  assertEquals("log://foo",e1.getEndpoint().getEndpointUri());
  assertEquals("direct://bar",e2.getEndpoint().getEndpointUri());
  assertEquals("mock://result",e3.getEndpoint().getEndpointUri());
  assertEquals("direct://start",e4.getEndpoint().getEndpointUri());
  assertEquals("direct://foo",e5.getEndpoint().getEndpointUri());
}
