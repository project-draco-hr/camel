{
  if (!uri.startsWith("jpa:")) {
    return null;
  }
  URI u=new URI(uri);
  String path=u.getHost();
  if (path == null) {
    path=u.getSchemeSpecificPart();
  }
  String[] paths=ObjectHelper.splitOnCharacter(path,":",4);
  if (paths[1] != null) {
    path=paths[1];
  }
  JpaEndpoint endpoint=new JpaEndpoint(uri,this);
  Map options=URISupport.parseParamters(u);
  Map consumerProperties=IntrospectionSupport.extractProperties(options,"consumer.");
  if (consumerProperties != null) {
    endpoint.setConsumerProperties(consumerProperties);
  }
  IntrospectionSupport.setProperties(endpoint,options);
  if (path != null) {
    Class<?> type=ObjectHelper.loadClass(path);
    if (type != null) {
      endpoint.setEntityType(type);
    }
  }
  return endpoint;
}
