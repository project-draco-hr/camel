{
  config.parseURI(enpointUri,parameters,this);
  setProperties(config,parameters);
  if (config.getProtocol() == null && config.getProtocolClassName() != null) {
    Class<?> protocolClass=getCamelContext().getClassResolver().resolveClass(config.getProtocolClassName());
    if (protocolClass != null) {
      Field f=protocolClass.getField("PROTOCOL");
      if (f != null) {
        Protocol protocol=(Protocol)f.get(null);
        config.setProtocol(protocol);
      }
    }
  }
  if (config.getProtocol() == null) {
    throw new IllegalArgumentException("Avro configuration does not contain protocol");
  }
}
