{
  Object object=request.getAttribute("org.eclipse.jetty.servlet.MultiPartFile.multiPartInputStream");
  if (object instanceof MultiPartInputStreamParser) {
    MultiPartInputStreamParser parser=(MultiPartInputStreamParser)object;
    Collection<Part> parts;
    try {
      parts=parser.getParts();
      for (      Part part : parts) {
        String contentType=part.getContentType();
        if (!contentType.startsWith("application/octet-stream")) {
          continue;
        }
        DataSource ds=new PartDataSource(part);
        message.addAttachment(part.getName(),new DataHandler(ds));
      }
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
}
