{
  for (  Map.Entry<String,Object> entry : camelMessage.getHeaders().entrySet()) {
    String headerName=entry.getKey();
    Object headerValue=entry.getValue();
    if (headerValue != null) {
      if (headerFilterStrategy != null && !headerFilterStrategy.applyFilterToCamelHeaders(headerName,headerValue)) {
        if (ObjectConverter.isCollection(headerValue)) {
          Iterator iter=ObjectConverter.iterator(headerValue);
          while (iter.hasNext()) {
            Object value=iter.next();
            mimeMessage.addHeader(headerName,asString(exchange,value));
          }
        }
 else {
          mimeMessage.setHeader(headerName,asString(exchange,headerValue));
        }
      }
    }
  }
}
