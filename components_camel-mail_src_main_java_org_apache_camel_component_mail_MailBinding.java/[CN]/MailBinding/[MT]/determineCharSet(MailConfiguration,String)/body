{
  if (charset == null) {
    return null;
  }
  boolean supported;
  try {
    supported=Charset.isSupported(charset);
  }
 catch (  IllegalCharsetNameException e) {
    supported=false;
  }
  if (supported) {
    return charset;
  }
 else   if (configuration.isIgnoreUnsupportedCharset()) {
    LOG.warn("Charset: " + charset + " is not supported, will fallback to use platform default instead.");
    return null;
  }
  return charset;
}
