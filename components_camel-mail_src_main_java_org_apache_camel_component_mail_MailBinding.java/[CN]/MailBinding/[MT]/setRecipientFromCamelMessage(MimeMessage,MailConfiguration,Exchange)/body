{
  for (  Map.Entry<String,Object> entry : exchange.getIn().getHeaders().entrySet()) {
    String headerName=entry.getKey();
    Object headerValue=entry.getValue();
    if (headerValue != null && isRecipientHeader(headerName)) {
      if (ObjectConverter.isCollection(headerValue)) {
        Iterator<?> iter=ObjectHelper.createIterator(headerValue);
        while (iter.hasNext()) {
          Object recipient=iter.next();
          appendRecipientToMimeMessage(mimeMessage,configuration,exchange,headerName,asString(exchange,recipient));
        }
      }
 else {
        appendRecipientToMimeMessage(mimeMessage,configuration,exchange,headerName,asString(exchange,headerValue));
      }
    }
  }
}
