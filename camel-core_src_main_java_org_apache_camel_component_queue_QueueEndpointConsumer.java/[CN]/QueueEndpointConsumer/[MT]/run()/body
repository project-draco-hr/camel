{
  while (!isStopping()) {
    E exchange;
    try {
      exchange=endpoint.getQueue().poll(1000,TimeUnit.MILLISECONDS);
    }
 catch (    InterruptedException e) {
      break;
    }
    if (exchange != null && !isStopping()) {
      try {
        processor.process(exchange);
      }
 catch (      AlreadyStoppedException e) {
        log.debug("Ignoring failed message due to shutdown: " + e,e);
        break;
      }
catch (      Throwable e) {
        log.error(e);
      }
    }
  }
}
