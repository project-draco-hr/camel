{
  Document result;
  if (operation == MongoDbOperation.getColStats) {
    result=calculateDb(exchange).runCommand(createCollStatsCommand(calculateCollectionName(exchange)));
  }
 else   if (operation == MongoDbOperation.getDbStats) {
    result=calculateDb(exchange).runCommand(createDbStatsCommand());
  }
 else {
    throw new CamelMongoDbException("Internal error: wrong operation for getStats variant" + operation);
  }
  copyHeaders(exchange);
  moveBodyToOutIfResultIsReturnedAsHeader(exchange,operation);
  processAndTransferResult(result,exchange,operation);
}
