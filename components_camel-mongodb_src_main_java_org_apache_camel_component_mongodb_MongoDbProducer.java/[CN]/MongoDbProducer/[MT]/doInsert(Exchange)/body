{
  MongoCollection<BasicDBObject> dbCol=calculateCollection(exchange);
  boolean singleInsert=true;
  Object insert=exchange.getIn().getBody(DBObject.class);
  if (insert == null) {
    insert=exchange.getIn().getBody(List.class);
    if (insert != null) {
      singleInsert=false;
      insert=attemptConvertToList((List)insert,exchange);
    }
 else {
      throw new CamelMongoDbException("MongoDB operation = insert, Body is not conversible to type DBObject nor List<DBObject>");
    }
  }
  if (singleInsert) {
    BasicDBObject insertObject=(BasicDBObject)insert;
    dbCol.insertOne(insertObject);
    exchange.getIn().setHeader(MongoDbConstants.OID,insertObject.get("_id"));
  }
 else {
    List<BasicDBObject> insertObjects=(List<BasicDBObject>)insert;
    dbCol.insertMany(insertObjects);
    List<Object> oids=new ArrayList<Object>(insertObjects.size());
    for (    DBObject insertObject : insertObjects) {
      oids.add(insertObject.get("_id"));
    }
    exchange.getIn().setHeader(MongoDbConstants.OID,oids);
  }
  copyHeaders(exchange);
  moveBodyToOutIfResultIsReturnedAsHeader(exchange,MongoDbOperation.insert);
  processAndTransferResult(insert,exchange,MongoDbOperation.insert);
}
