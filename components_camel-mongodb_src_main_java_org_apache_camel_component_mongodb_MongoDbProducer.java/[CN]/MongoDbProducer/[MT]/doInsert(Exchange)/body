{
  DBCollection dbCol=calculateCollection(exchange);
  boolean singleInsert=true;
  Object insert=exchange.getIn().getBody(DBObject.class);
  if (insert == null) {
    insert=exchange.getIn().getBody(List.class);
    if (insert != null) {
      singleInsert=false;
      insert=attemptConvertToList((List)insert,exchange);
    }
 else {
      throw new CamelMongoDbException("MongoDB operation = insert, Body is not conversible to type DBObject nor List<DBObject>");
    }
  }
  WriteResult result;
  WriteConcern wc=extractWriteConcern(exchange);
  if (singleInsert) {
    DBObject insertObject=(DBObject)insert;
    result=wc == null ? dbCol.insert(insertObject) : dbCol.insert(insertObject,wc);
    exchange.getIn().setHeader(MongoDbConstants.OID,insertObject.get("_id"));
  }
 else {
    List<DBObject> insertObjects=(List<DBObject>)insert;
    result=wc == null ? dbCol.insert(insertObjects) : dbCol.insert(insertObjects,wc);
    List<Object> oids=new ArrayList<Object>(insertObjects.size());
    for (    DBObject insertObject : insertObjects) {
      oids.add(insertObject.get("_id"));
    }
    exchange.getIn().setHeader(MongoDbConstants.OID,oids);
  }
  Message resultMessage=prepareResponseMessage(exchange,MongoDbOperation.insert);
  processAndTransferWriteResult(result,exchange);
  resultMessage.setBody(result);
}
