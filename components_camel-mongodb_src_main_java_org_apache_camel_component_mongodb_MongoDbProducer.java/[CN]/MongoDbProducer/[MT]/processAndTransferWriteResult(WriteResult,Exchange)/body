{
  if (endpoint.isInvokeGetLastError() || (endpoint.getWriteConcern() != null ? endpoint.getWriteConcern().callGetLastError() : false)) {
    CommandResult cr=result.getCachedLastError() == null ? result.getLastError() : result.getCachedLastError();
    exchange.getOut().setHeader(MongoDbConstants.LAST_ERROR,cr);
    if (!cr.ok()) {
      exchange.setException(MongoDbComponent.wrapInCamelMongoDbException(cr.getException()));
    }
  }
  if (endpoint.isWriteResultAsHeader()) {
    exchange.getOut().setHeader(MongoDbConstants.WRITERESULT,result);
  }
 else {
    exchange.getOut().setBody(result);
  }
}
