{
  jbiContainer.setEmbedded(true);
  CamelJbiComponent component=new CamelJbiComponent();
  List<ActivationSpec> activationSpecList=new ArrayList<ActivationSpec>();
  ActivationSpec activationSpec=new ActivationSpec();
  activationSpec.setId("camel");
  activationSpec.setService(new QName("camel","camel"));
  activationSpec.setEndpoint("camelEndpoint");
  activationSpec.setComponent(component);
  activationSpecList.add(activationSpec);
  appendJbiActivationSpecs(activationSpecList);
  ActivationSpec[] activationSpecs=activationSpecList.toArray(new ActivationSpec[activationSpecList.size()]);
  jbiContainer.setActivationSpecs(activationSpecs);
  jbiContainer.afterPropertiesSet();
  camelContext.addComponent("jbi",component);
  camelContext.setRoutes(createRoutes());
  endpoint=camelContext.resolveEndpoint(startEndpointUri);
  assertNotNull("No endpoint found!",endpoint);
  camelContext.activateEndpoints();
}
