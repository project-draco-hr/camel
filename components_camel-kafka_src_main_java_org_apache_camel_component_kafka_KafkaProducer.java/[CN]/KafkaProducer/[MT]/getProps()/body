{
  Properties props=endpoint.getConfiguration().createProducerProperties();
  try {
    if (endpoint.getCamelContext() != null) {
      ClassResolver resolver=endpoint.getCamelContext().getClassResolver();
      replaceWithClass(props,"key.serializer",resolver,Serializer.class);
      replaceWithClass(props,"value.serializer",resolver,Serializer.class);
      try {
        Field f=ProducerConfig.class.getDeclaredField("PARTITIONER_CLASS_CONFIG");
        if (f != null) {
          loadParitionerClass(resolver,props);
        }
      }
 catch (      NoSuchFieldException e) {
      }
catch (      SecurityException e) {
      }
    }
  }
 catch (  Throwable t) {
    LOG.debug("Problem loading classes for Serializers",t);
  }
  if (endpoint.getBrokers() != null) {
    props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG,endpoint.getBrokers());
  }
  return props;
}
