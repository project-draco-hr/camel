{
  Iterator<ProducerRecord> c=createRecorder(exchange);
  List<Future<ProducerRecord>> futures=new LinkedList<Future<ProducerRecord>>();
  while (c.hasNext()) {
    futures.add(kafkaProducer.send(c.next()));
  }
  for (  Future<ProducerRecord> f : futures) {
    f.get();
  }
}
