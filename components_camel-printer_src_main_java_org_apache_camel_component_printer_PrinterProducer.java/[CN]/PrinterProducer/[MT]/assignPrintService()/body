{
  PrintService printService;
  if ((config.getHostname().equalsIgnoreCase("localhost")) && (config.getPrintername().equalsIgnoreCase("default"))) {
    printService=PrintServiceLookup.lookupDefaultPrintService();
  }
 else {
    PrintService[] services=PrintServiceLookup.lookupPrintServices(null,null);
    setPrinter("\\\\" + config.getHostname() + "\\"+ config.getPrintername());
    int position=findPrinter(services,printer);
    if (position < 0) {
      throw new PrintException("No printer found with name: " + printer + ". Please verify that the host and printer are registered and reachable from this machine.");
    }
    printService=services[position];
  }
  return printService;
}
