{
  Credential credential;
  try {
    if (null != emailAddress && !"".equals(emailAddress) && null != p12FileName && !"".equals(p12FileName)) {
      credential=authorizeServiceAccount(emailAddress,p12FileName,scopes);
    }
 else {
      credential=authorize(clientId,clientSecret,scopes);
      if (refreshToken != null && !"".equals(refreshToken)) {
        credential.setRefreshToken(refreshToken);
      }
      if (accessToken != null && !"".equals(accessToken)) {
        credential.setAccessToken(accessToken);
      }
    }
    return new Calendar.Builder(transport,jsonFactory,credential).setApplicationName(applicationName).build();
  }
 catch (  Exception e) {
    LOG.error("Could not create Google Drive client.",e);
  }
  return null;
}
