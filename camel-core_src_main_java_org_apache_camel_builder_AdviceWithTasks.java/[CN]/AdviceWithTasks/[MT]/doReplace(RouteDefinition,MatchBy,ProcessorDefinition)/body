{
  return new AdviceWithTask(){
    public void task() throws Exception {
      boolean match=false;
      Iterator<ProcessorDefinition> it=ProcessorDefinitionHelper.filterTypeInOutputs(route.getOutputs(),ProcessorDefinition.class);
      while (it.hasNext()) {
        ProcessorDefinition output=it.next();
        if (matchBy.match(output)) {
          ProcessorDefinition parent=output.getParent();
          if (parent != null) {
            int index=parent.getOutputs().indexOf(output);
            if (index != -1) {
              match=true;
              parent.getOutputs().add(index + 1,replace);
              Object old=parent.getOutputs().remove(index);
              LOG.info("AdviceWith (" + matchBy.getId() + ") : ["+ old+ "] --> replace ["+ replace+ "]");
            }
          }
        }
      }
      if (!match) {
        throw new IllegalArgumentException("There are no outputs which matches: " + matchBy.getId() + " in the route: "+ route);
      }
    }
  }
;
}
