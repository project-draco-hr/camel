{
  getMockEndpoint("mock:middle").expectedMessageCount(1);
  getMockEndpoint("mock:middle").message(0).property(Exchange.EXCEPTION_CAUGHT).isInstanceOf(IllegalArgumentException.class);
  getMockEndpoint("mock:end").expectedMessageCount(1);
  getMockEndpoint("mock:end").message(0).property(Exchange.EXCEPTION_CAUGHT).isInstanceOf(IllegalArgumentException.class);
  File file=new File(TEST_FILE).getAbsoluteFile();
  FileInputStreamCache cache=new FileInputStreamCache(file);
  template.sendBody("direct:a",cache);
  assertMockEndpointsSatisfied();
  String result=getMockEndpoint("mock:end").getExchanges().get(0).getIn().getBody(String.class);
  assertTrue(result.contains("<firstName>James</firstName>"));
}
