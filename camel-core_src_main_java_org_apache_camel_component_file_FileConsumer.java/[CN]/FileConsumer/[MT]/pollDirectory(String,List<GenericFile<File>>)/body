{
  File fileOrDirectory=new File(fileName);
  if (!fileOrDirectory.exists()) {
    return;
  }
  if (fileOrDirectory.isFile()) {
    pollFile(fileName,fileList);
    return;
  }
  if (log.isTraceEnabled()) {
    log.trace("Polling directory: " + fileOrDirectory.getPath());
  }
  File[] files=fileOrDirectory.listFiles();
  if (files == null || files.length == 0) {
    return;
  }
  for (  File file : files) {
    GenericFile<File> gf=asGenericFile(rootPath,file);
    if (file.isDirectory()) {
      if (endpoint.isRecursive() && isValidFile(gf,true)) {
        String directory=fileName + "/" + file.getName();
        pollDirectory(directory,fileList);
      }
    }
 else     if (file.isFile()) {
      if (isValidFile(gf,false)) {
        fileList.add(gf);
      }
    }
 else {
      log.debug("Ignoring unsupported file type " + file);
    }
  }
}
