{
  if (LOG.isTraceEnabled()) {
    LOG.trace("Waiting for exclusive lock to file: " + file);
  }
  FileChannel channel=new RandomAccessFile(file,"rw").getChannel();
  try {
    FileLock lock=channel.lock();
    if (LOG.isDebugEnabled()) {
      LOG.debug("Acquired exclusive lock: " + lock + " to file: "+ file);
    }
    lock.release();
  }
  finally {
    ObjectHelper.close(channel,"FileConsumer during acquiring of exclusive lock",LOG);
  }
}
