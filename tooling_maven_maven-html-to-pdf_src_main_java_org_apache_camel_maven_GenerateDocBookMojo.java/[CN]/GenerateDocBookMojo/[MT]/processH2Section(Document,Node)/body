{
  NodeList nodeList=node.getChildNodes();
  Node h2Node=null;
  Node pNode=null;
  boolean firstInstanceOfH2=false;
  for (int x=0; x < nodeList.getLength(); ++x) {
    Node node2=nodeList.item(x);
    if (node2 != null) {
      String nodes=node2.getNodeName();
      if (nodes.equalsIgnoreCase("h2")) {
        h2Node=node2.appendChild(doc.createElement("h2_section"));
      }
 else {
        if (x == 0 && !nodes.equalsIgnoreCase("p") && !nodes.equalsIgnoreCase("h2")) {
          pNode=node.insertBefore(doc.createElement("p"),node2);
          x++;
          firstInstanceOfH2=true;
        }
        if (firstInstanceOfH2) {
          if (node2 == node.getLastChild()) {
            pNode.appendChild(node2.cloneNode(true));
          }
 else {
            Node nextNode=node2.getNextSibling();
            pNode.appendChild(node2.cloneNode(true));
            if (nextNode.getNodeName().equalsIgnoreCase("h2") || nextNode.getNodeName().equalsIgnoreCase("p")) {
              firstInstanceOfH2=false;
            }
          }
        }
        if (h2Node != null) {
          h2Node.appendChild(node2.cloneNode(true));
        }
      }
    }
  }
  NodeList nodeList3=node.getChildNodes();
  boolean afterH2=false;
  for (int x=0; x < nodeList3.getLength(); ++x) {
    Node node2=nodeList3.item(x);
    if (node2.getNodeName().equalsIgnoreCase("h2") && !afterH2) {
      afterH2=true;
    }
    if (node2 != null && !node2.getNodeName().equalsIgnoreCase("p") && !node2.getNodeName().equalsIgnoreCase("h2")) {
      node.removeChild(node2);
      x--;
    }
  }
  return node;
}
