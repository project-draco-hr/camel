{
  ObjectHelper.notNull(dataFormat,"dataFormat");
  InputStream stream=ExchangeHelper.getMandatoryInBody(exchange,InputStream.class);
  try {
    Message out=exchange.getOut();
    out.copyFrom(exchange.getIn());
    Object result=dataFormat.unmarshal(exchange,stream);
    out.setBody(result);
  }
 catch (  Exception e) {
    exchange.setOut(null);
    throw e;
  }
 finally {
    IOHelper.close(stream,"input stream");
  }
}
