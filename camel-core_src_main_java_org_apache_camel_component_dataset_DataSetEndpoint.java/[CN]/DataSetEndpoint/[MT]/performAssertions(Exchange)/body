{
  int receivedCount=receivedCounter.incrementAndGet();
  long index=receivedCount - 1;
  Exchange expected=createExchange(index);
  if (log.isDebugEnabled()) {
    log.debug("Received message: {} (DataSet index={}) = {}",new Object[]{index,actual.getIn().getHeader(Exchange.DATASET_INDEX,Integer.class),actual});
  }
  assertMessageExpected(index,expected,actual);
  if (reporter != null) {
    reporter.process(actual);
  }
  if (consumeDelay > 0) {
    Thread.sleep(consumeDelay);
  }
}
