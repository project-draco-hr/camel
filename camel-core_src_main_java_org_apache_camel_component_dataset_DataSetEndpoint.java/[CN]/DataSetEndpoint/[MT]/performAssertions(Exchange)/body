{
  if (startTime == 0) {
    startTime=System.currentTimeMillis();
  }
  int receivedCount=receivedCounter.incrementAndGet();
  long index=receivedCount - 1;
  Exchange expected=createExchange(index);
  if (LOG.isDebugEnabled()) {
    Integer dsi=actual.getIn().getHeader(Exchange.DATASET_INDEX,Integer.class);
    LOG.debug("Received message: " + index + " (DataSet index="+ dsi+ ") = "+ actual);
  }
  assertMessageExpected(index,expected,actual);
  if (consumeDelay > 0) {
    Thread.sleep(consumeDelay);
  }
  if (receivedCount % getDataSet().getReportCount() == 0) {
    reportProgress(actual,receivedCount);
  }
}
