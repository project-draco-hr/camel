{
  int receivedCount=receivedCounter.incrementAndGet();
  long index=receivedCount - 1;
  Exchange expected=createExchange(index);
  if (log.isDebugEnabled()) {
    Integer dsi=actual.getIn().getHeader(Exchange.DATASET_INDEX,Integer.class);
    log.debug("Received message: " + index + " (DataSet index="+ dsi+ ") = "+ actual);
  }
  assertMessageExpected(index,expected,actual);
  if (reporter != null) {
    reporter.process(actual);
  }
  if (consumeDelay > 0) {
    Thread.sleep(consumeDelay);
  }
}
