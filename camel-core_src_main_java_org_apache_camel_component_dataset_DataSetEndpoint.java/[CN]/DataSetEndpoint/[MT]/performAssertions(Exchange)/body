{
  if (startTime == 0) {
    startTime=System.currentTimeMillis();
  }
  int receivedCount=receivedCounter.incrementAndGet();
  long index=receivedCount - 1;
  Exchange expected=createExchange(index);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Received message: " + index + " = "+ actual);
  }
  assertMessageExpected(index,expected,actual);
  if (consumeDelay > 0) {
    Thread.sleep(consumeDelay);
  }
  long group=getDataSet().getReportCount();
  if (receivedCount % group == 0) {
    reportProgress(actual,receivedCount);
  }
}
