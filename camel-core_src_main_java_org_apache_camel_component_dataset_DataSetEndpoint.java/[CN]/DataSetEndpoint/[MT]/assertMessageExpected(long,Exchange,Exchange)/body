{
  if (null == disableDataSetIndex) {
    Long dataSetIndexHeaderValue=actual.getIn().getHeader(Exchange.DATASET_INDEX,Long.class);
    if (null != dataSetIndexHeaderValue) {
      assertEquals("Header: " + Exchange.DATASET_INDEX,index,dataSetIndexHeaderValue,actual);
    }
 else {
      actual.getIn().setHeader(Exchange.DATASET_INDEX,index);
    }
  }
 else   if (!disableDataSetIndex) {
    long actualCounter=ExchangeHelper.getMandatoryHeader(actual,Exchange.DATASET_INDEX,Long.class);
    assertEquals("Header: " + Exchange.DATASET_INDEX,index,actualCounter,actual);
  }
  getDataSet().assertMessageExpected(this,expected,actual,index);
}
