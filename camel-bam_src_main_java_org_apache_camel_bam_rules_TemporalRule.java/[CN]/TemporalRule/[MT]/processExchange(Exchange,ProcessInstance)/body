{
  Date firstTime=first.evaluate(instance);
  if (firstTime == null) {
    return;
  }
  ActivityState secondState=second.getOrCreateActivityState(instance);
  if (expectedMillis > 0L) {
    Date expected=secondState.getTimeExpected();
    if (expected == null) {
      expected=add(firstTime,expectedMillis);
      secondState.setTimeExpected(expected);
    }
  }
  if (overdueMillis > 0L) {
    Date overdue=secondState.getTimeOverdue();
    if (overdue == null) {
      overdue=add(firstTime,overdueMillis);
      secondState.setTimeOverdue(overdue);
    }
  }
}
