{
  String msgClassName=getConfiguration().getSerializerClass();
  String keyClassName=getConfiguration().getKeySerializerClass();
  if (msgClassName == null) {
    msgClassName=KafkaConstants.KAFKA_DEFAULT_ENCODER;
  }
  if (keyClassName == null) {
    keyClassName=msgClassName;
  }
  Class k=getCamelContext().getClassResolver().resolveMandatoryClass(keyClassName);
  Class v=getCamelContext().getClassResolver().resolveMandatoryClass(msgClassName);
  return createProducer(k,v,this);
}
