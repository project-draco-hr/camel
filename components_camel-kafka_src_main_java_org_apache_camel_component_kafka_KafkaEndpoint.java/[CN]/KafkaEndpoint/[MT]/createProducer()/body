{
  String msgClassName=getConfiguration().getSerializerClass();
  String keyClassName=getConfiguration().getKeySerializerClass();
  if (msgClassName == null) {
    msgClassName=KafkaConstants.KAFKA_DEFAULT_ENCODER;
  }
  if (keyClassName == null) {
    keyClassName=msgClassName;
  }
  ClassLoader cl=getClass().getClassLoader();
  Class<?> k;
  try {
    k=cl.loadClass(keyClassName);
  }
 catch (  ClassNotFoundException x) {
    k=getCamelContext().getClassResolver().resolveMandatoryClass(keyClassName);
  }
  Class<?> v;
  try {
    v=cl.loadClass(msgClassName);
  }
 catch (  ClassNotFoundException x) {
    v=getCamelContext().getClassResolver().resolveMandatoryClass(msgClassName);
  }
  return createProducer(k,v,this);
}
