{
  Exchange exchange=new DefaultExchange(this,getExchangePattern());
  Message message=new DefaultMessage();
  message.setHeader(KafkaConstants.PARTITION,mm.partition());
  message.setHeader(KafkaConstants.TOPIC,mm.topic());
  message.setHeader(KafkaConstants.OFFSET,mm.offset());
  if (mm.key() != null) {
    message.setHeader(KafkaConstants.KEY,new String(mm.key()));
  }
  message.setBody(mm.message());
  exchange.setIn(message);
  return exchange;
}
