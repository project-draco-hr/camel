{
  if (log.isDebugEnabled()) {
    log.debug("Processing Exchange.id:{}",exchange.getExchangeId());
  }
  try {
    final MessageProducerResources producer=getProducers().borrowObject(getResponseTimeOut());
    if (producer == null) {
      exchange.setException(new Exception("Unable to send message: connection not available"));
    }
 else {
      if (!isSynchronous()) {
        if (log.isDebugEnabled()) {
          log.debug("  Sending message asynchronously: {}",exchange.getIn().getBody());
        }
        getExecutor().execute(new Runnable(){
          @Override public void run(){
            try {
              sendMessage(exchange,callback,producer);
            }
 catch (            Exception e) {
              ObjectHelper.wrapRuntimeCamelException(e);
            }
          }
        }
);
      }
 else {
        if (log.isDebugEnabled()) {
          log.debug("  Sending message synchronously: {}",exchange.getIn().getBody());
        }
        sendMessage(exchange,callback,producer);
      }
    }
  }
 catch (  Exception e) {
    if (log.isDebugEnabled()) {
      log.debug("Processing Exchange.id:{}",exchange.getExchangeId() + " - FAILED");
    }
    if (log.isDebugEnabled()) {
      log.trace("Exception: " + e.getLocalizedMessage(),e);
    }
    exchange.setException(e);
  }
  log.debug("Processing Exchange.id:{}",exchange.getExchangeId() + " - SUCCESS");
  return isSynchronous();
}
