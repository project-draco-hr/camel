{
  Exchange exchange=template.send("direct:start",ExchangePattern.InOnly,new Processor(){
    public void process(    Exchange exchange) throws Exception {
      exchange.getIn().setHeader(CwConstants.METRIC_NAME,"errorCount");
    }
  }
);
  ArgumentCaptor<PutMetricDataRequest> argument=ArgumentCaptor.forClass(PutMetricDataRequest.class);
  verify(cloudWatchClient).putMetricData(argument.capture());
  assertEquals("errorCount",argument.getValue().getMetricData().get(0).getMetricName());
  assertEquals(Double.valueOf(1),argument.getValue().getMetricData().get(0).getValue());
  assertEquals(StandardUnit.Count.toString(),argument.getValue().getMetricData().get(0).getUnit());
}
