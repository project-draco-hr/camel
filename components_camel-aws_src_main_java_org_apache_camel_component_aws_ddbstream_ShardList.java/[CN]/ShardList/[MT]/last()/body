{
  Map<String,Shard> shardsByParent=new HashMap<>();
  for (  Shard shard : shards.values()) {
    shardsByParent.put(shard.getParentShardId(),shard);
  }
  for (  Shard shard : shards.values()) {
    if (!shardsByParent.containsKey(shard.getShardId())) {
      return shard;
    }
  }
  throw new IllegalStateException("Unable to find a shard with no children " + shards);
}
