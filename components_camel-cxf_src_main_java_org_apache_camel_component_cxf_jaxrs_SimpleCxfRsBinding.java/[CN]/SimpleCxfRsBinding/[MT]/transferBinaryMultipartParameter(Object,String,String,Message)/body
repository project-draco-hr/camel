{
  org.apache.camel.Attachment dh=null;
  if (toMap instanceof Attachment) {
    dh=createCamelAttachment((Attachment)toMap);
  }
 else   if (toMap instanceof DataSource) {
    dh=new DefaultAttachment((DataSource)toMap);
  }
 else   if (toMap instanceof DataHandler) {
    dh=new DefaultAttachment((DataHandler)toMap);
  }
 else   if (toMap instanceof InputStream) {
    dh=new DefaultAttachment(new InputStreamDataSource((InputStream)toMap,multipartType == null ? "application/octet-stream" : multipartType));
  }
  if (dh != null) {
    in.addAttachmentObject(parameterName,dh);
  }
}
