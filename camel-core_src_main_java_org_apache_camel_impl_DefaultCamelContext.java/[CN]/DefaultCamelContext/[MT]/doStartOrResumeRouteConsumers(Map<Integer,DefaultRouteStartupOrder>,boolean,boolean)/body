{
  List<Endpoint> routeInputs=new ArrayList<Endpoint>();
  for (  Map.Entry<Integer,DefaultRouteStartupOrder> entry : inputs.entrySet()) {
    Integer order=entry.getKey();
    Route route=entry.getValue().getRoute();
    RouteService routeService=entry.getValue().getRouteService();
    boolean autoStartup=routeService.getRouteDefinition().isAutoStartup(this) && this.isAutoStartup();
    if (addingRoute && !autoStartup) {
      log.info("Skipping starting of route " + routeService.getId() + " as its configured with autoStartup=false");
      continue;
    }
    for (    Consumer consumer : routeService.getInputs().values()) {
      Endpoint endpoint=consumer.getEndpoint();
      if (!doCheckMultipleConsumerSupportClash(endpoint,routeInputs)) {
        throw new FailedToStartRouteException(routeService.getId(),"Multiple consumers for the same endpoint is not allowed: " + endpoint);
      }
      List<Endpoint> existingEndpoints=new ArrayList<Endpoint>();
      for (      Route existingRoute : getRoutes()) {
        if (route.getId().equals(existingRoute.getId())) {
          continue;
        }
        Endpoint existing=existingRoute.getEndpoint();
        ServiceStatus status=getRouteStatus(existingRoute.getId());
        if (status != null && (status.isStarted() || status.isStarting())) {
          existingEndpoints.add(existing);
        }
      }
      if (!doCheckMultipleConsumerSupportClash(endpoint,existingEndpoints)) {
        throw new FailedToStartRouteException(routeService.getId(),"Multiple consumers for the same endpoint is not allowed: " + endpoint);
      }
      log.debug("Route: {} >>> {}",route.getId(),route);
      if (resumeOnly) {
        log.debug("Resuming consumer (order: {}) on route: {}",order,route.getId());
      }
 else {
        log.debug("Starting consumer (order: {}) on route: {}",order,route.getId());
      }
      if (resumeOnly && route.supportsSuspension()) {
        ServiceHelper.resumeService(consumer);
        log.info("Route: " + route.getId() + " resumed and consuming from: "+ endpoint);
      }
 else {
        for (        LifecycleStrategy strategy : lifecycleStrategies) {
          strategy.onServiceAdd(this,consumer,route);
        }
        startService(consumer);
        log.info("Route: " + route.getId() + " started and consuming from: "+ endpoint);
      }
      routeInputs.add(endpoint);
      boolean found=false;
      for (      RouteStartupOrder other : routeStartupOrder) {
        if (other.getRoute().getId().equals(route.getId())) {
          found=true;
          break;
        }
      }
      if (!found) {
        routeStartupOrder.add(entry.getValue());
      }
    }
    if (resumeOnly) {
      routeService.resume();
    }
 else {
      routeService.start(false);
    }
  }
}
