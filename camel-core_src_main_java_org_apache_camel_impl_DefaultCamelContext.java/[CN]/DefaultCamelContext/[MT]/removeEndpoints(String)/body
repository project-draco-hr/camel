{
  Collection<Endpoint> answer=new ArrayList<Endpoint>();
  Endpoint oldEndpoint=endpoints.remove(uri);
  if (oldEndpoint != null) {
    answer.add(oldEndpoint);
    stopServices(oldEndpoint);
  }
 else {
    for (    Map.Entry entry : endpoints.entrySet()) {
      oldEndpoint=(Endpoint)entry.getValue();
      if (EndpointHelper.matchEndpoint(oldEndpoint.getEndpointUri(),uri)) {
        answer.add(oldEndpoint);
        stopServices(oldEndpoint);
      }
    }
    for (    Endpoint endpoint : answer) {
      endpoints.remove(endpoint.getEndpointUri());
    }
  }
  return answer;
}
