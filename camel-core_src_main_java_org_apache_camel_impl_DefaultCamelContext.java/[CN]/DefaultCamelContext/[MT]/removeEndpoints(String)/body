{
  Collection<Endpoint> answer=new ArrayList<Endpoint>();
  Endpoint oldEndpoint=endpoints.remove(getEndpointKey(uri));
  if (oldEndpoint != null) {
    answer.add(oldEndpoint);
    stopServices(oldEndpoint);
  }
 else {
    for (    Map.Entry<EndpointKey,Endpoint> entry : endpoints.entrySet()) {
      oldEndpoint=entry.getValue();
      if (EndpointHelper.matchEndpoint(this,oldEndpoint.getEndpointUri(),uri)) {
        try {
          stopServices(oldEndpoint);
          answer.add(oldEndpoint);
          endpoints.remove(entry.getKey());
        }
 catch (        Exception e) {
          log.warn("Endpoint '{}' matching pattern '{}' should be removed, but could not be stopped. Remove ignored...");
        }
      }
    }
  }
  for (  Endpoint endpoint : answer) {
    for (    LifecycleStrategy strategy : lifecycleStrategies) {
      strategy.onEndpointRemove(endpoint);
    }
  }
  return answer;
}
