{
  LOG.info("Apache Camel " + getVersion() + " (CamelContext:"+ getName()+ ") is shutting down");
  EventHelper.notifyCamelContextStopping(this);
  shutdownStrategy.shutdown(this,getRouteStartupOrder());
  getRouteStartupOrder().clear();
  shutdownServices(routeServices.values());
  shutdownServices(endpoints.values());
  endpoints.clear();
  shutdownServices(components.values());
  components.clear();
  if (producerServicePool instanceof SharedProducerServicePool) {
    ((SharedProducerServicePool)producerServicePool).shutdown(this);
  }
 else {
    shutdownServices(producerServicePool);
  }
  shutdownServices(servicesToClose);
  servicesToClose.clear();
  try {
    for (    LifecycleStrategy strategy : lifecycleStrategies) {
      strategy.onContextStop(this);
    }
  }
 catch (  Exception e) {
    LOG.warn("Cannot stop lifecycle strategies: " + e.getMessage());
  }
  EventHelper.notifyCamelContextStopped(this);
  shutdownServices(managementStrategy);
  LOG.info("Apache Camel " + getVersion() + " (CamelContext:"+ getName()+ ") is shutdown");
}
