{
  LOG.info("Apache Camel " + getVersion() + " (CamelContext:"+ getName()+ ") is stopping");
  EventHelper.notifyCamelContextStopping(this);
  shutdownStrategy.shutdown(this,getRouteStartupOrder());
  getRouteStartupOrder().clear();
  stopServices(routeServices.values());
  stopServices(servicesToClose);
  servicesToClose.clear();
  stopServices(endpoints.values());
  endpoints.clear();
  stopServices(components.values());
  components.clear();
  if (producerServicePool instanceof SharedProducerServicePool) {
    ((SharedProducerServicePool)producerServicePool).shutdown(this);
  }
 else {
    stopServices(producerServicePool);
  }
  stopServices(inflightRepository);
  try {
    for (    LifecycleStrategy strategy : lifecycleStrategies) {
      strategy.onContextStop(this);
    }
  }
 catch (  Exception e) {
    LOG.warn("Cannot stop lifecycle strategies: " + e.getMessage());
  }
  stopServices(getManagementStrategy());
  EventHelper.notifyCamelContextStopped(this);
  LOG.info("Apache Camel " + getVersion() + " (CamelContext:"+ getName()+ ") stopped");
}
