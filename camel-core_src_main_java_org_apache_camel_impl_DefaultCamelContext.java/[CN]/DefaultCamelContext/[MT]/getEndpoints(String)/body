{
  Collection<Endpoint> answer=new ArrayList<Endpoint>();
  Collection<Endpoint> coll;
synchronized (endpoints) {
    Endpoint ep=endpoints.get(uri);
    if (ep != null) {
      answer.add(ep);
      return answer;
    }
    coll=new ArrayList<Endpoint>(endpoints.values());
  }
  for (  Endpoint ep : coll) {
    if (!ep.isSingleton() && uri.equals(ep.getEndpointUri())) {
      answer.add(ep);
    }
  }
  return answer;
}
