{
  Endpoint oldEndpoint;
synchronized (endpoints) {
    startServices(endpoint);
    oldEndpoint=endpoints.remove(uri);
    endpoints.put(uri,endpoint);
    stopServices(oldEndpoint);
  }
  return oldEndpoint;
}
