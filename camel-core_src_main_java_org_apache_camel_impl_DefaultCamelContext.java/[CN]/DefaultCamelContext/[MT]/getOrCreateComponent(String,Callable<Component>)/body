{
synchronized (components) {
    Component component=components.get(componentName);
    if (component == null) {
      try {
        component=factory.call();
        if (component == null) {
          throw new RuntimeCamelException("Factory failed to create the " + componentName + " component, it returned null.");
        }
        components.put(componentName,component);
        component.setCamelContext(this);
        for (        LifecycleStrategy strategy : lifecycleStrategies) {
          strategy.onComponentAdd(componentName,component);
        }
      }
 catch (      Exception e) {
        throw new RuntimeCamelException("Factory failed to create the " + componentName + " component.",e);
      }
    }
    return component;
  }
}
