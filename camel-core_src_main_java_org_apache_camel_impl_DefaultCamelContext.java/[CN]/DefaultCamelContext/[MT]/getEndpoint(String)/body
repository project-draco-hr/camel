{
  Endpoint answer;
synchronized (endpoints) {
    answer=endpoints.get(uri);
    if (answer == null) {
      try {
        String splitURI[]=ObjectHelper.splitOnCharacter(uri,":",2);
        if (splitURI[1] != null) {
          String scheme=splitURI[0];
          Component component=getComponent(scheme);
          if (component != null) {
            answer=component.createEndpoint(uri);
          }
        }
        if (answer == null) {
          answer=createEndpoint(uri);
        }
        if (answer != null && answer.isSingleton()) {
          if (answer != null) {
            startServices(answer);
            endpoints.put(uri,answer);
          }
        }
      }
 catch (      Exception e) {
        throw new ResolveEndpointFailedException(uri,e);
      }
    }
  }
  return answer;
}
