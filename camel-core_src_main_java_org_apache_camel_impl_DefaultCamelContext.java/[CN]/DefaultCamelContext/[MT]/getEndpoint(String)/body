{
  ObjectHelper.notEmpty(uri,"uri");
  Endpoint answer;
synchronized (endpoints) {
    answer=endpoints.get(uri);
    if (answer == null) {
      try {
        String splitURI[]=ObjectHelper.splitOnCharacter(uri,":",2);
        if (splitURI[1] != null) {
          String scheme=splitURI[0];
          Component component=getComponent(scheme);
          if (component != null) {
            answer=component.createEndpoint(uri);
            if (answer != null && LOG.isDebugEnabled()) {
              LOG.debug(uri + " converted to endpoint: " + answer+ " by component: "+ component);
            }
          }
        }
        if (answer == null) {
          answer=createEndpoint(uri);
        }
        if (answer != null) {
          addService(answer);
          endpoints.put(getEndpointKey(uri,answer),answer);
          lifecycleStrategy.onEndpointAdd(answer);
        }
      }
 catch (      Exception e) {
        throw new ResolveEndpointFailedException(uri,e);
      }
    }
  }
  return answer;
}
