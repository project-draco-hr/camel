{
  MagicKey key=new MagicKey(defaultCache(1));
  mockResultCreatedEvents.expectedMessageCount(1);
  mockResultExpiredEvents.expectedMessageCount(1);
  mockResultCreatedEvents.message(0).outHeader(InfinispanConstants.EVENT_TYPE).isEqualTo("CACHE_ENTRY_CREATED");
  mockResultCreatedEvents.message(0).outHeader(InfinispanConstants.IS_PRE).isEqualTo(false);
  mockResultCreatedEvents.message(0).outHeader(InfinispanConstants.CACHE_NAME).isNotNull();
  mockResultCreatedEvents.message(0).outHeader(InfinispanConstants.KEY).isEqualTo(key.toString());
  mockResultExpiredEvents.message(0).outHeader(InfinispanConstants.EVENT_TYPE).isEqualTo("CACHE_ENTRY_EXPIRED");
  mockResultExpiredEvents.message(0).outHeader(InfinispanConstants.IS_PRE).isEqualTo(false);
  mockResultExpiredEvents.message(0).outHeader(InfinispanConstants.CACHE_NAME).isNotNull();
  mockResultExpiredEvents.message(0).outHeader(InfinispanConstants.KEY).isEqualTo(key.toString());
  injectTimeService();
  defaultCache(1).put(key,"value",1000,TimeUnit.MILLISECONDS);
  ts0.advance(1001);
  ts1.advance(1001);
  assertNull(defaultCache(1).get(key));
  mockResultCreatedEvents.assertIsSatisfied();
  mockResultExpiredEvents.assertIsSatisfied(WAIT_TIMEOUT);
}
