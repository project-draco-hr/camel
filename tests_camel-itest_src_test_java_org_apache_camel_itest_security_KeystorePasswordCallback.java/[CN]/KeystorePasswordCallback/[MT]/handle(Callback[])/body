{
  for (int i=0; i < callbacks.length; i++) {
    WSPasswordCallback pc=(WSPasswordCallback)callbacks[i];
    String pass=passwords.get(pc.getIdentifier());
    if (WSConstants.PASSWORD_DIGEST.equals(pc.getPasswordType())) {
      if (pass != null) {
        pc.setPassword(pass);
        return;
      }
    }
    if (WSConstants.PASSWORD_TEXT.equals(pc.getPasswordType())) {
      if (!pc.getPassword().equals(pass)) {
        throw new IOException("Wrong password!");
      }
    }
  }
}
