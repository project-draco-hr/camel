{
  for (int i=0; i < callbacks.length; i++) {
    WSPasswordCallback pc=(WSPasswordCallback)callbacks[i];
    String pass=passwords.get(pc.getIdentifier());
    String type=getPasswordType(pc);
    if (WSConstants.PASSWORD_DIGEST.equals(type)) {
      if (pass != null) {
        pc.setPassword(pass);
        return;
      }
    }
    if (WSConstants.PASSWORD_TEXT.equals(type)) {
      if (pc.getPassword() == null) {
        pc.setPassword(pass);
        return;
      }
      if (!pass.equals(pc.getPassword())) {
        throw new IOException("Wrong password!");
      }
    }
  }
}
