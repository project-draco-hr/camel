{
  Object body=exchange.getIn().getBody();
  Neo4jOperation op=(Neo4jOperation)exchange.getIn().getHeader(Neo4jEndpoint.HEADER_OPERATION);
  if (op == null) {
    throw new Neo4jException("No operation specified for exchange " + exchange);
  }
switch (op) {
case CREATE_NODE:
    Node node=createNode(body);
  LOGGER.debug("Node created [{}]",node);
exchange.getIn().setHeader(Neo4jEndpoint.HEADER_NODE_ID,node.getId());
break;
case CREATE_RELATIONSHIP:
Relationship r=createRelationship(body);
LOGGER.debug("Relationship created [{}]",r);
exchange.getIn().setHeader(Neo4jEndpoint.HEADER_RELATIONSHIP_ID,r.getId());
break;
case REMOVE_NODE:
removeNode(body);
break;
case REMOVE_RELATIONSHIP:
removeRelationship(body);
break;
default :
}
}
