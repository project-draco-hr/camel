{
  LOG.debug("Starting thread for " + this);
  while (isRunAllowed()) {
    collection.clear();
    try {
      processBatch();
    }
 catch (    Exception e) {
      getExceptionHandler().handleException(e);
    }
  }
  collection.clear();
}
