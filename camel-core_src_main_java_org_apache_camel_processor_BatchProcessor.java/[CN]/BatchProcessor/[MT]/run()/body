{
  LOG.debug("Starting thread for " + this);
  while (!isStopped() && !isStopping()) {
    try {
      processBatch();
    }
 catch (    Exception e) {
      getExceptionHandler().handleException(e);
    }
  }
  collection.clear();
}
