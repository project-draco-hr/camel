{
  if (aggregationStrategy == null) {
    if (strategyRef == null) {
      aggregationStrategy=new UseLatestAggregationStrategy();
    }
 else {
      aggregationStrategy=routeContext.lookup(strategyRef,AggregationStrategy.class);
    }
  }
  if (threadPoolRef != null) {
    threadPoolExecutor=routeContext.lookup(threadPoolRef,ThreadPoolExecutor.class);
  }
  return new MulticastProcessor(list,aggregationStrategy,isParallelProcessing(),threadPoolExecutor);
}
