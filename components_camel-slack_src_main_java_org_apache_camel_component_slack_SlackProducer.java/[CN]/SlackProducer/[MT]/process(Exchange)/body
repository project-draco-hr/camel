{
  HttpClient client=HttpClientBuilder.create().build();
  HttpPost httpPost=new HttpPost(slackEndpoint.getWebhookUrl());
  SlackMessage slackMessage=new SlackMessage();
  slackMessage.setText(exchange.getIn().getBody(String.class));
  slackMessage.setChannel(slackEndpoint.getChannel());
  slackMessage.setUsername(slackEndpoint.getUsername());
  slackMessage.setIconUrl(slackEndpoint.getIconUrl());
  slackMessage.setIconEmoji(slackEndpoint.getIconEmoji());
  String json=asJson(slackMessage);
  StringEntity body=new StringEntity(json);
  httpPost.setEntity(body);
  HttpResponse response=client.execute(httpPost);
  if (response.getStatusLine().getStatusCode() < 200 || response.getStatusLine().getStatusCode() > 299) {
    throw new CamelExchangeException("Error POSTing to Slack API: " + response.toString(),exchange);
  }
}
