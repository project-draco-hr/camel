{
  Authentication answer=exchange.getProperty(Exchange.AUTHENTICATION,Authentication.class);
  if (answer == null && useThreadSecurityContext) {
    answer=SecurityContextHolder.getContext().getAuthentication();
    if (LOG.isDebugEnabled()) {
      LOG.debug("Get the authentication from SecurityContextHolder");
    }
  }
  return answer;
}
