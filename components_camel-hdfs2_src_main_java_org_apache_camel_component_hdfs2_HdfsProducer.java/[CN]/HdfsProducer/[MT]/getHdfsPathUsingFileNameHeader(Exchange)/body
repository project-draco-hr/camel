{
  StringBuilder actualPath=new StringBuilder(hdfsPath);
  String fileName="";
  Object value=exchange.getIn().getHeader(Exchange.FILE_NAME);
  if (value instanceof String) {
    fileName=exchange.getContext().getTypeConverter().convertTo(String.class,exchange,value);
  }
 else   if (value instanceof Expression) {
    fileName=((Expression)value).evaluate(exchange,String.class);
  }
  return actualPath.append(fileName);
}
