{
  FTPSClient client=getFtpsClient();
  if (client == null) {
    client=(FTPSClient)createFtpClient();
  }
  if (getConfiguration().getConnectTimeout() > -1) {
    client.setConnectTimeout(getConfiguration().getConnectTimeout());
  }
  if (getConfiguration().getSoTimeout() > -1) {
    soTimeout=getConfiguration().getSoTimeout();
  }
  dataTimeout=getConfiguration().getTimeout();
  if (ftpClientParameters != null) {
    Object timeout=ftpClientParameters.remove("soTimeout");
    if (timeout != null) {
      soTimeout=getCamelContext().getTypeConverter().convertTo(int.class,timeout);
    }
    timeout=ftpClientParameters.remove("dataTimeout");
    if (timeout != null) {
      dataTimeout=getCamelContext().getTypeConverter().convertTo(int.class,dataTimeout);
    }
    IntrospectionSupport.setProperties(client,ftpClientParameters);
  }
  if (ftpClientConfigParameters != null) {
    if (ftpClientConfig == null) {
      ftpClientConfig=new FTPClientConfig();
    }
    IntrospectionSupport.setProperties(ftpClientConfig,ftpClientConfigParameters);
  }
  if (dataTimeout > 0) {
    client.setDataTimeout(dataTimeout);
  }
  if (log.isDebugEnabled()) {
    log.debug("Created FTPSClient [connectTimeout: {}, soTimeout: {}, dataTimeout: {}]: {}",new Object[]{client.getConnectTimeout(),getSoTimeout(),dataTimeout,client});
  }
  FtpsOperations operations=new FtpsOperations(client,getFtpClientConfig());
  operations.setEndpoint(this);
  return operations;
}
