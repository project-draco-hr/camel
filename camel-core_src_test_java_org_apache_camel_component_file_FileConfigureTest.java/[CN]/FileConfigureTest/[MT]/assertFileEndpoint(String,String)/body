{
  FileEndpoint endpoint=resolveMandatoryEndpoint(endpointUri,FileEndpoint.class);
  assertNotNull("Could not find endpoint: " + endpointUri,endpoint);
  File file=endpoint.getFile();
  String path=file.getPath();
  assertDirectoryEquals("For uri: " + endpointUri + " the file is not equal",expectedPath,path);
  file=new File(expectedPath + (expectedPath.endsWith(File.separator) ? "" : File.separator) + EXPECT_FILE);
  GenericFile<File> consumedFile=FileConsumer.asGenericFile(file);
  Message message=new DefaultMessage();
  endpoint.configureMessage(consumedFile,message);
  assertEquals(EXPECT_FILE,message.getHeader(FileComponent.HEADER_FILE_NAME));
}
