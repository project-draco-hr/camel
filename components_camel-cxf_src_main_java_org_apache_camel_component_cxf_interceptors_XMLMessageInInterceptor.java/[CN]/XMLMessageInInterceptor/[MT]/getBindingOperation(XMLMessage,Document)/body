{
  Exchange ex=message.getExchange();
  BindingInfo binding=ex.get(BindingInfo.class);
  if (binding == null) {
    Endpoint ep=ex.get(Endpoint.class);
    binding=ep.getEndpointInfo().getBinding();
  }
  Element payloadEl=(Element)doc.getChildNodes().item(0);
  QName startQName=new QName(payloadEl.getNamespaceURI(),payloadEl.getLocalName());
  boolean client=isRequestor(message);
  List<BindingOperationInfo> boiList=new ArrayList<BindingOperationInfo>();
  for (  BindingOperationInfo boi : binding.getOperations()) {
    BindingMessageInfo bmi=client ? boi.getOutput() : boi.getInput();
    QName rootName=null;
    if (bmi != null) {
      XMLBindingMessageFormat msgFormat=bmi.getExtensor(XMLBindingMessageFormat.class);
      if (msgFormat != null) {
        rootName=msgFormat.getRootNode();
      }
 else {
        Collection<MessagePartInfo> bodyParts=bmi.getMessageParts();
        if (bodyParts.size() == 1) {
          MessagePartInfo p=bodyParts.iterator().next();
          rootName=p.getConcreteName();
        }
      }
    }
    if (startQName.equals(rootName)) {
      boiList.add(boi);
    }
  }
  BindingOperationInfo match=null;
  if (boiList.size() > 1) {
    if (LOG.isLoggable(Level.INFO)) {
      LOG.info("Mulitple matching BindingOperationIno found in Binding.");
    }
  }
 else   if (!boiList.isEmpty()) {
    match=boiList.get(0);
  }
  return match;
}
