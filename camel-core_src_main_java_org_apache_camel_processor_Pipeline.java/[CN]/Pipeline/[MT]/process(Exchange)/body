{
  Iterator<Processor> processors=getProcessors().iterator();
  Exchange nextExchange=exchange;
  boolean first=true;
  while (continueRouting(processors,nextExchange)) {
    if (first) {
      first=false;
    }
 else {
      nextExchange=createNextExchange(nextExchange);
    }
    Processor processor=processors.next();
    try {
      if (LOG.isTraceEnabled()) {
        LOG.trace("Processing exchangeId: " + nextExchange.getExchangeId() + " >>> "+ nextExchange);
      }
      processor.process(nextExchange);
    }
 catch (    Exception e) {
      nextExchange.setException(e);
    }
    boolean exceptionHandled=hasExceptionBeenHandled(nextExchange);
    if (nextExchange.isFailed() || exceptionHandled) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Message exchange has failed so breaking out of pipeline: " + nextExchange + " exception: "+ nextExchange.getException()+ " fault: "+ (nextExchange.hasFault() ? nextExchange.getFault() : null)+ (exceptionHandled ? " handled by the error handler" : ""));
      }
      break;
    }
  }
  if (LOG.isTraceEnabled()) {
    LOG.trace("Processing compelete for exchangeId: " + exchange.getExchangeId() + " >>> "+ nextExchange);
  }
  ExchangeHelper.copyResults(exchange,nextExchange);
}
