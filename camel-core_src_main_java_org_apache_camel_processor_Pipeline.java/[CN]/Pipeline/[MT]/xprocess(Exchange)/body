{
  final CountDownLatch latch=new CountDownLatch(1);
  if (!process(exchange,new AsyncCallback(){
    public void done(    boolean sync){
      if (sync) {
        return;
      }
      latch.countDown();
    }
  }
)) {
    latch.await();
  }
  exchange.throwException();
}
