{
  Exchange answer=copyExchangeStrategy(previousExchange);
  Message previousOut=previousExchange.getOut(false);
  Object output=previousOut != null ? previousOut.getBody() : null;
  Message in=answer.getIn();
  if (output != null) {
    in.setBody(output);
    Set<Map.Entry<String,Object>> entries=previousOut.getHeaders().entrySet();
    for (    Map.Entry<String,Object> entry : entries) {
      in.setHeader(entry.getKey(),entry.getValue());
    }
  }
 else {
    Object previousInBody=previousExchange.getIn().getBody();
    if (in.getBody() == null && previousInBody != null) {
      LOG.warn("Bad exchange implementation; the copy() method did not copy across the in body: " + previousExchange + " of type: "+ previousExchange.getClass());
      in.setBody(previousInBody);
    }
  }
  return answer;
}
