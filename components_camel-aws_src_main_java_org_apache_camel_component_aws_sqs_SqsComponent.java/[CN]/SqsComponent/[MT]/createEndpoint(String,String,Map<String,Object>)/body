{
  SqsConfiguration configuration=new SqsConfiguration();
  setProperties(configuration,parameters);
  if (remaining == null) {
    throw new IllegalArgumentException("Queue name not specified.");
  }
  configuration.setQueueName(remaining);
  if (configuration.getAmazonSQSClient() == null && (configuration.getAccessKey() == null || configuration.getSecretKey() == null)) {
    throw new IllegalArgumentException("AmazonSQSClient or accessKey and secretKey must be set");
  }
  SqsEndpoint sqsEndpoint=new SqsEndpoint(uri,this,configuration);
  sqsEndpoint.setConsumerProperties(parameters);
  return sqsEndpoint;
}
