{
  SqlPrepareStatementStrategy prepareStrategy=prepareStatementStrategy != null ? prepareStatementStrategy : new DefaultSqlPrepareStatementStrategy(separator);
  SqlProcessingStrategy proStrategy=processingStrategy != null ? processingStrategy : new DefaultSqlProcessingStrategy(prepareStrategy);
  SqlConsumer consumer=new SqlConsumer(this,processor,jdbcTemplate,query,prepareStrategy,proStrategy);
  consumer.setMaxMessagesPerPoll(getMaxMessagesPerPoll());
  consumer.setOnConsume(getOnConsume());
  consumer.setOnConsumeFailed(getOnConsumeFailed());
  consumer.setOnConsumeBatchComplete(getOnConsumeBatchComplete());
  configureConsumer(consumer);
  return consumer;
}
