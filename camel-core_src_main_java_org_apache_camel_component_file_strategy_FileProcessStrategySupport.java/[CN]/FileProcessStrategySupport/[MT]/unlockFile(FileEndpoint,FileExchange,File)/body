{
  if (isLockFile()) {
    FileLock lock=ExchangeHelper.getMandatoryProperty(exchange,"org.apache.camel.file.lock",FileLock.class);
    String lockFileName=ExchangeHelper.getMandatoryProperty(exchange,"org.apache.camel.file.lock.name",String.class);
    Channel channel=lock.channel();
    if (LOG.isDebugEnabled()) {
      LOG.debug("Unlocking file: " + file);
    }
    try {
      lock.release();
    }
  finally {
      ObjectHelper.close(channel,"Closing channel",LOG);
      if (LOG.isTraceEnabled()) {
        LOG.trace("Deleting lock file: " + lockFileName);
      }
      File lockfile=new File(lockFileName);
      lockfile.delete();
    }
  }
}
