{
  Object payload=exchange.getIn().getBody();
  if (payload != null) {
    InputStream payloadStream=ExchangeHelper.convertToMandatoryType(exchange,InputStream.class,payload);
    try {
      byte[] buffer=new byte[config.getBufferSize()];
      int read;
      while ((read=payloadStream.read(buffer)) > 0) {
        signer.update(buffer,0,read);
      }
    }
  finally {
      IOHelper.close(payloadStream);
    }
  }
}
