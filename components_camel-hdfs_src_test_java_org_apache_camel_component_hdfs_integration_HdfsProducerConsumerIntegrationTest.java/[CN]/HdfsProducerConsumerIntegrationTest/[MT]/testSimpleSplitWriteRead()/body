{
  context.addRoutes(new RouteBuilder(){
    @Override public void configure(){
      from("direct:start").to("hdfs://localhost:9000/tmp/test/test-camel-simple-write-file?fileSystemType=HDFS&splitStrategy=BYTES:5,IDLE:1000");
      from("hdfs://localhost:9000/tmp/test/test-camel-simple-write-file?pattern=seg*&initialDelay=2000&fileSystemType=HDFS&chunkSize=5").to("mock:result");
    }
  }
);
  context.start();
  for (int i=0; i < 10; ++i) {
    template.sendBody("direct:start","CIAO" + i);
  }
  MockEndpoint resultEndpoint=(MockEndpoint)context.getEndpoint("mock:result");
  resultEndpoint.expectedMessageCount(10);
  resultEndpoint.assertIsSatisfied();
  int i=0;
  List<Exchange> exchanges=resultEndpoint.getExchanges();
  for (  Exchange exchange : exchanges) {
    Assert.assertEquals("CIAO" + i++,exchange.getIn().getBody(String.class));
  }
}
