{
  return new DefaultProducer(this){
    public void process(    Exchange exchange) throws Exception {
      String server=exchange.getIn().getHeader(DnsConstants.DNS_SERVER,String.class);
      ObjectHelper.notEmpty(server,"Header " + DnsConstants.DNS_SERVER);
      SimpleResolver resolver=new SimpleResolver(server);
      int type=Type.value(exchange.getIn().getHeader(DnsConstants.DNS_TYPE,String.class));
      if (type == -1) {
        type=Type.A;
      }
      int dclass=DClass.value(exchange.getIn().getHeader(DnsConstants.DNS_CLASS,String.class));
      if (dclass == -1) {
        dclass=DClass.IN;
      }
      Name name=Name.fromString(exchange.getIn().getHeader(DnsConstants.DNS_NAME,String.class),Name.root);
      Record rec=Record.newRecord(name,type,dclass);
      Message query=Message.newQuery(rec);
      Message response=resolver.send(query);
      exchange.getOut().setBody(response);
    }
  }
;
}
