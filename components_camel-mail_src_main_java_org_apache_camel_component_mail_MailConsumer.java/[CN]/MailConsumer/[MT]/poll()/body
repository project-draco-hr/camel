{
  ensureFolderIsOpen();
  int count=folder.getMessageCount();
  if (count > 0) {
    Message[] messages=folder.getMessages();
    MessageCountEvent event=new MessageCountEvent(folder,MessageCountEvent.ADDED,true,messages);
    messagesAdded(event);
  }
 else   if (count == -1) {
    throw new MessagingException("Folder: " + folder.getFullName() + " is closed");
  }
  folder.close(true);
}
