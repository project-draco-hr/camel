{
synchronized (monitor) {
    try {
      Object handler=requestMap.get(correlationID);
      if (handler == null) {
        if (requestMap.size() > replyMap.size()) {
          replyMap.put(correlationID,inMessage,timeout);
        }
 else {
          LOG.warn("Response received for unknown correlationID: " + correlationID + "; response: "+ inMessage);
        }
      }
      if (handler != null && handler instanceof ReplyHandler) {
        ReplyHandler replyHandler=(ReplyHandler)handler;
        boolean complete=replyHandler.handle(inMessage);
        if (complete) {
          requestMap.remove(correlationID);
        }
      }
    }
 catch (    JMSException e) {
      throw new FailedToProcessResponse(inMessage,e);
    }
  }
}
