{
  boolean connectionFailed=true;
  while (running.get() && connectionFailed) {
    try {
      openConnectionAndChannel();
      connectionFailed=false;
    }
 catch (    Exception e) {
      log.debug("Connection failed, will retry in " + connectionRetryInterval + "ms",e);
      Thread.sleep(connectionRetryInterval);
    }
  }
  if (!connectionFailed) {
    addConsumer();
  }
  stop();
  return null;
}
