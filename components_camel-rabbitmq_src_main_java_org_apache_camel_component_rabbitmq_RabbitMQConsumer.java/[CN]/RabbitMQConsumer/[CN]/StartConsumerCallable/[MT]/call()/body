{
  boolean connectionFailed=true;
  while (running.get() && connectionFailed) {
    try {
      openConnection();
      connectionFailed=false;
    }
 catch (    Exception e) {
      log.info("Connection failed, will retry in {}" + connectionRetryInterval + "ms",e);
      Thread.sleep(connectionRetryInterval);
    }
  }
  if (!connectionFailed) {
    startConsumers();
  }
  stop();
  return null;
}
