{
  Exchange exchange=consumer.endpoint.createRabbitExchange(envelope,body);
  log.trace("Created exchange [exchange={}]",new Object[]{exchange});
  try {
    consumer.getProcessor().process(exchange);
    long deliveryTag=envelope.getDeliveryTag();
    if (!consumer.endpoint.isAutoAck()) {
      log.trace("Acknowledging receipt [delivery_tag={}]",deliveryTag);
      channel.basicAck(deliveryTag,false);
    }
  }
 catch (  Exception e) {
    getExceptionHandler().handleException("Error processing exchange",exchange,e);
  }
}
