{
  executor=endpoint.createExecutor();
  log.debug("Using executor {}",executor);
  try {
    openConnection();
    startConsumers();
  }
 catch (  Exception e) {
    log.info("Connection failed, will start background thread to retry!",e);
    Integer networkRecoveryInterval=getEndpoint().getNetworkRecoveryInterval();
    final long connectionRetryInterval=networkRecoveryInterval != null && networkRecoveryInterval > 0 ? networkRecoveryInterval : 100L;
    startConsumerCallable=new StartConsumerCallable(connectionRetryInterval);
    executor.submit(startConsumerCallable);
  }
}
