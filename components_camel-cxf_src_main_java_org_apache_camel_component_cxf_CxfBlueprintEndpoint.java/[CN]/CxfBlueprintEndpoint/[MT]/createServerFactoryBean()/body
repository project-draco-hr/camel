{
  Class<?> cls=null;
  if (getDataFormat() == DataFormat.POJO || getServiceClass() != null) {
    ObjectHelper.notNull(getServiceClass(),CxfConstants.SERVICE_CLASS);
    cls=getServiceClass();
  }
  ServerFactoryBean answer=null;
  if (cls == null) {
    checkName(getPortName()," endpoint/port name");
    checkName(getServiceName()," service name");
    answer=new ServerFactoryBean(new WSDLServiceFactoryBean());
  }
 else   if (CxfEndpointUtils.hasWebServiceAnnotation(cls)) {
    answer=new JaxWsServerFactoryBean();
  }
 else {
    answer=new ServerFactoryBean();
  }
  setupServerFactoryBean(answer,cls);
  return answer;
}
