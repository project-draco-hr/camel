{
  Endpoint e;
synchronized (endpointCache) {
    e=endpointCache.get(endpointUri);
  }
  if (e != null && expectedClass.isAssignableFrom(e.getClass())) {
    return expectedClass.asSubclass(expectedClass).cast(e);
  }
  return null;
}
