{
  Callable<Object> task=new Callable<Object>(){
    public Object call() throws Exception {
      Exchange answer=send(endpoint,pattern,createSetBodyProcessor(body));
      if (answer.isFailed()) {
        onCompletion.onFailure(answer);
      }
 else {
        onCompletion.onComplete(answer);
      }
      Object result=extractResultBody(answer,pattern);
      if (pattern.isOutCapable()) {
        return result;
      }
 else {
        return null;
      }
    }
  }
;
  if (executor == null) {
    throw new IllegalStateException("ProducerTemplate has not been started");
  }
  return executor.submit(task);
}
