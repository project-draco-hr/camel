{
  Callable<Exchange> task=new Callable<Exchange>(){
    public Exchange call() throws Exception {
      send(endpoint,exchange);
      if (exchange.isFailed()) {
        onCompletion.onFailure(exchange);
      }
 else {
        onCompletion.onComplete(exchange);
      }
      return exchange;
    }
  }
;
  if (executor == null) {
    throw new IllegalStateException("ProducerTemplate has not been started");
  }
  return executor.submit(task);
}
