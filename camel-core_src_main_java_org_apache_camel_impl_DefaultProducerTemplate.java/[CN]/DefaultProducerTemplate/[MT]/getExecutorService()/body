{
  if (!isStarted()) {
    throw new IllegalStateException("ProducerTemplate has not been started");
  }
  if (executor != null) {
    return executor;
  }
synchronized (this) {
    if (executor != null) {
      return executor;
    }
    if (!threadedAsyncMode) {
      executor=new SynchronousExecutorService();
    }
 else {
      executor=camelContext.getExecutorServiceManager().newDefaultThreadPool(this,"ProducerTemplate");
    }
  }
  ObjectHelper.notNull(executor,"ExecutorService");
  return executor;
}
