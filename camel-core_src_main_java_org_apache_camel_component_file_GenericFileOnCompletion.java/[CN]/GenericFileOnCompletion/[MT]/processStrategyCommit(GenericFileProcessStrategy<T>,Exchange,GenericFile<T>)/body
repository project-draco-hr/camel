{
  if (endpoint.isIdempotent()) {
    endpoint.getIdempotentRepository().add(absoluteFileName);
  }
  if (endpoint.getDoneFileName() != null) {
    String doneFileName=endpoint.createDoneFileName(absoluteFileName);
    ObjectHelper.notEmpty(doneFileName,"doneFileName",endpoint);
    try {
      boolean deleted=operations.deleteFile(doneFileName);
      log.trace("Done file: {} was deleted: {}",doneFileName,deleted);
      if (!deleted) {
        log.warn("Done file: " + doneFileName + " could not be deleted");
      }
    }
 catch (    Exception e) {
      handleException(e);
    }
  }
  try {
    log.trace("Commit file strategy: {} for file: {}",processStrategy,file);
    processStrategy.commit(operations,endpoint,exchange,file);
  }
 catch (  Exception e) {
    handleException(e);
  }
}
