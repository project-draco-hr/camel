{
  AlertNotification alertNotification=createMock(AlertNotification.class);
  Exchange exchange=createMock(Exchange.class);
  Exception exception=new Exception("forced exception for test");
  expect(endpoint.createOnAcceptAlertNotificationExchange(alertNotification)).andReturn(exchange);
  processor.process(exchange);
  expectLastCall().andThrow(exception);
  exceptionHandler.handleException(exception);
  replay(endpoint,processor,exceptionHandler,alertNotification,exchange);
  listener.onAcceptAlertNotification(alertNotification);
  verify(endpoint,processor,exceptionHandler,alertNotification,exchange);
}
