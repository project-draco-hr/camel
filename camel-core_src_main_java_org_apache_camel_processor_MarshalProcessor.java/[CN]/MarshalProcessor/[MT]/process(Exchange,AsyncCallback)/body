{
  ObjectHelper.notNull(dataFormat,"dataFormat");
  OutputStreamBuilder osb=OutputStreamBuilder.withExchange(exchange);
  Message in=exchange.getIn();
  Object body=in.getBody();
  Message out=exchange.getOut();
  out.copyFrom(in);
  try {
    dataFormat.marshal(exchange,body,osb);
    out.setBody(osb.build());
  }
 catch (  Throwable e) {
    exchange.setOut(null);
    exchange.setException(e);
  }
  callback.done(true);
  return true;
}
