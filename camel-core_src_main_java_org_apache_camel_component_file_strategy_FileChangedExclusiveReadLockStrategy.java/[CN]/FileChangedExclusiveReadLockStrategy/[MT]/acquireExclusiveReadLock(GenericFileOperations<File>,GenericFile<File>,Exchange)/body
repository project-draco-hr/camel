{
  if (!super.acquireExclusiveReadLock(operations,file,exchange)) {
    return false;
  }
  File target=new File(file.getAbsoluteFilePath());
  boolean exclusive=false;
  LOG.trace("Waiting for exclusive read lock to file: {}",file);
  long lastModified=Long.MIN_VALUE;
  long length=Long.MIN_VALUE;
  StopWatch watch=new StopWatch();
  while (!exclusive) {
    if (timeout > 0) {
      long delta=watch.taken();
      if (delta > timeout) {
        LOG.warn("Cannot acquire read lock within " + timeout + " millis. Will skip the file: "+ file);
        return false;
      }
    }
    long newLastModified=target.lastModified();
    long newLength=target.length();
    LOG.trace("Previous last modified: {}, new last modified: {}",lastModified,newLastModified);
    LOG.trace("Previous length: {}, new length: {}",length,newLength);
    if (newLastModified == lastModified && newLength == length && length != 0) {
      LOG.trace("Read lock acquired.");
      exclusive=true;
    }
 else {
      lastModified=newLastModified;
      length=newLength;
      boolean interrupted=sleep();
      if (interrupted) {
        return false;
      }
    }
  }
  return exclusive;
}
