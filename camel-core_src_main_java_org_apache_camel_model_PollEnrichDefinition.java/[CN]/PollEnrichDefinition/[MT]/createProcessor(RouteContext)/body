{
  if (ObjectHelper.isEmpty(resourceUri) && ObjectHelper.isEmpty(resourceRef) && expression == null) {
    throw new IllegalArgumentException("Either resourceUri, resourceRef or expression must be configured");
  }
  PollingConsumer consumer=null;
  if (resourceUri != null) {
    Endpoint endpoint=routeContext.resolveEndpoint(resourceUri);
    consumer=endpoint.createPollingConsumer();
  }
 else   if (resourceRef != null) {
    Endpoint endpoint=routeContext.resolveEndpoint(null,resourceRef);
    consumer=endpoint.createPollingConsumer();
  }
  long time=timeout != null ? timeout : -1;
  Expression exp=createResourceExpression(routeContext);
  PollEnricher enricher;
  if (exp != null) {
    enricher=new PollEnricher(null,exp,time);
  }
 else   if (consumer != null) {
    enricher=new PollEnricher(null,consumer,time);
  }
 else {
    throw new IllegalArgumentException("Either resourceUri, resourceRef or expression must be configured");
  }
  AggregationStrategy strategy=createAggregationStrategy(routeContext);
  if (strategy == null) {
    enricher.setDefaultAggregationStrategy();
  }
 else {
    enricher.setAggregationStrategy(strategy);
  }
  if (getAggregateOnException() != null) {
    enricher.setAggregateOnException(getAggregateOnException());
  }
  return enricher;
}
