{
  AggregationStrategy strategy=getAggregationStrategy();
  if (strategy == null && aggregationStrategyRef != null) {
    Object aggStrategy=routeContext.lookup(aggregationStrategyRef,Object.class);
    if (aggStrategy instanceof AggregationStrategy) {
      strategy=(AggregationStrategy)aggStrategy;
    }
 else     if (aggStrategy != null) {
      strategy=new AggregationStrategyBeanAdapter(aggStrategy,getAggregationStrategyMethodName());
    }
 else {
      throw new IllegalArgumentException("Cannot find AggregationStrategy in Registry with name: " + aggregationStrategyRef);
    }
  }
  return strategy;
}
