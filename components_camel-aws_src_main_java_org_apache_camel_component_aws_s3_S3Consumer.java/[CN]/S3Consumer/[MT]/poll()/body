{
  shutdownRunningTask=null;
  pendingExchanges=0;
  String bucketName=getConfiguration().getBucketName();
  LOG.trace("Queueing objects in bucket [{}]...",bucketName);
  ListObjectsRequest listObjectsRequest=new ListObjectsRequest();
  listObjectsRequest.setBucketName(bucketName);
  listObjectsRequest.setPrefix(getConfiguration().getPrefix());
  listObjectsRequest.setMaxKeys(maxMessagesPerPoll);
  ObjectListing listObjects=getAmazonS3Client().listObjects(listObjectsRequest);
  if (LOG.isTraceEnabled()) {
    LOG.trace("Found {} objects in bucket [{}]...",listObjects.getObjectSummaries().size(),bucketName);
  }
  Queue<Exchange> exchanges=createExchanges(listObjects.getObjectSummaries());
  return processBatch(CastUtils.cast(exchanges));
}
