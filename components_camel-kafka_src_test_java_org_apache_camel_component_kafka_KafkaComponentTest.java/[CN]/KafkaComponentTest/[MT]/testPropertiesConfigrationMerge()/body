{
  Map<String,Object> params=new HashMap<String,Object>();
  params.put("portNumber",14123);
  params.put("consumerStreams","3");
  params.put("topic","mytopic");
  params.put("partitioner","com.class.Party");
  KafkaConfiguration kc=new KafkaConfiguration();
  kc.setZookeeperHost("somehost");
  kc.setZookeeperPort(2987);
  kc.setTopic("default");
  params.put("configuration",kc);
  String uri="kafka:broker1:12345,broker2:12566";
  String remaining="broker1:12345,broker2:12566";
  KafkaEndpoint endpoint=new KafkaComponent(context).createEndpoint(uri,remaining,params);
  assertEquals("somehost:2987",endpoint.getZookeeperConnect());
  assertEquals("somehost",endpoint.getZookeeperHost());
  assertEquals(2987,endpoint.getZookeeperPort());
  assertEquals("broker1:12345,broker2:12566",endpoint.getBrokers());
  assertEquals("mytopic",endpoint.getTopic());
  assertEquals(3,endpoint.getConsumerStreams());
  assertEquals("com.class.Party",endpoint.getPartitioner());
  assertNull("dirty",kc.getBrokers());
  assertEquals("default",kc.getTopic());
}
