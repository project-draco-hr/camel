{
  Map<String,Object> params=new HashMap<String,Object>();
  params.put("zookeeperConnect","thehost:2181/chroot");
  params.put("zookeeperHost","somehost");
  params.put("zookeeperPort",2987);
  params.put("portNumber",14123);
  params.put("consumerStreams","3");
  params.put("topic","mytopic");
  params.put("partitioner","com.class.Party");
  String uri="kafka:broker1:12345,broker2:12566";
  String remaining="broker1:12345,broker2:12566";
  KafkaEndpoint endpoint=new KafkaComponent(context).createEndpoint(uri,remaining,params);
  assertEquals("thehost:2181/chroot",endpoint.getZookeeperConnect());
  assertNull(endpoint.getZookeeperHost());
  assertEquals(-1,endpoint.getZookeeperPort());
  assertEquals("broker1:12345,broker2:12566",endpoint.getBrokers());
  assertEquals("mytopic",endpoint.getTopic());
  assertEquals(3,endpoint.getConsumerStreams());
  assertEquals("com.class.Party",endpoint.getPartitioner());
}
