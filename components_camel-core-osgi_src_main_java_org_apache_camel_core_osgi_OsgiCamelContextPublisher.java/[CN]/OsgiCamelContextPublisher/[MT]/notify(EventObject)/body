{
  if (event instanceof CamelContextStartedEvent) {
    CamelContext context=((CamelContextStartedEvent)event).getContext();
    registerCamelContext(context);
  }
 else   if (event instanceof CamelContextStoppingEvent) {
    CamelContext context=((CamelContextStoppingEvent)event).getContext();
    ServiceRegistration reg=registrations.remove(context);
    if (reg != null) {
      if (log.isDebugEnabled()) {
        log.debug("Unregistering CamelContext [{}] from OSGi registry",context.getName());
      }
      try {
        reg.unregister();
      }
 catch (      Exception e) {
        log.warn("Error unregistering CamelContext [{}] from OSGi registry. This exception will be ignored.",context.getName(),e);
      }
    }
  }
}
