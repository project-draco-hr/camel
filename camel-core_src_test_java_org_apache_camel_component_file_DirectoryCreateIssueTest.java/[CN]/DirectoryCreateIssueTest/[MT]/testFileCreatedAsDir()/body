{
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedMessageCount(numFiles);
  template.send("seda:testFileCreatedAsDir",new Processor(){
    public void process(    Exchange exchange){
      Message in=exchange.getIn();
      in.setBody("Contents of test file");
    }
  }
);
  Thread.sleep(2000);
  assertMockEndpointsSatisfied();
  for (int i=0; i < numFiles; i++) {
    assertTrue((new File(path + "/file" + i+ ".txt")).isFile());
  }
}
