{
  TypeConverter converter=context.getTypeConverter();
  PersonType person=converter.convertTo(PersonType.class,"<Person><firstName>FOO</firstName><lastName>BAR</lastName></Person>");
  assertNotNull("Person should not be null ",person);
  assertEquals("Get the wrong first name ",person.getFirstName(),"FOO");
  assertEquals("Get the wrong second name ",person.getLastName(),"BAR");
  Exchange exchange=new DefaultExchange(context);
  exchange.setProperty(Exchange.CHARSET_NAME,"UTF-8");
  String value=converter.convertTo(String.class,exchange,person);
  assertTrue("Should get a right marshalled string",value.indexOf("<lastName>BAR</lastName>") > 0);
  try {
    byte[] buffers="<Person><firstName>FOO</firstName><lastName>BAR\u0008</lastName></Person>".getBytes("UTF-8");
    InputStream is=new ByteArrayInputStream(buffers);
    person=converter.convertTo(PersonType.class,exchange,is);
    fail("expect the exception here");
  }
 catch (  Exception ex) {
    assertTrue("The exception should be CamelExecutionException",ex instanceof org.apache.camel.CamelExecutionException);
  }
}
