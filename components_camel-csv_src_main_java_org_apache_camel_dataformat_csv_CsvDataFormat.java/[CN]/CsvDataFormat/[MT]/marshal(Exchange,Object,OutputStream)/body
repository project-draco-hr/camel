{
  ObjectHelper.notNull(config,"config");
  Map map=ExchangeHelper.convertToMandatoryType(exchange,Map.class,object);
  OutputStreamWriter out=new OutputStreamWriter(outputStream);
  try {
    if (autogenColumns) {
      Set set=map.keySet();
      updateFieldsInConfig(set,exchange);
    }
    CSVWriter writer=new CSVWriter(config);
    writer.setWriter(out);
    writer.writeRecord(map);
  }
  finally {
    out.close();
  }
}
