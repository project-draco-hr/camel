{
  if (delimiter != null) {
    config.setDelimiter(delimiter.charAt(0));
  }
  strategy.setDelimiter(config.getDelimiter());
  InputStreamReader in=new InputStreamReader(inputStream,IOHelper.getCharsetName(exchange));
  try {
    CSVParser parser=new CSVParser(in,strategy);
    List<List<String>> list=new ArrayList<List<String>>();
    boolean isFirstLine=true;
    while (true) {
      String[] strings=parser.getLine();
      if (isFirstLine) {
        isFirstLine=false;
        if (skipFirstLine) {
          continue;
        }
      }
      if (strings == null) {
        break;
      }
      List<String> line=Arrays.asList(strings);
      list.add(line);
    }
    return list;
  }
  finally {
    IOHelper.close(in);
  }
}
