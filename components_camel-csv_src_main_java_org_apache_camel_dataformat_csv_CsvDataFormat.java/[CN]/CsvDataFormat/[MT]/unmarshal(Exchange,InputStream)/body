{
  InputStreamReader in=new InputStreamReader(inputStream,IOConverter.getCharsetName(exchange));
  if (delimiter != null) {
    strategy.setDelimiter(delimiter.charAt(0));
  }
  try {
    CSVParser parser=new CSVParser(in,strategy);
    List<List<String>> list=new ArrayList<List<String>>();
    while (true) {
      String[] strings=parser.getLine();
      if (strings == null) {
        break;
      }
      List<String> line=Arrays.asList(strings);
      list.add(line);
    }
    if (list.size() == 1) {
      return list.get(0);
    }
 else {
      return list;
    }
  }
  finally {
    in.close();
  }
}
