{
  if (delimiter != null) {
    config.setDelimiter(delimiter.charAt(0));
  }
  strategy.setDelimiter(config.getDelimiter());
  InputStreamReader in=new InputStreamReader(inputStream,IOHelper.getCharsetName(exchange));
  CsvIterator csvIterator;
  try {
    CSVParser parser=createParser(in);
    if (parser == null) {
      IOHelper.close(in);
      return Collections.emptyIterator();
    }
    csvIterator=new CsvIterator(parser,in);
  }
 catch (  IOException e) {
    IOHelper.close(in);
    throw e;
  }
  if (lazyLoad) {
    return csvIterator;
  }
  return loadAllAsList(csvIterator);
}
