{
  jdbcTemplate.execute(query,new PreparedStatementCallback(){
    public Object doInPreparedStatement(    PreparedStatement ps) throws SQLException, DataAccessException {
      int argNumber=1;
      for (Iterator<?> i=exchange.getIn().getBody(Iterator.class); i.hasNext(); ) {
        ps.setObject(argNumber++,i.next());
      }
      boolean isResultSet=ps.execute();
      if (isResultSet) {
        RowMapperResultSetExtractor mapper=new RowMapperResultSetExtractor(new ColumnMapRowMapper());
        List result=(List)mapper.extractData(ps.getResultSet());
        exchange.getOut().setBody(result);
      }
 else {
        exchange.getIn().setHeader(UPDATE_COUNT,ps.getUpdateCount());
      }
      return null;
    }
  }
);
}
