{
  try {
    Class.forName("org.osgi.framework.BundleActivator");
    Class<?> activatorClass=classLoader.loadClass("org.apache.camel.impl.osgi.Activator");
    Method getBundleMethod=activatorClass.getDeclaredMethod("getBundle");
    Object bundle=getBundleMethod.invoke(null);
    return bundle != null;
  }
 catch (  Throwable t) {
    LOG.trace("Cannot find class so assuming not running in OSGi container: " + t.getMessage());
    return false;
  }
}
