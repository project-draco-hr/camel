{
  int pos=1;
  int counterMandatoryFields=0;
  for (  String data : tokens) {
    DataField dataField=dataFields.get(pos);
    ObjectHelper.notNull(dataField,"No position " + pos + " defined for the field : "+ data+ ", line : "+ line);
    if (dataField.required()) {
      ++counterMandatoryFields;
      if (data.equals("")) {
        throw new IllegalArgumentException("The mandatory field defined at the position " + pos + " is empty for the line : "+ line);
      }
    }
    Field field=annotedFields.get(pos);
    field.setAccessible(true);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Pos : " + pos + ", Data : "+ data+ ", Field type : "+ field.getType());
    }
    Format<?> format;
    String pattern=dataField.pattern();
    format=FormatFactory.getFormat(field.getType(),pattern,dataField.precision());
    Object modelField=model.get(field.getDeclaringClass().getName());
    Object value=null;
    if (!data.equals("")) {
      try {
        value=format.parse(data);
      }
 catch (      FormatException ie) {
        throw new IllegalArgumentException(ie.getMessage() + ", position : " + pos+ ", line : "+ line,ie);
      }
catch (      Exception e) {
        throw new IllegalArgumentException("Parsing error detected for field defined at the position : " + pos + ", line : "+ line,e);
      }
    }
 else {
      value=getDefaultValueforPrimitive(field.getType());
    }
    field.set(modelField,value);
    ++pos;
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Counter mandatory fields : " + counterMandatoryFields);
  }
  if (pos < totalFields) {
    throw new IllegalArgumentException("Some fields are missing (optional or mandatory), line : " + line);
  }
  if (counterMandatoryFields < numberMandatoryFields) {
    throw new IllegalArgumentException("Some mandatory fields are missing, line : " + line);
  }
}
