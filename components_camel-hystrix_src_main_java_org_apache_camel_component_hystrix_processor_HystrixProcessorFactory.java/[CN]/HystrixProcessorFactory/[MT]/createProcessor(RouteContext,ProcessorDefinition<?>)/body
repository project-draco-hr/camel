{
  if (definition instanceof HystrixDefinition) {
    HystrixDefinition cb=(HystrixDefinition)definition;
    Processor processor=cb.createChildProcessor(routeContext,true);
    Processor fallback=null;
    if (cb.getFallback() != null) {
      fallback=cb.getFallback().createProcessor(routeContext);
    }
    String groupKey=HystrixDefinition.DEFAULT_GROUP_KEY;
    String threadPoolKey=HystrixDefinition.DEFAULT_THREAD_POOL_KEY;
    if (cb.getGroupKey() != null) {
      groupKey=cb.getGroupKey();
    }
    if (cb.getThreadPoolKey() != null) {
      threadPoolKey=cb.getThreadPoolKey();
    }
    HystrixCommand.Setter setter=HystrixCommand.Setter.withGroupKey(HystrixCommandGroupKey.Factory.asKey(groupKey)).andThreadPoolKey(HystrixThreadPoolKey.Factory.asKey(threadPoolKey));
    HystrixCommandProperties.Setter command=HystrixCommandProperties.Setter();
    setter.andCommandPropertiesDefaults(command);
    HystrixThreadPoolProperties.Setter threadPool=HystrixThreadPoolProperties.Setter();
    setter.andThreadPoolPropertiesDefaults(threadPool);
    if (cb.getHystrixConfigurationRef() != null) {
      HystrixConfigurationDefinition config=CamelContextHelper.mandatoryLookup(routeContext.getCamelContext(),cb.getHystrixConfigurationRef(),HystrixConfigurationDefinition.class);
      configureHystrix(command,threadPool,config);
    }
    if (cb.getHystrixConfiguration() != null) {
      HystrixConfigurationDefinition config=cb.getHystrixConfiguration();
      configureHystrix(command,threadPool,config);
    }
    Expression cacheKey=null;
    if (cb.getCacheKey() != null) {
      cacheKey=cb.getCacheKey().createExpression(routeContext);
    }
    return new HystrixProcessor(setter,processor,fallback,cacheKey);
  }
 else {
    return null;
  }
}
