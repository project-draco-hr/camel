{
  String symbolicName=getClass().getSimpleName();
  if (isCreateCamelContextPerClass()) {
    boolean first=threadLocalBundleContext.get() == null;
    if (first) {
      threadLocalBundleContext.set(createBundleContext());
    }
    bundleContext=threadLocalBundleContext.get();
  }
 else {
    bundleContext=createBundleContext();
  }
  super.setUp();
  log.debug("Waiting for BlueprintContainer to be published with symbolicName: {}",symbolicName);
  getOsgiService(BlueprintContainer.class,"(osgi.blueprint.container.symbolicname=" + symbolicName + ")");
}
