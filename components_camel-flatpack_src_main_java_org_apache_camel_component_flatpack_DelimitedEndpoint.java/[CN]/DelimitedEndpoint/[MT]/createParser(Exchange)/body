{
  Reader bodyReader=ExchangeHelper.getMandatoryInBody(exchange,Reader.class);
  if (ObjectHelper.isEmpty(getDefinition())) {
    return getParserFactory().newDelimitedParser(bodyReader,delimiter,textQualifier);
  }
 else {
    InputStream is=ResourceHelper.resolveMandatoryResourceAsInputStream(getCamelContext().getClassResolver(),definition);
    InputStreamReader reader=new InputStreamReader(is,IOConverter.getCharsetName(exchange));
    return getParserFactory().newDelimitedParser(reader,bodyReader,delimiter,textQualifier,ignoreFirstRecord);
  }
}
