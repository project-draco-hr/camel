{
  Endpoint endpoint=getEndpointInjection(endpointUri,endpointRef,injectionPointName);
  if (endpoint != null) {
    if (type.isInstance(endpoint)) {
      return endpoint;
    }
 else     if (type.isAssignableFrom(Producer.class)) {
      return createInjectionProducer(endpoint);
    }
 else     if (type.isAssignableFrom(DefaultProducerTemplate.class)) {
      return new DefaultProducerTemplate(getCamelContext(),endpoint);
    }
 else     if (type.isAssignableFrom(PollingConsumer.class)) {
      return createInjectionPollingConsumer(endpoint);
    }
 else     if (type.isInterface()) {
      try {
        return ProxyHelper.createProxy(endpoint,type);
      }
 catch (      Exception e) {
        throw new BeanInstantiationException(type,"Could not instantiate proxy of type " + type.getName() + " on endpoint "+ endpoint,e);
      }
    }
 else {
      throw new IllegalArgumentException("Invalid type: " + type.getName() + " which cannot be injected via @EndpointInject for "+ endpoint);
    }
  }
  return null;
}
