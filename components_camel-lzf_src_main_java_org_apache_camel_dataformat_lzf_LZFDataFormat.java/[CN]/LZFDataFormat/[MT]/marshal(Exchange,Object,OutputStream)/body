{
  InputStream is=exchange.getContext().getTypeConverter().mandatoryConvertTo(InputStream.class,exchange,graph);
  OutputStream compressedOutput=parallelCompression ? new PLZFOutputStream(stream) : new LZFOutputStream(stream);
  try {
    IOHelper.copy(is,compressedOutput);
  }
  finally {
    IOHelper.close(is,compressedOutput);
  }
}
