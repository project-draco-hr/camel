{
  super(endpoint);
  this.endpoint=endpoint;
  context=(SpringCamelContext)endpoint.getCamelContext();
  if (context != null && endpoint.getMessageChannel() == null) {
    outputChannelName=endpoint.getDefaultChannel();
    channelRegistry=(ChannelRegistry)context.getApplicationContext().getBean(MessageBusParser.MESSAGE_BUS_BEAN_NAME);
    if (ObjectHelper.isNullOrBlank(outputChannelName)) {
      outputChannelName=endpoint.getInputChannel();
    }
    if (ObjectHelper.isNullOrBlank(outputChannelName)) {
      throw new RuntimeCamelException("Can't find the right outputChannelName, " + "please check the endpoint uri outputChannel part!");
    }
 else {
      outputChannel=(AbstractPollableChannel)channelRegistry.lookupChannel(outputChannelName);
    }
  }
 else {
    if (endpoint.getMessageChannel() != null) {
      outputChannel=endpoint.getMessageChannel();
    }
 else {
      throw new RuntimeCamelException("Can't find the right message channel, please check your configuration.");
    }
  }
  if (endpoint.isInOut()) {
    endpoint.setExchangePattern(ExchangePattern.InOut);
    if (ObjectHelper.isNullOrBlank(endpoint.getInputChannel())) {
      throw new RuntimeCamelException("Can't find the right inputChannel, " + "please check the endpoint uri inputChannel part!");
    }
 else {
      inputChannel=(AbstractPollableChannel)channelRegistry.lookupChannel(endpoint.getInputChannel());
    }
  }
}
