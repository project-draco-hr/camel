{
  CamelContextFactoryBean ccfb=(CamelContextFactoryBean)blueprintContainer.getComponentInstance(".camelBlueprint.factory." + camelContextName);
  CamelContext camelContext=ccfb.getContext();
  Set<String> components=new HashSet<String>();
  Set<String> languages=new HashSet<String>();
  Set<String> dataformats=new HashSet<String>();
  for (  RouteDefinition rd : camelContext.getRouteDefinitions()) {
    findInputComponents(rd.getInputs(),components,languages,dataformats);
    findOutputComponents(rd.getOutputs(),components,languages,dataformats);
  }
  for (  RestDefinition rd : camelContext.getRestDefinitions()) {
    for (    VerbDefinition vd : rd.getVerbs()) {
      Object o=vd.getToOrRoute();
      if (o instanceof RouteDefinition) {
        RouteDefinition route=(RouteDefinition)o;
        findInputComponents(route.getInputs(),components,languages,dataformats);
        findOutputComponents(route.getOutputs(),components,languages,dataformats);
      }
 else       if (o instanceof ToDefinition) {
        findUriComponent(((ToDefinition)o).getUri(),components);
      }
    }
  }
  try {
    for (    String component : components) {
      getComponentResolverReference(context,component);
    }
    for (    String language : languages) {
      getLanguageResolverReference(context,language);
    }
    for (    String dataformat : dataformats) {
      getDataformatResolverReference(context,dataformat);
    }
  }
 catch (  UnsupportedOperationException e) {
    LOG.warn("Unable to add dependencies to Camel components OSGi services. " + "The Apache Aries blueprint implementation used is too old and the blueprint bundle can not see the org.apache.camel.spi package.");
    components.clear();
    languages.clear();
    dataformats.clear();
  }
}
