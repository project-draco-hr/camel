{
  connectIfNecessary();
  try {
    process(endpoint.createExchange(exchange));
  }
 catch (  JSchException e) {
    LOG.warn("Disconnecting due to exception: " + e.getMessage());
    disconnect();
    throw e;
  }
catch (  SftpException e) {
    LOG.warn("Caught SftpException:" + e.getMessage(),e);
    LOG.warn("Hoping an explicit disconnect/reconnect will solve the problem");
    disconnect();
    throw e;
  }
}
