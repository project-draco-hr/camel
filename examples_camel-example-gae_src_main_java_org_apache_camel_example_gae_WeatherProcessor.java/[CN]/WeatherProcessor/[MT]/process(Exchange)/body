{
  Document doc=exchange.getIn().getBody(Document.class);
  XPathFactory xpfactory=XPathFactory.newInstance();
  XPath xpath=xpfactory.newXPath();
  String city=xpath.evaluate("//forecast_information/city/@data",doc);
  String cond=xpath.evaluate("//current_conditions/condition/@data",doc);
  String temp=xpath.evaluate("//current_conditions/temp_c/@data",doc);
  String msg=null;
  if (city != null && city.length() > 0) {
    msg=new StringBuffer().append("\n").append("Weather report for:  ").append(city).append("\n").append("Current condition:   ").append(cond).append("\n").append("Current temperature: ").append(temp).append(" (Celsius)").toString();
  }
 else {
    msg="Error getting weather report for " + exchange.getIn().getHeader("city",String.class);
  }
  exchange.getIn().setBody(msg);
}
