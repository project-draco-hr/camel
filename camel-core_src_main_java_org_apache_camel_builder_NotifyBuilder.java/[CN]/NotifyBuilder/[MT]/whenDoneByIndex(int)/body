{
  stack.add(new EventPredicateSupport(){
    private int current;
    private String id;
    private boolean done;
    @Override public boolean onExchangeCreated(    Exchange exchange){
      if (current == index) {
        id=exchange.getExchangeId();
      }
      current++;
      return true;
    }
    @Override public boolean onExchangeCompleted(    Exchange exchange){
      if (exchange.getExchangeId().equals(id)) {
        done=true;
      }
      return true;
    }
    @Override public boolean onExchangeFailed(    Exchange exchange){
      if (exchange.getExchangeId().equals(id)) {
        done=true;
      }
      return true;
    }
    public boolean matches(){
      return done;
    }
    @Override public void reset(){
      current=0;
      id=null;
      done=false;
    }
    @Override public String toString(){
      return "whenDoneByIndex(" + index + ")";
    }
  }
);
  return this;
}
