{
  AmazonS3ClientMock mock=new AmazonS3ClientMock();
  ((JndiRegistry)((PropertyPlaceholderDelegateRegistry)context.getRegistry()).getRegistry()).bind("amazonS3Client",mock);
  S3Component component=new S3Component(context);
  S3Endpoint endpoint=(S3Endpoint)component.createEndpoint("aws-s3://MyBucket?amazonS3Client=#amazonS3Client");
  assertEquals("MyBucket",endpoint.getConfiguration().getBucketName());
  assertNull(endpoint.getConfiguration().getAccessKey());
  assertNull(endpoint.getConfiguration().getSecretKey());
  assertSame(mock,endpoint.getConfiguration().getAmazonS3Client());
  assertNull(endpoint.getConfiguration().getRegion());
  assertTrue(endpoint.getConfiguration().isDeleteAfterRead());
  assertEquals(10,endpoint.getMaxMessagesPerPoll());
  assertNull(endpoint.getConfiguration().getAmazonS3Endpoint());
  assertNull(endpoint.getConfiguration().getPolicy());
  assertNull(endpoint.getConfiguration().getPrefix());
  assertTrue(endpoint.getConfiguration().isIncludeBody());
}
