{
  port=AvailablePortFinder.getNextAvailable(12000);
  port2=AvailablePortFinder.getNextAvailable(12100);
  port3=AvailablePortFinder.getNextAvailable(12200);
  return new RouteBuilder(){
    @Override public void configure() throws Exception {
      from("jetty:http://localhost:" + port + "/myapp?matchOnUriPrefix=true").loadBalance().roundRobin().to("http4://localhost:" + port2 + "/foo?bridgeEndpoint=true&throwExceptionOnFailure=false").to("http4://localhost:" + port3 + "/bar?bridgeEndpoint=true&throwExceptionOnFailure=false");
      from("jetty:http://localhost:" + port2 + "/foo").transform().constant("foo");
      from("jetty:http://localhost:" + port3 + "/bar").transform().constant("bar");
    }
  }
;
}
