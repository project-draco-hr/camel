{
  MockEndpoint end=getMockEndpoint("mock:end");
  end.expectedMessageCount(0);
  try {
    sendMessageWithAuthentication("bob","jimspassword");
    fail("we should get the access deny exception here");
  }
 catch (  Exception exception) {
    assertTrue("Expect CamelAuthorizationException here",exception.getCause() instanceof CamelAuthorizationException);
    assertEquals("admin",((CamelAuthorizationException)exception.getCause()).getPolicyId());
  }
  end.assertIsSatisfied();
}
