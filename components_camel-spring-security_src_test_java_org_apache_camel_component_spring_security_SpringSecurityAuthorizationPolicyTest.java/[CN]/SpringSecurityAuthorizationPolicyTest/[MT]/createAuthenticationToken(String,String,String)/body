{
  Authentication authToken;
  if (roles != null && roles.length > 0) {
    GrantedAuthority[] authorities=new GrantedAuthority[roles.length];
    for (int i=0; i < roles.length; i++) {
      authorities[i]=new GrantedAuthorityImpl(roles[i]);
    }
    authToken=new UsernamePasswordAuthenticationToken(username,password,authorities);
  }
 else {
    authToken=new UsernamePasswordAuthenticationToken(username,password);
  }
  return authToken;
}
