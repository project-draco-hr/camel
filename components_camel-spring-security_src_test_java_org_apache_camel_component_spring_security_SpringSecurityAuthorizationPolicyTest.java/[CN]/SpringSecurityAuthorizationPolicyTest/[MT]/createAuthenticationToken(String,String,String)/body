{
  Authentication authToken;
  if (roles != null && roles.length > 0) {
    List<GrantedAuthority> authorities=new ArrayList<GrantedAuthority>(roles.length);
    for (int i=0; i < roles.length; i++) {
      authorities.add(new GrantedAuthorityImpl(roles[i]));
    }
    authToken=new UsernamePasswordAuthenticationToken(username,password,authorities);
  }
 else {
    authToken=new UsernamePasswordAuthenticationToken(username,password);
  }
  return authToken;
}
