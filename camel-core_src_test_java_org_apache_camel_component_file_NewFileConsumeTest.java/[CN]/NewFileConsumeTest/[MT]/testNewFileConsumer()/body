{
  deleteDirectory("target/consumefile");
  NewFileComponent comp=new NewFileComponent();
  comp.setCamelContext(context);
  createDirectory("target/consumefile");
  FileOutputStream fos=new FileOutputStream(new File("target/consumefile/hello.txt"));
  fos.write("Hello World".getBytes());
  fos.close();
  Endpoint endpoint=comp.createEndpoint("newfile://target/consumefile","target/consumefile",new HashMap());
  Consumer consumer=endpoint.createConsumer(new Processor(){
    public void process(    Exchange exchange) throws Exception {
      assertNotNull(exchange);
      String body=exchange.getIn().getBody(String.class);
      assertEquals("Hello World",body);
      latch.countDown();
    }
  }
);
  consumer.start();
  latch.await();
  consumer.stop();
}
