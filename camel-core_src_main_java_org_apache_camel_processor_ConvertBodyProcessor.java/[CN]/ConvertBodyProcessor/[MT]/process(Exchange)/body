{
  Message in=exchange.getIn();
  if (charset != null) {
    exchange.setProperty(Exchange.CHARSET_NAME,charset);
  }
  Object value=in.getMandatoryBody(type);
  if (exchange.getPattern().isOutCapable()) {
    Message out=exchange.getOut();
    out.copyFrom(in);
    out.setBody(value);
  }
 else {
    in.setBody(value);
  }
}
