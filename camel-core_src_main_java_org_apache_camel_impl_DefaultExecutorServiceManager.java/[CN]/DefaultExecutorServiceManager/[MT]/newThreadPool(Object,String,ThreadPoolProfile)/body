{
  ObjectHelper.notNull(profile,"ThreadPoolProfile");
  ThreadPoolProfile defaultProfile=getDefaultThreadPoolProfile();
  Integer poolSize=profile.getPoolSize() != null ? profile.getPoolSize() : defaultProfile.getPoolSize();
  Integer maxPoolSize=profile.getMaxPoolSize() != null ? profile.getMaxPoolSize() : defaultProfile.getMaxPoolSize();
  Long keepAliveTime=profile.getKeepAliveTime() != null ? profile.getKeepAliveTime() : defaultProfile.getKeepAliveTime();
  TimeUnit timeUnit=profile.getTimeUnit() != null ? profile.getTimeUnit() : defaultProfile.getTimeUnit();
  Integer maxQueueSize=profile.getMaxQueueSize() != null ? profile.getMaxQueueSize() : defaultProfile.getMaxQueueSize();
  RejectedExecutionHandler handler=profile.getRejectedExecutionHandler() != null ? profile.getRejectedExecutionHandler() : defaultProfile.getRejectedExecutionHandler();
  ThreadFactory threadFactory=createThreadFactory(name,true);
  ExecutorService executorService=threadPoolFactory.newThreadPool(poolSize,maxPoolSize,keepAliveTime,timeUnit,maxQueueSize,handler,threadFactory);
  onThreadPoolCreated(executorService,source,profile.getId());
  return executorService;
}
