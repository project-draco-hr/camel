{
  ErrorHandlerBuilder answer;
  if (!isErrorHandlerBuilderConfigured(ref)) {
    answer=routeContext.getRoute().getErrorHandlerBuilder();
    if (answer == null && routeContext.getRoute().getErrorHandlerRef() != null) {
      answer=routeContext.lookup(routeContext.getRoute().getErrorHandlerRef(),ErrorHandlerBuilder.class);
    }
    if (answer == null) {
      answer=new DefaultErrorHandlerBuilder();
    }
    if (answer instanceof ErrorHandlerBuilderRef) {
      ErrorHandlerBuilderRef other=(ErrorHandlerBuilderRef)answer;
      String otherRef=other.getRef();
      if (!isErrorHandlerBuilderConfigured(otherRef)) {
        answer=lookupErrorHandlerBuilder(routeContext.getCamelContext());
      }
      if (answer == null) {
        answer=new DefaultErrorHandlerBuilder();
      }
      answer.setErrorHandlers(other.getErrorHandlers());
    }
  }
 else {
    answer=routeContext.lookup(ref,ErrorHandlerBuilder.class);
    if (answer == null) {
      throw new IllegalArgumentException("ErrorHandlerBuilder with id " + ref + " not found in registry.");
    }
  }
  return answer;
}
