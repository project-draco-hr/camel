{
  boolean authorized=false;
  if (!permissionsList.isEmpty()) {
    for (    Permission permission : permissionsList) {
      if (currentUser.isPermitted(permission)) {
        authorized=true;
        break;
      }
    }
  }
 else {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Valid Permissions List not specified for ShiroSecurityPolicy. No authorization checks will be performed for current user");
    }
    authorized=true;
  }
  if (!authorized) {
    throw new CamelAuthorizationException("Authorization Failed. Subject's role set does not have the necessary permissions to perform further processing",exchange);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Current User " + currentUser.getPrincipal() + " is successfully authorized. The exchange will be allowed to proceed");
  }
}
