{
  if (resource == null) {
    resource=getResource();
  }
  InputStream is=null;
  if (contentCache) {
synchronized (resource) {
      if (buffer == null) {
        log.debug("Reading resource: {} into the content cache",resourceUri);
        is=getResourceAsInputStreamWithoutCache();
        buffer=IOConverter.toBytes(is);
      }
    }
    log.debug("Using resource: {} from the content cache",resourceUri);
    return new ByteArrayInputStream(buffer);
  }
  return getResourceAsInputStreamWithoutCache();
}
