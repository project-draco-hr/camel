{
  ObjectHelper.notNull(statement,"statement",this);
  MyBatisConsumer consumer=new MyBatisConsumer(this,processor);
  consumer.setMaxMessagesPerPoll(getMaxMessagesPerPoll());
  consumer.setOnConsume(getOnConsume());
  consumer.setUseIterator(isUseIterator());
  consumer.setRouteEmptyResultSet(isRouteEmptyResultSet());
  configureConsumer(consumer);
  return consumer;
}
