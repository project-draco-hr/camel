{
  String id=UUID.randomUUID().toString();
  String rev=UUID.randomUUID().toString();
  Response response=new Response();
  response.setId(id);
  response.setRev(rev);
  JsonObject doc=new JsonObject();
  doc.addProperty("_id",id);
  doc.addProperty("_rev",rev);
  when(msg.getMandatoryBody()).thenReturn(doc);
  when(client.update(doc)).thenReturn(response);
  producer.process(exchange);
  verify(msg).setHeader(CouchDbConstants.HEADER_DOC_ID,id);
  verify(msg).setHeader(CouchDbConstants.HEADER_DOC_REV,rev);
}
