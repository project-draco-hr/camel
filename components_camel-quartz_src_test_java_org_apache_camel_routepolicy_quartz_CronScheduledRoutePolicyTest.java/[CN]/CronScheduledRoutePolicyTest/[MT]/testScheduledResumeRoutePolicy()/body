{
  MockEndpoint success=(MockEndpoint)context.getEndpoint("mock:success");
  success.expectedMessageCount(1);
  context.getComponent("quartz",QuartzComponent.class).setPropertiesFile("org/apache/camel/routepolicy/quartz/myquartz.properties");
  context.addRoutes(new RouteBuilder(){
    public void configure(){
      CronScheduledRoutePolicy policy=new CronScheduledRoutePolicy();
      policy.setRouteResumeTime("*/3 * * * * ?");
      from("direct:start").routeId("test").routePolicy(policy).to("mock:success");
    }
  }
);
  context.start();
  ServiceHelper.suspendService(context.getRoute("test").getConsumer());
  try {
    template.sendBody("direct:start","Ready or not, Here, I come");
  }
 catch (  CamelExecutionException e) {
    LOG.debug("Consumer successfully suspended");
  }
  Thread.sleep(4000);
  template.sendBody("direct:start","Ready or not, Here, I come");
  context.getComponent("quartz",QuartzComponent.class).stop();
  success.assertIsSatisfied();
}
