{
  try {
    String correlationID=message.getJMSCorrelationID();
    if (LOG.isDebugEnabled()) {
      LOG.debug("Message correlationID: " + correlationID);
    }
    if (correlationID == null) {
      LOG.warn("Ignoring message with no correlationID! " + message);
      return;
    }
    Object handler=requestMap.get(correlationID);
    if (handler != null && handler instanceof ReplyHandler) {
      ReplyHandler replyHandler=(ReplyHandler)handler;
      boolean complete=replyHandler.handle(message);
      if (complete) {
        requestMap.remove(correlationID);
      }
    }
 else {
      DeferredRequestReplyMap.processDeferredRequests(this,deferredRequestMap,deferredReplyMap,correlationID,getMaxRequestTimeout(),message);
    }
  }
 catch (  JMSException e) {
    throw new FailedToProcessResponse(message,e);
  }
}
