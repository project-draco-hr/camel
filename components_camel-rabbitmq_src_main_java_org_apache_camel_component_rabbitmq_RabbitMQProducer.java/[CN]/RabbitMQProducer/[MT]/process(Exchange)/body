{
  String exchangeName=exchange.getIn().getHeader(RabbitMQConstants.EXCHANGE_NAME,String.class);
  if (exchangeName == null || getEndpoint().isBridgeEndpoint()) {
    exchangeName=getEndpoint().getExchangeName();
  }
  String key=exchange.getIn().getHeader(RabbitMQConstants.ROUTING_KEY,null,String.class);
  if (key == null) {
    key=getEndpoint().getRoutingKey() == null ? "" : getEndpoint().getRoutingKey();
  }
  if (ObjectHelper.isEmpty(key) && ObjectHelper.isEmpty(exchangeName)) {
    throw new IllegalArgumentException("ExchangeName and RoutingKey is not provided in the endpoint: " + getEndpoint());
  }
  byte[] messageBodyBytes=exchange.getIn().getMandatoryBody(byte[].class);
  AMQP.BasicProperties.Builder properties=buildProperties(exchange);
  channel.basicPublish(exchangeName,key,properties.build(),messageBodyBytes);
}
