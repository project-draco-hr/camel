{
  String exchangeName=exchange.getIn().getHeader(RabbitMQConstants.EXCHANGE_NAME,String.class);
  if (exchangeName == null || getEndpoint().isBridgeEndpoint()) {
    exchangeName=getEndpoint().getExchangeName();
  }
  if (ObjectHelper.isEmpty(exchangeName)) {
    throw new IllegalArgumentException("ExchangeName is not provided in the endpoint: " + getEndpoint());
  }
  String key=exchange.getIn().getHeader(RabbitMQConstants.ROUTING_KEY,"",String.class);
  if (key.trim().length() == 0) {
    key=getEndpoint().getRoutingKey() == null ? "" : getEndpoint().getRoutingKey();
  }
  byte[] messageBodyBytes=exchange.getIn().getMandatoryBody(byte[].class);
  AMQP.BasicProperties.Builder properties=buildProperties(exchange);
  channel.basicPublish(exchangeName,key,properties.build(),messageBodyBytes);
}
