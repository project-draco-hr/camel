{
  Cache<K,V> cache=cacheManager.getCache(name,keyType,valueType);
  if (cache == null && configuration != null && configuration.isCreateCacheIfNotExist()) {
    final CacheConfiguration config=configuration.getCacheConfiguration(name);
    final ResourcePools pools=configuration.getResourcePools(name);
    if (config == null && pools == null) {
      throw new IllegalArgumentException("No cache config and resource pools for cache " + name);
    }
    cache=cacheManager.createCache(name,config != null ? config : newCacheConfigurationBuilder(keyType,valueType,pools).build());
  }
  return cache;
}
