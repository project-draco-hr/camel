{
  ExchangePattern pattern;
  boolean result=false;
  if (isExpectReply()) {
    pattern=ExchangePattern.InOut;
  }
 else {
    pattern=ExchangePattern.InOnly;
  }
  Exchange inExchange=new DefaultExchange(getCamelContext(),pattern);
  SpringIntegrationBinding.storeToCamelMessage(message,inExchange.getIn());
  Exchange outExchange=getCamelTemplate().send(getCamelEndpointUri(),inExchange);
  if (outExchange.getOut() != null && outExchange.getOut().isFault()) {
    result=true;
  }
  Message response=null;
  if (isExpectReply()) {
    response=SpringIntegrationBinding.storeToSpringIntegrationMessage(outExchange.getOut());
    if (replyChannel == null) {
      MessageChannel messageReplyChannel=(MessageChannel)message.getHeaders().get(MessageHeaders.REPLY_CHANNEL);
      if (messageReplyChannel != null) {
        result=messageReplyChannel.send(response);
      }
 else {
        throw new MessageDeliveryException(response,"Can't find reply channel from the CamelTargetAdapter or MessageHeaders");
      }
    }
 else {
      result=replyChannel.send(response);
    }
  }
  return result;
}
