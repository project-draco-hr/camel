{
  boolean success=false;
  String originalDirectory=getCurrentDirectory();
  try {
    try {
      channel.cd(dirName);
      success=true;
    }
 catch (    SftpException e) {
    }
    if (!success) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Trying to build remote directory: " + dirName);
      }
      try {
        channel.mkdir(dirName);
        success=true;
      }
 catch (      SftpException e) {
        success=buildDirectoryChunks(dirName);
      }
    }
  }
 catch (  IOException e) {
    throw new RemoteFileOperationFailedException("Cannot build directory " + dirName,e);
  }
catch (  SftpException e) {
    throw new RemoteFileOperationFailedException("Cannot build directory " + dirName,e);
  }
 finally {
    if (originalDirectory != null) {
      changeCurrentDirectory(originalDirectory);
    }
  }
  return success;
}
