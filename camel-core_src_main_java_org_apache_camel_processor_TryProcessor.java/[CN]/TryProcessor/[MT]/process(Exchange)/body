{
  Throwable e=null;
  try {
    tryProcessor.process(exchange);
    e=exchange.getException();
    if (e != null && DeadLetterChannel.isFailureHandled(exchange)) {
      e=null;
    }
  }
 catch (  Throwable ex) {
    e=ex;
    exchange.setException(e);
  }
  Exception unexpected=null;
  try {
    if (e != null) {
      LOG.info("Caught exception while processing exchange.",e);
      handleException(exchange,e);
    }
  }
 catch (  Exception ex) {
    unexpected=ex;
  }
catch (  Throwable ex) {
    unexpected=new RuntimeCamelException(ex);
  }
 finally {
    try {
      processFinally(exchange);
    }
 catch (    Exception ex) {
      unexpected=ex;
    }
catch (    Throwable ex) {
      unexpected=new RuntimeCamelException(ex);
    }
    if (unexpected != null) {
      LOG.warn("Caught exception inside processFinally clause.",unexpected);
      throw unexpected;
    }
  }
  if (unexpected != null) {
    LOG.warn("Caught exception inside handle clause.",unexpected);
    throw unexpected;
  }
}
