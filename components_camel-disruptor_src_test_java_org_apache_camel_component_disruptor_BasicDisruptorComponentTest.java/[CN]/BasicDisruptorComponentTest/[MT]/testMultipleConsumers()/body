{
  threadCounter.reset();
  final int messagesSent=1000;
  resultEndpoint.setExpectedMessageCount(messagesSent);
  for (int i=0; i < messagesSent; ++i) {
    template.asyncSendBody("disruptor:testMultipleConsumers",VALUE);
  }
  resultEndpoint.await(20,TimeUnit.SECONDS);
  Thread.sleep(1000);
  resultEndpoint.assertIsSatisfied();
  int count=threadCounter.getThreadIdCount();
  assertTrue("Should be " + count + " >= 4",count >= 4);
}
