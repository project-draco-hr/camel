{
  threadCounter.reset();
  final int messagesSent=1000;
  resultEndpoint.setExpectedMessageCount(messagesSent);
  for (int i=0; i < messagesSent; ++i) {
    template.sendBody("disruptor:testMultipleConsumers",VALUE);
  }
  resultEndpoint.await(20,TimeUnit.SECONDS);
  Thread.sleep(1000);
  resultEndpoint.assertIsSatisfied();
  assertEquals(4,threadCounter.getThreadIdCount());
}
