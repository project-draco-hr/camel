{
  assertNotNull(iAgent.getMBeanServer());
  resolveMandatoryEndpoint("mock:end",MockEndpoint.class);
  Set s=iAgent.getMBeanServer().queryNames(new ObjectName(domainName + ":type=endpoint,*"),null);
  assertEquals("Could not find 2 endpoints: " + s,2,s.size());
  s=iAgent.getMBeanServer().queryNames(new ObjectName(domainName + ":type=context,*"),null);
  assertEquals("Could not find 1 context: " + s,1,s.size());
  s=iAgent.getMBeanServer().queryNames(new ObjectName(domainName + ":type=processor,*"),null);
  assertEquals("Could not find 1 processor: " + s,1,s.size());
  s=iAgent.getMBeanServer().queryNames(new ObjectName(domainName + ":type=route,*"),null);
  assertEquals("Could not find 1 route: " + s,1,s.size());
  if (sleepSoYouCanBrowseInJConsole) {
    Thread.sleep(100000);
  }
}
