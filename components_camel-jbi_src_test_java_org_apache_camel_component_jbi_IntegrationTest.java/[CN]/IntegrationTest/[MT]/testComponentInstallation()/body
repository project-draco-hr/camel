{
  CamelJbiComponent component=new CamelJbiComponent();
  container.activateComponent(component,"#ServiceMixComponent#");
  URL url=getClass().getResource("su1-src/camel-context.xml");
  File path=new File(new URI(url.toString()));
  path=path.getParentFile();
  ServiceMixClient client=new DefaultServiceMixClient(container);
  for (int i=0; i < 2; i++) {
    component.getServiceUnitManager().deploy("su1",path.getAbsolutePath());
    component.getServiceUnitManager().init("su1",path.getAbsolutePath());
    component.getServiceUnitManager().start("su1");
    InOut inout=client.createInOutExchange();
    ServiceEndpoint endpoint=client.getContext().getEndpoint(CamelJbiEndpoint.SERVICE_NAME,"queue:a");
    inout.setEndpoint(endpoint);
    client.send(inout);
    component.getServiceUnitManager().stop("su1");
    component.getServiceUnitManager().shutDown("su1");
    component.getServiceUnitManager().undeploy("su1",path.getAbsolutePath());
    inout=client.createInOutExchange();
    inout.setEndpoint(endpoint);
    try {
      client.send(inout);
    }
 catch (    MessagingException e) {
    }
  }
}
