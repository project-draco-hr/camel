{
  Acceptor acceptor;
  if (threadModel == ThreadModel.ThreadPerSession) {
    acceptor=new ThreadedSocketAcceptor(application,messageStoreFactory,settings,sessionLogFactory,messageFactory);
  }
 else   if (threadModel == ThreadModel.ThreadPerConnector) {
    acceptor=new SocketAcceptor(application,messageStoreFactory,settings,sessionLogFactory,messageFactory);
  }
 else {
    throw new ConfigError("Unknown thread mode: " + threadModel);
  }
  return acceptor;
}
