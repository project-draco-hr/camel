{
  assert(exchange != null);
  int id=batchCount.getAndIncrement();
  int batchSize=exchange.getProperty(SjmsBatchEndpoint.PROPERTY_BATCH_SIZE,Integer.class);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Processing batch[" + id + "]:size="+ batchSize+ ":total="+ messagesReceived.addAndGet(batchSize));
  }
  SessionCompletion sessionCompletion=new SessionCompletion(session);
  exchange.addOnCompletion(sessionCompletion);
  try {
    processor.process(exchange);
    LOG.debug("Completed processing[{}]:total={}",id,messagesProcessed.addAndGet(batchSize));
  }
 catch (  Exception e) {
    LOG.error("Error processing exchange: {}",e.getMessage());
  }
}
