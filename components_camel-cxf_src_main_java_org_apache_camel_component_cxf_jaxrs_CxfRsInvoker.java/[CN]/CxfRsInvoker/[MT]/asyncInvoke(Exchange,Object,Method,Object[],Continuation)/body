{
synchronized (continuation) {
    if (continuation.isNew()) {
      ExchangePattern ep=ExchangePattern.InOut;
      if (method.getReturnType() == Void.class) {
        ep=ExchangePattern.InOnly;
      }
      final org.apache.camel.Exchange camelExchange=endpoint.createExchange(ep);
      CxfRsBinding binding=endpoint.getBinding();
      binding.populateExchangeFromCxfRsRequest(cxfExchange,camelExchange,method,paramArray);
      cxfRsConsumer.createUoW(camelExchange);
      LOG.trace("Suspending continuation of exchangeId: {}",camelExchange.getExchangeId());
      continuation.suspend(0);
      cxfExchange.put(SUSPENED,Boolean.TRUE);
      cxfRsConsumer.getAsyncProcessor().process(camelExchange,new AsyncCallback(){
        public void done(        boolean doneSync){
synchronized (continuation) {
            LOG.trace("Resuming continuation of exchangeId: {}",camelExchange.getExchangeId());
            continuation.setObject(camelExchange);
            continuation.resume();
          }
        }
      }
);
      return null;
    }
    if (continuation.isResumed()) {
      cxfExchange.put(SUSPENED,Boolean.FALSE);
      org.apache.camel.Exchange camelExchange=(org.apache.camel.Exchange)continuation.getObject();
      try {
        return returnResponse(cxfExchange,camelExchange);
      }
  finally {
        cxfRsConsumer.doneUoW(camelExchange);
      }
    }
  }
  return null;
}
