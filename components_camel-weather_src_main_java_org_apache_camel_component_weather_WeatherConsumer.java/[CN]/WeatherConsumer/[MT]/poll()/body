{
  LOG.debug("Going to execute the Weather query {}",query);
  String weather=getEndpoint().getCamelContext().getTypeConverter().mandatoryConvertTo(String.class,new URL(query));
  LOG.debug("Got back the Weather information {}",weather);
  if (ObjectHelper.isEmpty(weather)) {
    throw new IllegalStateException("Got the unexpected value '" + weather + "' as the result of the query '"+ query+ "'");
  }
  Exchange exchange=getEndpoint().createExchange();
  String header=getEndpoint().getConfiguration().getHeaderName();
  if (header != null) {
    exchange.getIn().setHeader(header,weather);
  }
 else {
    exchange.getIn().setBody(weather);
  }
  exchange.getIn().setHeader(WeatherConstants.WEATHER_QUERY,query);
  getProcessor().process(exchange);
  return 1;
}
