{
  ByteArrayOutputStream bout=(ByteArrayOutputStream)currentStream;
  if (outputDir == null) {
    tempFile=FileUtil.createTempFile("cos","tmp");
  }
 else {
    tempFile=FileUtil.createTempFile("cos","tmp",outputDir,false);
  }
  currentStream=new BufferedOutputStream(new FileOutputStream(tempFile));
  bout.writeTo(currentStream);
  inMemory=false;
  streamList.add(currentStream);
}
