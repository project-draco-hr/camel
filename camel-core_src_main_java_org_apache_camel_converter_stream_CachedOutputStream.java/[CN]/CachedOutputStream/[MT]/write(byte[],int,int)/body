{
  if (!outputLocked) {
    onWrite();
    this.totalLength+=len;
    if (inMemory && totalLength > threshold && currentStream instanceof ByteArrayOutputStream) {
      createFileOutputStream();
    }
    currentStream.write(b,off,len);
  }
}
