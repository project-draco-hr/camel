{
  if (!outputLocked) {
    onWrite();
    this.totalLength++;
    if (inMemory && totalLength > threshold && currentStream instanceof ByteArrayOutputStream) {
      createFileOutputStream();
    }
    currentStream.write(b);
  }
}
