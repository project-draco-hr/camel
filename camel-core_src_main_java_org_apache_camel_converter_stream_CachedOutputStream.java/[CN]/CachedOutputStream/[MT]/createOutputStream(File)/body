{
  OutputStream out=new BufferedOutputStream(new FileOutputStream(file));
  if (ObjectHelper.isNotEmpty(cipherTransformation)) {
    try {
      if (ciphers == null) {
        ciphers=new CipherPair(cipherTransformation);
      }
    }
 catch (    GeneralSecurityException e) {
      throw new IOException(e.getMessage(),e);
    }
    out=new CipherOutputStream(out,ciphers.getEncryptor()){
      boolean closed;
      public void close() throws IOException {
        if (!closed) {
          super.close();
          closed=true;
        }
      }
    }
;
  }
  return out;
}
