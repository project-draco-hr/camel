{
  flush();
  ByteArrayOutputStream bout=(ByteArrayOutputStream)currentStream;
  tempFile=FileUtil.createTempFile("cos",".tmp",strategy.getTemporaryDirectory());
  LOG.trace("Creating temporary stream cache file: {}",tempFile);
  try {
    currentStream=createOutputStream(tempFile);
    bout.writeTo(currentStream);
  }
  finally {
    inMemory=false;
  }
}
