{
  this.strategy=exchange.getContext().getStreamCachingStrategy();
  currentStream=new ByteArrayOutputStream(strategy.getBufferSize());
  if (closedOnCompletion) {
    exchange.addOnCompletion(new SynchronizationAdapter(){
      @Override public void onDone(      Exchange exchange){
        try {
          if (fileInputStreamCache != null) {
            fileInputStreamCache.close();
          }
          close();
        }
 catch (        Exception e) {
          LOG.warn("Error deleting temporary cache file: " + tempFile,e);
        }
      }
      @Override public String toString(){
        return "OnCompletion[CachedOutputStream]";
      }
    }
);
  }
}
