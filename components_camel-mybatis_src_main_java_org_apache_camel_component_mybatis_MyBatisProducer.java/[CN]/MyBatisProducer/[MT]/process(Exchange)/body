{
  SqlSession session=endpoint.getSqlSessionFactory().openSession();
  try {
switch (endpoint.getStatementType()) {
case SelectOne:
      doSelectOne(exchange,session);
    break;
case SelectList:
  doSelectList(exchange,session);
break;
case Insert:
doInsert(exchange,session);
break;
case InsertList:
doInsertList(exchange,session);
break;
case Update:
doUpdate(exchange,session);
break;
case Delete:
doDelete(exchange,session);
break;
default :
throw new IllegalArgumentException("Unsupported statementType: " + endpoint.getStatementType());
}
session.commit();
}
 catch (Exception e) {
session.rollback();
throw e;
}
 finally {
session.close();
}
}
