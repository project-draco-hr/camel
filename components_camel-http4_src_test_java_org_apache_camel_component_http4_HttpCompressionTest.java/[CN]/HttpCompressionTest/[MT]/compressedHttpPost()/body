{
  Exchange exchange=template.request("http4://" + getHostName() + ":"+ getPort()+ "/",new Processor(){
    public void process(    Exchange exchange) throws Exception {
      exchange.getIn().setHeader(Exchange.CONTENT_TYPE,"text/plain");
      exchange.getIn().setHeader(Exchange.CONTENT_ENCODING,"gzip");
      exchange.getIn().setBody(getBody());
    }
  }
);
  assertNotNull(exchange);
  Message out=exchange.getOut();
  assertNotNull(out);
  Map<String,Object> headers=out.getHeaders();
  assertEquals(HttpStatus.SC_OK,headers.get(Exchange.HTTP_RESPONSE_CODE));
  assertEquals("gzip",headers.get("Content-Encoding"));
  assertBody(out.getBody(String.class));
}
