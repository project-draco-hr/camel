{
  uri=uri.startsWith("servlet:") ? remaining : uri;
  HttpClientParams params=new HttpClientParams();
  IntrospectionSupport.setProperties(params,parameters,"httpClient.");
  HttpClientConfigurer configurer=createHttpClientConfigurer(parameters);
  HttpBinding binding=resolveAndRemoveReferenceParameter(parameters,"httpBindingRef",HttpBinding.class);
  Boolean matchOnUriPrefix=getAndRemoveParameter(parameters,"matchOnUriPrefix",Boolean.class);
  URI httpUri=URISupport.createRemainingURI(new URI(UnsafeUriCharactersEncoder.encode(uri)),CastUtils.cast(parameters));
  uri=httpUri.toString();
  ServletEndpoint endpoint=createServletEndpoint(uri,this,httpUri,params,getHttpConnectionManager(),configurer);
  setEndpointHeaderFilterStrategy(endpoint);
  if (binding == null) {
    binding=getHttpBinding();
  }
  if (binding != null) {
    endpoint.setBinding(binding);
  }
  if (matchOnUriPrefix != null) {
    endpoint.setMatchOnUriPrefix(matchOnUriPrefix);
  }
  setProperties(endpoint,parameters);
  return endpoint;
}
