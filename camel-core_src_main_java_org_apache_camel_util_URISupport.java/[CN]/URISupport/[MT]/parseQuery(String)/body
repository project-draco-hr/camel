{
  if (uri != null && uri.endsWith("&")) {
    throw new URISyntaxException(uri,"Invalid uri syntax: Trailing & marker found. " + "Check the uri and remove the trailing & marker.");
  }
  try {
    Map<String,Object> rc=new LinkedHashMap<String,Object>();
    if (uri != null) {
      String[] parameters=uri.split("&");
      for (      String parameter : parameters) {
        int p=parameter.indexOf("=");
        if (p >= 0) {
          String name=URLDecoder.decode(parameter.substring(0,p),CHARSET);
          String value=URLDecoder.decode(parameter.substring(p + 1),CHARSET);
          rc.put(name,value);
        }
 else {
          rc.put(parameter,null);
        }
      }
    }
    return rc;
  }
 catch (  UnsupportedEncodingException e) {
    URISyntaxException se=new URISyntaxException(e.toString(),"Invalid encoding");
    se.initCause(e);
    throw se;
  }
}
