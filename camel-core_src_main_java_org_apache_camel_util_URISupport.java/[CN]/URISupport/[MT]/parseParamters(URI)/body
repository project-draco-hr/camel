{
  String query=uri.getQuery();
  if (query == null) {
    String schemeSpecificPart=uri.getSchemeSpecificPart();
    int idx=schemeSpecificPart.lastIndexOf('?');
    if (idx < 0) {
      return Collections.EMPTY_MAP;
    }
 else {
      query=schemeSpecificPart.substring(idx + 1);
    }
  }
 else {
    query=stripPrefix(query,"?");
  }
  return parseQuery(query);
}
