{
  deleteDirectory(FTP_ROOT_DIR);
  super.setUp();
  canTest=true;
  try {
    sshd=SshServer.setUpDefaultServer();
    sshd.setPort(getPort());
    sshd.setKeyPairProvider(new FileKeyPairProvider(new String[]{"src/test/resources/hostkey.pem"}));
    sshd.setSubsystemFactories(Arrays.<NamedFactory<Command>>asList(new SftpSubsystem.Factory()));
    sshd.setCommandFactory(new ScpCommandFactory());
    sshd.setPasswordAuthenticator(new MyPasswordAuthenticator());
    sshd.start();
  }
 catch (  Exception e) {
    NoSuchAlgorithmException nsae=ObjectHelper.getException(NoSuchAlgorithmException.class,e);
    if (nsae != null) {
      canTest=false;
      log.warn("SunX509 is not avail on this platform [{0}] Testing is skipped! Real cause: {1}",System.getProperty("os.name"),nsae.getMessage());
    }
 else {
      throw e;
    }
  }
}
