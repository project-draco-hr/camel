{
  Message testEmail=createTestEmail();
  Map<String,Object> headers=new HashMap<String,Object>();
  headers.put("CamelGoogleMail.userId",CURRENT_USERID);
  headers.put("CamelGoogleMail.content",testEmail);
  com.google.api.services.gmail.model.Message result=requestBodyAndHeaders("direct://SEND",null,headers);
  assertNotNull("send result",result);
  String testEmailId=result.getId();
  headers=new HashMap<String,Object>();
  headers.put("CamelGoogleMail.q","subject:\"Hello from camel-google-mail\"");
  ListMessagesResponse listOfMessages=requestBody("direct://LIST",CURRENT_USERID);
  assertTrue(idInList(testEmailId,listOfMessages));
  headers=new HashMap<String,Object>();
  headers.put("CamelGoogleMail.userId",CURRENT_USERID);
  headers.put("CamelGoogleMail.id",testEmailId);
  requestBodyAndHeaders("direct://TRASH",null,headers);
  headers=new HashMap<String,Object>();
  headers.put("CamelGoogleMail.q","subject:\"Hello from camel-google-mail\"");
  listOfMessages=requestBody("direct://LIST",CURRENT_USERID);
  assertFalse(idInList(testEmailId,listOfMessages));
  headers=new HashMap<String,Object>();
  headers.put("CamelGoogleMail.userId",CURRENT_USERID);
  headers.put("CamelGoogleMail.id",testEmailId);
  requestBodyAndHeaders("direct://UNTRASH",null,headers);
  headers=new HashMap<String,Object>();
  headers.put("CamelGoogleMail.q","subject:\"Hello from camel-google-mail\"");
  listOfMessages=requestBody("direct://LIST",CURRENT_USERID);
  assertTrue(idInList(testEmailId,listOfMessages));
  headers=new HashMap<String,Object>();
  headers.put("CamelGoogleMail.userId",CURRENT_USERID);
  headers.put("CamelGoogleMail.id",testEmailId);
  requestBodyAndHeaders("direct://DELETE",null,headers);
  headers=new HashMap<String,Object>();
  headers.put("CamelGoogleMail.q","subject:\"Hello from camel-google-mail\"");
  listOfMessages=requestBody("direct://LIST",CURRENT_USERID);
  assertFalse(idInList(testEmailId,listOfMessages));
}
