{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Received body: " + object);
  }
  MinaExchange exchange=endpoint.createExchange(session,object);
  getProcessor().process(exchange);
  if (sync) {
    Object body;
    if (ExchangeHelper.isOutCapable(exchange)) {
      body=MinaPayloadHelper.getOut(endpoint,exchange);
    }
 else {
      body=MinaPayloadHelper.getIn(endpoint,exchange);
    }
    boolean failed=exchange.isFailed();
    if (failed) {
      LOG.warn("Can not write body since the exchange is failed, closing session: " + exchange);
      session.close();
    }
 else     if (body == null) {
      LOG.warn("Can not write body since its null, closing session: " + exchange);
      session.close();
    }
 else {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Writing body: " + body);
      }
      MinaHelper.writeBody(session,body,exchange);
    }
  }
}
