{
  if (timedTaskManager != null) {
    timedTaskManager.cancelTasks();
    timedTaskManager=null;
  }
  if (closeConnectionResource) {
    if (getConnectionResource() != null) {
      if (getConnectionResource() instanceof ConnectionFactoryResource) {
        ((ConnectionFactoryResource)getConnectionResource()).drainPool();
      }
    }
    connectionResource=null;
  }
  super.doStop();
}
