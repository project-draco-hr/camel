{
  super.doStart();
  if (configuration.isLocal()) {
    LOG.info("Starting local ElasticSearch server");
  }
 else {
    LOG.info("Joining ElasticSearch cluster " + configuration.getClusterName());
  }
  if (configuration.getIp() != null) {
    this.client=new TransportClient(getSettings()).addTransportAddress(new InetSocketTransportAddress(configuration.getIp(),configuration.getPort()));
  }
 else   if (configuration.getTransportAddresses() != null && !configuration.getTransportAddresses().isEmpty()) {
    List<TransportAddress> addresses=new ArrayList<>(configuration.getTransportAddresses().size());
    for (    TransportAddress address : configuration.getTransportAddresses()) {
      addresses.add(address);
    }
    this.client=new TransportClient(getSettings()).addTransportAddresses(addresses.toArray(new TransportAddress[0]));
  }
 else {
    node=configuration.buildNode();
    client=node.client();
  }
}
