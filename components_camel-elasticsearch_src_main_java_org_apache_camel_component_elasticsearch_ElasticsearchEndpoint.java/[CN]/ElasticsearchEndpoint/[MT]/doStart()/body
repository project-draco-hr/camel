{
  super.doStart();
  if (config.isLocal()) {
    LOG.info("Starting local ElasticSearch server");
  }
 else {
    LOG.info("Joining ElasticSearch cluster " + config.getClusterName());
  }
  node=config.buildNode();
  if (config.getIp() != null && !config.isLocal()) {
    Settings settings=ImmutableSettings.settingsBuilder().put("cluster.name",config.getClusterName()).put("node.client",true).build();
    Client client=new TransportClient(settings).addTransportAddress(new InetSocketTransportAddress(config.getIp(),config.getPort()));
    this.client=client;
  }
 else {
    client=node.client();
  }
}
