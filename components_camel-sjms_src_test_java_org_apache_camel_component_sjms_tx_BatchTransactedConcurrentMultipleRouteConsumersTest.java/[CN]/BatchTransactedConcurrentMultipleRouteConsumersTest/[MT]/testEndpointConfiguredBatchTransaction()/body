{
  getMockEndpoint("mock:test.redelivered.false.1").expectedMessageCount(TOTAL_REDELIVERED_FALSE);
  getMockEndpoint("mock:test.redelivered.false.2").expectedMessageCount(TOTAL_REDELIVERED_FALSE);
  getMockEndpoint("mock:test.redelivered.true.1").expectedMessageCount(TOTAL_REDELIVERED_TRUE);
  getMockEndpoint("mock:test.redelivered.true.2").expectedMessageCount(TOTAL_REDELIVERED_TRUE);
  getMockEndpoint("mock:test.after").expectedMessageCount(0);
  for (int i=1; i <= MESSAGE_COUNT; i++) {
    String message="Hello World " + i;
    template.sendBody("direct:start",message);
    log.trace("Sending message: {}",message);
  }
  Thread.sleep(3000);
  assertMockEndpointsSatisfied(5,TimeUnit.SECONDS);
}
