{
  for (  Bean<?> bean : routeBuilderBeans) {
    CreationalContext<?> createContext=beanManager.createCreationalContext(bean);
    Class<?> beanClass=bean.getBeanClass();
    if (bean instanceof ProducerMethod) {
      ProducerMethod producerMethod=(ProducerMethod)bean;
      beanClass=producerMethod.getType();
    }
    Object reference=beanManager.getReference(bean,beanClass,createContext);
    ObjectHelper.notNull(reference,"Could not instantiate bean of type " + beanClass.getName() + " for "+ bean);
    try {
      if (reference instanceof RoutesBuilder) {
        RoutesBuilder routeBuilder=(RoutesBuilder)reference;
        camelContext.addRoutes(routeBuilder);
      }
 else       if (reference instanceof RouteContainer) {
        RouteContainer routeContainer=(RouteContainer)reference;
        camelContext.addRouteDefinitions(routeContainer.getRoutes());
      }
 else {
        throw new IllegalArgumentException("Invalid route builder " + reference + " of type "+ beanClass.getName()+ ". Should be RoutesBuilder or RoutesContainer");
      }
    }
 catch (    Exception e) {
      throw new RuntimeCamelException("Could not add " + reference + " to CamelContext: "+ camelContext+ ". Reason: "+ e,e);
    }
  }
}
