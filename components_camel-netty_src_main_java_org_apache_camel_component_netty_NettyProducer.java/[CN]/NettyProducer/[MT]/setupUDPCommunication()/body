{
  if (datagramChannelFactory == null) {
    ExecutorService workerExecutor=context.getExecutorServiceStrategy().newThreadPool(this,"NettyUDPWorker",configuration.getCorePoolSize(),configuration.getMaxPoolSize());
    datagramChannelFactory=new NioDatagramChannelFactory(workerExecutor);
  }
  if (connectionlessClientBootstrap == null) {
    connectionlessClientBootstrap=new ConnectionlessBootstrap(datagramChannelFactory);
    connectionlessClientBootstrap.setOption("child.keepAlive",configuration.isKeepAlive());
    connectionlessClientBootstrap.setOption("child.tcpNoDelay",configuration.isTcpNoDelay());
    connectionlessClientBootstrap.setOption("child.reuseAddress",configuration.isReuseAddress());
    connectionlessClientBootstrap.setOption("child.connectTimeoutMillis",configuration.getConnectTimeoutMillis());
    connectionlessClientBootstrap.setOption("child.broadcast",configuration.isBroadcast());
    connectionlessClientBootstrap.setOption("sendBufferSize",configuration.getSendBufferSize());
    connectionlessClientBootstrap.setOption("receiveBufferSize",configuration.getReceiveBufferSize());
  }
  if (clientPipelineFactory == null) {
    clientPipelineFactory=new ClientPipelineFactory(this);
    clientPipeline=clientPipelineFactory.getPipeline();
    connectionlessClientBootstrap.setPipeline(clientPipeline);
  }
  connectionlessClientBootstrap.bind(new InetSocketAddress(0));
  channelFuture=connectionlessClientBootstrap.connect(new InetSocketAddress(configuration.getHost(),configuration.getPort()));
  channelFuture.awaitUninterruptibly();
  if (!channelFuture.isSuccess()) {
    throw new CamelException("Cannot connect to " + configuration.getAddress(),channelFuture.getCause());
  }
  channel=channelFuture.getChannel();
  allChannels.add(channel);
  LOG.info("Netty UDP Producer started and now listening on: " + configuration.getAddress());
}
