{
  if (configuration.isSync()) {
    countdownLatch=new CountDownLatch(1);
  }
  Channel channel=channelFuture.getChannel();
  NettyHelper.writeBody(channel,exchange.getIn().getBody(),exchange);
  if (configuration.isSync()) {
    boolean success=countdownLatch.await(configuration.getReceiveTimeoutMillis(),TimeUnit.MILLISECONDS);
    if (!success) {
      throw new ExchangeTimedOutException(exchange,configuration.getReceiveTimeoutMillis());
    }
    Object response=((ClientChannelHandler)clientPipeline.get("handler")).getResponse();
    exchange.getOut().setBody(response);
  }
}
