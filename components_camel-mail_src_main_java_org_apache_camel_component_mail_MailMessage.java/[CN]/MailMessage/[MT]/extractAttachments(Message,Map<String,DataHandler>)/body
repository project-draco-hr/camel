{
  Object content=message.getContent();
  if (content instanceof Multipart) {
    Multipart mp=(Multipart)content;
    for (int i=0; i < mp.getCount(); i++) {
      Part part=mp.getBodyPart(i);
      String disposition=part.getDisposition();
      if (disposition != null) {
        if (disposition.equalsIgnoreCase(Part.ATTACHMENT) || disposition.equalsIgnoreCase(Part.INLINE)) {
          if (part.getFileName() != null) {
            CollectionHelper.appendValue(map,part.getFileName(),part.getDataHandler());
          }
        }
      }
    }
  }
}
