{
  log.trace("changeCurrentDirectory({})",path);
  if (ObjectHelper.isEmpty(path)) {
    return;
  }
  String before=path;
  char separatorChar=endpoint.getFileSeparator();
  path=FileUtil.compactPath(path,separatorChar);
  if (log.isTraceEnabled()) {
    log.trace("Compacted path: {} -> {} using separator: {}",new Object[]{before,path,separatorChar});
  }
  if (!endpoint.getConfiguration().isStepwise()) {
    doChangeDirectory(path);
    return;
  }
  if (FileUtil.hasLeadingSeparator(path)) {
    doChangeDirectory(path.substring(0,1));
    path=path.substring(1);
  }
  final String[] dirs=path.split("/|\\\\");
  if (dirs == null || dirs.length == 0) {
    doChangeDirectory(path);
    return;
  }
  for (  String dir : dirs) {
    doChangeDirectory(dir);
  }
}
