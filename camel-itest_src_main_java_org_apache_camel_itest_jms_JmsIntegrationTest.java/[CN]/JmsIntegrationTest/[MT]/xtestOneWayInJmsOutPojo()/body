{
  final CountDownLatch receivedCountDown=new CountDownLatch(1);
  ConnectionFactory connectionFactory=new ActiveMQConnectionFactory("vm://localhost?broker.persistent=false");
  container.addComponent("activemq",jmsComponentClientAcknowledge(connectionFactory));
  PojoComponent component=new PojoComponent();
  component.addService("listener",new MessageListener(){
    public void onMessage(    Message msg){
      System.out.println("Received: " + msg);
      receivedCountDown.countDown();
    }
  }
);
  container.addComponent("default",component);
  container.addRoutes(new RouteBuilder(){
    public void configure(){
      from("jms:test").to("pojo:listener");
    }
  }
);
  container.start();
  JmsEndpoint endpoint=(JmsEndpoint)container.resolveEndpoint("jms:test");
  Producer<JmsExchange> producer=endpoint.createProducer();
  JmsExchange exchange=producer.createExchange();
  JmsMessage in=exchange.getIn();
  in.setBody("Hello");
  in.setHeader("cheese",123);
  producer.onExchange(exchange);
  assertTrue("The message ware received by the Pojo",receivedCountDown.await(5,TimeUnit.SECONDS));
}
