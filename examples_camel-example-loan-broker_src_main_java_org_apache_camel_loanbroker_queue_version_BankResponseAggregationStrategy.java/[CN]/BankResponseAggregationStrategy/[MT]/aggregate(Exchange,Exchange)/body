{
  LOG.debug("Get the exchange to aggregate, older: " + oldExchange + " newer:"+ newExchange);
  Integer old=(Integer)oldExchange.getProperty("aggregated");
  Double oldRate=(Double)oldExchange.getIn().getHeader(Constants.PROPERTY_RATE);
  Double newRate=(Double)newExchange.getIn().getHeader(Constants.PROPERTY_RATE);
  Exchange result=null;
  if (old == null) {
    old=1;
  }
  if (newRate >= oldRate) {
    result=oldExchange;
  }
 else {
    result=newExchange;
  }
  LOG.debug("Get the lower rate exchange " + result);
  result.setProperty("aggregated",old + 1);
  return result;
}
