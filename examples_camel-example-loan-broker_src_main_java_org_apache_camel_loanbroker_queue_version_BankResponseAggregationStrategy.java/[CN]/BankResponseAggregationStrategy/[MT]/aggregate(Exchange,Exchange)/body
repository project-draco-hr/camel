{
  LOG.debug("Get the exchange to aggregate, older: " + oldExchange + " newer:"+ newExchange);
  if (oldExchange == null) {
    return newExchange;
  }
  Message oldMessage;
  Message newMessage;
  if (aggregatingOutMessage) {
    oldMessage=oldExchange.getOut();
    newMessage=newExchange.getOut();
  }
 else {
    oldMessage=oldExchange.getIn();
    newMessage=newExchange.getIn();
  }
  Double oldRate=oldMessage.getHeader(Constants.PROPERTY_RATE,Double.class);
  Double newRate=newMessage.getHeader(Constants.PROPERTY_RATE,Double.class);
  Exchange result;
  if (newRate >= oldRate) {
    result=oldExchange;
  }
 else {
    result=newExchange;
  }
  LOG.debug("Get the lower rate exchange " + result);
  return result;
}
