{
  LOG.debug("Get the exchange to aggregate, older: " + oldExchange + " newer:"+ newExchange);
  Message oldMessage=null;
  Message newMessage=null;
  if (aggregatingOutMessage) {
    oldMessage=oldExchange.getOut(false);
    newMessage=newExchange.getOut(false);
  }
 else {
    oldMessage=oldExchange.getIn();
    newMessage=newExchange.getIn();
  }
  Double oldRate=oldMessage.getHeader(Constants.PROPERTY_RATE,Double.class);
  Double newRate=newMessage.getHeader(Constants.PROPERTY_RATE,Double.class);
  Exchange result=null;
  if (newRate >= oldRate) {
    result=oldExchange;
  }
 else {
    result=newExchange;
  }
  LOG.debug("Get the lower rate exchange " + result);
  return result;
}
