{
  LOG.debug("Get the exchange to aggregate, older: " + oldExchange + " newer:"+ newExchange);
  Integer old=oldExchange.getProperty("aggregated",Integer.class);
  Double oldRate=oldExchange.getIn().getHeader(Constants.PROPERTY_RATE,Double.class);
  Double newRate=newExchange.getIn().getHeader(Constants.PROPERTY_RATE,Double.class);
  Exchange result=null;
  if (old == null) {
    old=1;
  }
  if (newRate >= oldRate) {
    result=oldExchange;
  }
 else {
    result=newExchange;
  }
  LOG.debug("Get the lower rate exchange " + result);
  result.setProperty("aggregated",old + 1);
  return result;
}
