{
  client.createPersistent("/modes-test","parent for modes");
  for (  CreateMode mode : CreateMode.values()) {
    Exchange exchange=createExchangeWithBody(testPayload);
    exchange.getIn().setHeader(ZOOKEEPER_CREATE_MODE,mode);
    exchange.getIn().setHeader(ZOOKEEPER_NODE,"/modes-test/" + mode);
    exchange.setPattern(ExchangePattern.InOut);
    template.send("direct:node-from-header",exchange);
  }
  GetChildrenOperation listing=new GetChildrenOperation(getConnection(),"/modes-test");
  assertEquals(CreateMode.values().length,listing.get().getResult().size());
}
