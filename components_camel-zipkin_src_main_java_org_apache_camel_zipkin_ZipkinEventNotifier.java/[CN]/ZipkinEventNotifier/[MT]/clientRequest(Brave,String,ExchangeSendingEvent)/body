{
  ClientSpanThreadBinder binder=brave.clientSpanThreadBinder();
  ZipkinState state=event.getExchange().getProperty(ZipkinState.KEY,ZipkinState.class);
  if (state == null) {
    state=new ZipkinState();
    event.getExchange().setProperty(ZipkinState.KEY,state);
  }
  Object last=state.getLast();
  if (last != null && last instanceof Span) {
    binder.setCurrentSpan((Span)last);
  }
 else   if (last != null && last instanceof ServerSpan) {
    Span span=((ServerSpan)last).getSpan();
    binder.setCurrentSpan(span);
  }
  brave.brave.clientRequestInterceptor().handle(new ZipkinClientRequestAdapter(this,serviceName,event.getExchange(),event.getEndpoint()));
  Span span=binder.getCurrentClientSpan();
  state.pushClientSpan(span);
  binder.setCurrentSpan(null);
  if (log.isDebugEnabled()) {
    String traceId="<null>";
    if (span != null) {
      traceId="" + span.getTrace_id();
    }
    String spanId="<null>";
    if (span != null) {
      spanId="" + span.getId();
    }
    String parentId="<null>";
    if (span != null) {
      parentId="" + span.getParent_id();
    }
    log.debug("clientRequest [service={}, traceId={}, spanId={}, parentId={}]",serviceName,traceId,spanId,parentId);
  }
}
