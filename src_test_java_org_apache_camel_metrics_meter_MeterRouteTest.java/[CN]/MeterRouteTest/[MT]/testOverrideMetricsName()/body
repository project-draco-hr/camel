{
  MetricRegistry mockRegistry=endpoint.getCamelContext().getRegistry().lookupByNameAndType(MetricsComponent.METRIC_REGISTRY_NAME,MetricRegistry.class);
  Meter mockMeter=Mockito.mock(Meter.class);
  InOrder inOrder=Mockito.inOrder(mockRegistry,mockMeter);
  when(mockRegistry.meter("B")).thenReturn(mockMeter);
  endpoint.expectedMessageCount(1);
  producer.sendBodyAndHeader(new Object(),MetricsComponent.HEADER_METRIC_NAME,"B");
  endpoint.assertIsSatisfied();
  inOrder.verify(mockRegistry,times(1)).meter("B");
  inOrder.verify(mockMeter,times(1)).mark(3179L);
  inOrder.verifyNoMoreInteractions();
}
