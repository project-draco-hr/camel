{
  DataSetCallback dataSetCallback=new AnnotatedDataSetCallback(new Object(){
    @org.apache.camel.component.flink.annotations.DataSetCallback Long countLines(    DataSet<String> textFile,    int first,    int second){
      try {
        return textFile.count() * first * second;
      }
 catch (      Exception e) {
        return null;
      }
    }
  }
);
  long pomLinesCount=template.requestBodyAndHeader(flinkDataSetUri,Arrays.<Integer>asList(10,10),FlinkConstants.FLINK_DATASET_CALLBACK_HEADER,dataSetCallback,Long.class);
  Truth.assertThat(pomLinesCount).isEqualTo(numberOfLinesInTestFile * 10 * 10);
}
