{
  in.setErrorHandler(new BeanReaderErrorHandlerSupport(){
    @Override public void invalidRecord(    InvalidRecordException ex) throws Exception {
      String msg=LOG_PREFIX + "InvalidRecord: " + ex.getMessage()+ ": "+ ex.getRecordContext().getRecordText();
      if (ignoreInvalidRecords) {
        LOG.debug(msg);
      }
 else {
        LOG.warn(msg);
        throw ex;
      }
    }
    @Override public void unexpectedRecord(    UnexpectedRecordException ex) throws Exception {
      String msg=LOG_PREFIX + "UnexpectedRecord: " + ex.getMessage()+ ": "+ ex.getRecordContext().getRecordText();
      if (ignoreUnexpectedRecords) {
        LOG.debug(msg);
      }
 else {
        LOG.warn(msg);
        throw ex;
      }
    }
    @Override public void unidentifiedRecord(    UnidentifiedRecordException ex) throws Exception {
      String msg=LOG_PREFIX + "UnidentifiedRecord: " + ex.getMessage()+ ": "+ ex.getRecordContext().getRecordText();
      if (ignoreUnidentifiedRecords) {
        LOG.debug(msg);
      }
 else {
        LOG.warn(msg);
        throw ex;
      }
    }
  }
);
}
