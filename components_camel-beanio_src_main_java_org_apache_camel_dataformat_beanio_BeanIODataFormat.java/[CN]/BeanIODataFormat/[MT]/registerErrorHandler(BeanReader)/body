{
  in.setErrorHandler(new BeanReaderErrorHandlerSupport(){
    @Override public void invalidRecord(    InvalidRecordException ex) throws Exception {
      LOG.warn(LOG_PREFIX + ex.getMessage() + ": "+ ex.getRecordContext().getRecordText());
      if (!ignoreInvalidRecords) {
        throw ex;
      }
    }
    @Override public void unexpectedRecord(    UnexpectedRecordException ex) throws Exception {
      LOG.warn(LOG_PREFIX + ex.getMessage() + ": "+ ex.getRecordContext().getRecordText());
      if (!ignoreUnexpectedRecords) {
        throw ex;
      }
    }
    @Override public void unidentifiedRecord(    UnidentifiedRecordException ex) throws Exception {
      LOG.warn(LOG_PREFIX + ex.getMessage() + ": "+ ex.getRecordContext().getRecordText());
      if (!ignoreUnidentifiedRecords) {
        throw ex;
      }
    }
  }
);
}
