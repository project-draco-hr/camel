{
  ClientProxyFactoryBean proxyFactory=new ClientProxyFactoryBean();
  ClientFactoryBean clientBean=proxyFactory.getClientFactoryBean();
  clientBean.setAddress(ROUTER_ADDRESS);
  clientBean.setServiceClass(HelloService.class);
  clientBean.setBus(bus);
  HelloService client=(HelloService)proxyFactory.create();
  try {
    client.echo("hello world");
    fail("Except to get an exception here");
  }
 catch (  Exception e) {
    assertEquals("Except to get right exception message",e.getMessage(),EXCEPTION_MESSAGE);
    assertEquals("Except to get right exception message",EXCEPTION_MESSAGE,e.getMessage());
    assertTrue("Exception is not instance of SoapFault",e instanceof SoapFault);
    assertEquals("Except to get right detail message",DETAIL_TEXT,((SoapFault)e).getDetail().getTextContent());
    assertEquals("Except to get right fault-code",SoapFault.FAULT_CODE_CLIENT,((SoapFault)e).getFaultCode());
  }
}
