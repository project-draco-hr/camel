{
  if (routeId != null && exchange.getFromRouteId() == null) {
    exchange.setFromRouteId(routeId);
  }
  if (exchange.getUnitOfWork() == null) {
    final UnitOfWork uow=createUnitOfWork(exchange);
    exchange.setUnitOfWork(uow);
    try {
      uow.start();
    }
 catch (    Exception e) {
      callback.done(true);
      exchange.setException(e);
      return true;
    }
    if (routeContext != null) {
      processor=new RouteContextProcessor(routeContext,processor);
    }
    Object synchronous=exchange.removeProperty(Exchange.UNIT_OF_WORK_PROCESS_SYNC);
    if (synchronous != null) {
      return processSync(exchange,callback,uow);
    }
 else {
      return processAsync(exchange,callback,uow);
    }
  }
 else {
    return processor.process(exchange,callback);
  }
}
