{
  getMockEndpoint("mock:test.prebatch").expectedMessageCount(1);
  getMockEndpoint("mock:test.redelivery").expectedMessageCount(1);
  getMockEndpoint("mock:test.postbatch").expectedMessageCount(30);
  List<BatchMessage<String>> messages=new ArrayList<BatchMessage<String>>();
  for (int i=1; i <= 30; i++) {
    String body="Hello World " + i;
    BatchMessage<String> message=new BatchMessage<String>(body,null);
    messages.add(message);
  }
  template.sendBody("direct:start",messages);
  assertMockEndpointsSatisfied();
}
