{
  System.out.println("Sending to " + endpoint + " body: "+ body);
  getTemplate().send(endpoint,new Processor(){
    public void process(    Exchange exchange) throws Exception {
      Message in=exchange.getIn();
      in.setBody(body);
      if (headers != null) {
        MultivaluedMap<String,String> requestHeaders=headers.getRequestHeaders();
        System.out.println("Headers are: " + requestHeaders);
        Set<Map.Entry<String,List<String>>> entries=requestHeaders.entrySet();
        for (        Map.Entry<String,List<String>> entry : entries) {
          String key=entry.getKey();
          List<String> values=entry.getValue();
          int size=values.size();
          if (size == 1) {
            in.setHeader(key,values.get(0));
          }
 else           if (size > 0) {
            in.setHeader(key,values);
          }
        }
      }
 else {
        System.out.println("No request headers!");
      }
    }
  }
);
}
