{
  String operation=(String)exchange.getIn().getHeader(SolrConstants.OPERATION);
  if (operation == null) {
    throw new IllegalArgumentException(SolrConstants.OPERATION + " header is missing");
  }
  if (operation.equalsIgnoreCase(SolrConstants.OPERATION_INSERT)) {
    insert(exchange);
  }
 else   if (operation.equalsIgnoreCase(SolrConstants.OPERATION_DELETE_BY_ID)) {
    solrServer.deleteById(exchange.getIn().getBody(String.class));
  }
 else   if (operation.equalsIgnoreCase(SolrConstants.OPERATION_DELETE_BY_QUERY)) {
    solrServer.deleteByQuery(exchange.getIn().getBody(String.class));
  }
 else   if (operation.equalsIgnoreCase(SolrConstants.OPERATION_ADD_BEAN)) {
    solrServer.addBean(exchange.getIn().getBody());
  }
 else   if (operation.equalsIgnoreCase(SolrConstants.OPERATION_COMMIT)) {
    solrServer.commit();
  }
 else   if (operation.equalsIgnoreCase(SolrConstants.OPERATION_OPTIMIZE)) {
    solrServer.optimize();
  }
 else {
    throw new IllegalArgumentException(SolrConstants.OPERATION + " header value '" + operation+ "' is not supported");
  }
}
