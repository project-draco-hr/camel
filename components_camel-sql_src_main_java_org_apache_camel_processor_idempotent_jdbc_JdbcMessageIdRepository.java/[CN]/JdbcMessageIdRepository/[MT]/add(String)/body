{
  Boolean rc=(Boolean)transactionTemplate.execute(new TransactionCallback(){
    public Object doInTransaction(    TransactionStatus status){
      int count=jdbcTemplate.queryForInt(QUERY_STRING,processorName,messageId);
      if (count == 0) {
        jdbcTemplate.update(INSERT_STRING,processorName,messageId,new Timestamp(System.currentTimeMillis()));
        return Boolean.TRUE;
      }
 else {
        return Boolean.FALSE;
      }
    }
  }
);
  return rc.booleanValue();
}
