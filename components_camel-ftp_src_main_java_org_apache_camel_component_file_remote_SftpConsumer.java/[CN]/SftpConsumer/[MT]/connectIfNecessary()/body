{
  if (channel == null || !channel.isConnected()) {
    if (session == null || !session.isConnected()) {
      log.trace("Session isn't connected, trying to recreate and connect.");
      session=endpoint.createSession();
      session.connect();
    }
    log.trace("Channel isn't connected, trying to recreate and connect.");
    channel=endpoint.createChannelSftp(session);
    channel.connect();
    log.info("Connected to " + remoteServer());
  }
}
