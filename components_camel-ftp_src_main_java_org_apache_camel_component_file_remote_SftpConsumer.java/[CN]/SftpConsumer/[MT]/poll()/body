{
  if (LOG.isTraceEnabled()) {
    LOG.trace("Polling " + endpoint.getConfiguration());
  }
  connectIfNecessary();
  try {
    final String fileName=endpoint.getConfiguration().getFile();
    if (endpoint.getConfiguration().isDirectory()) {
      pollDirectory(fileName);
    }
 else {
      channel.cd(fileName.substring(0,fileName.lastIndexOf('/')));
      final ChannelSftp.LsEntry file=(ChannelSftp.LsEntry)channel.ls(fileName.substring(fileName.lastIndexOf('/') + 1)).get(0);
      pollFile(file);
    }
    lastPollTime=System.currentTimeMillis();
  }
 catch (  JSchException e) {
    LOG.warn("Disconnecting due to exception: " + e.getMessage());
    disconnect();
    throw e;
  }
catch (  SftpException e) {
    LOG.warn("Caught SftpException:" + e.getMessage(),e);
    LOG.warn("Hoping an explicit disconnect/reconnect will solve the problem");
    throw e;
  }
}
