{
  ProtocolCodecFactory codecFactory=getCodecFactory(type,parameters);
  if (codecFactory == null) {
    boolean textline=ObjectConverter.toBool(parameters.get("textline"));
    if (textline) {
      Charset encoding=getEncodingParameter(type,parameters);
      codecFactory=new TextLineCodecFactory(encoding);
      if (LOG.isDebugEnabled()) {
        LOG.debug(type + ": Using TextLineCodecFactory: " + codecFactory+ " using encoding: "+ encoding);
      }
    }
 else {
      codecFactory=new ObjectSerializationCodecFactory();
      if (LOG.isDebugEnabled()) {
        LOG.debug(type + ": Using ObjectSerializationCodecFactory: " + codecFactory);
      }
    }
  }
  addCodecFactory(config,codecFactory);
}
