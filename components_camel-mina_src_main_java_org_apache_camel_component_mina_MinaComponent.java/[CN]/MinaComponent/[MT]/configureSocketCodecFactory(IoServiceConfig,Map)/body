{
  ProtocolCodecFactory codecFactory=getCodecFactory(parameters);
  if (codecFactory == null) {
    boolean textline=ObjectConverter.toBool(parameters.get("textline"));
    if (textline) {
      Charset encoding=getEncodingParameter(parameters);
      codecFactory=new TextLineCodecFactory(encoding);
      LOG.debug("Using TextLineCodecFactory: " + codecFactory + " using encoding: "+ encoding);
    }
 else {
      codecFactory=new ObjectSerializationCodecFactory();
      LOG.debug("Using ObjectSerializationCodecFactory: " + codecFactory);
    }
  }
  addCodecFactory(config,codecFactory);
}
