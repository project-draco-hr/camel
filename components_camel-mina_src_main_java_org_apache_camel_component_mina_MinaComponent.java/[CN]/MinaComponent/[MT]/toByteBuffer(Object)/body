{
  ByteBuffer answer=convertTo(ByteBuffer.class,message);
  if (answer == null && message instanceof byte[]) {
    answer=MinaConverter.toByteBuffer((byte[])message);
  }
  if (answer == null) {
    String value=convertTo(String.class,message);
    answer=ByteBuffer.allocate(value.length()).setAutoExpand(true);
    if (value != null) {
      if (encoder == null) {
        encoder=Charset.defaultCharset().newEncoder();
      }
      answer.putString(value,encoder);
    }
  }
  return answer;
}
