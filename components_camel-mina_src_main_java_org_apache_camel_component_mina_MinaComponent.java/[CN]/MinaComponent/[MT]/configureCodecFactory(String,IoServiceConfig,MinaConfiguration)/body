{
  ProtocolCodecFactory codecFactory=getCodecFactory(type,configuration.getCodec());
  if (codecFactory == null) {
    if (configuration.isTextline()) {
      Charset charset=getEncodingParameter(type,configuration);
      LineDelimiter delimiter=getLineDelimiterParameter(configuration.getTextlineDelimiter());
      codecFactory=new TextLineCodecFactory(charset,delimiter);
      if (LOG.isDebugEnabled()) {
        LOG.debug(type + ": Using TextLineCodecFactory: " + codecFactory+ " using encoding: "+ charset+ " and line delimiter: "+ configuration.getTextlineDelimiter()+ "("+ delimiter+ ")");
      }
    }
 else {
      codecFactory=new ObjectSerializationCodecFactory();
      if (LOG.isDebugEnabled()) {
        LOG.debug(type + ": Using ObjectSerializationCodecFactory: " + codecFactory);
      }
    }
  }
  addCodecFactory(config,codecFactory);
}
