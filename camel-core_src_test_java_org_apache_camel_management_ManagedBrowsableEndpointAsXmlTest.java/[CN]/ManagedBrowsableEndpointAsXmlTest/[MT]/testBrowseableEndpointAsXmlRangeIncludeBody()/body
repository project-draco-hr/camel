{
  getMockEndpoint("mock:result").expectedMessageCount(3);
  template.sendBody("direct:start","Hello World");
  template.sendBodyAndHeader("direct:start","Bye World","foo",456);
  template.sendBody("direct:start","Hi Camel");
  assertMockEndpointsSatisfied();
  List<Exchange> exchanges=getMockEndpoint("mock:result").getReceivedExchanges();
  MBeanServer mbeanServer=getMBeanServer();
  ObjectName name=ObjectName.getInstance("org.apache.camel:context=localhost/camel-1,type=endpoints,name=\"mock://result\"");
  String out=(String)mbeanServer.invoke(name,"browseRangeMessagesAsXml",new Object[]{0,1,true},new String[]{"java.lang.Integer","java.lang.Integer","java.lang.Boolean"});
  assertNotNull(out);
  log.info(out);
  assertEquals("<messages>\n<message exchangeId=\"" + exchanges.get(0).getExchangeId() + "\">\n  <body type=\"java.lang.String\">Hello World</body>\n</message>\n"+ "<message exchangeId=\""+ exchanges.get(1).getExchangeId()+ "\">\n  <headers>\n    <header key=\"foo\" type=\"java.lang.Integer\">456</header>\n  </headers>\n"+ "  <body type=\"java.lang.String\">Bye World</body>\n</message>\n</messages>",out);
}
