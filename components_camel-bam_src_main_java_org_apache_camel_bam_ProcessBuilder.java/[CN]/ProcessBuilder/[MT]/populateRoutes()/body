{
  ObjectHelper.notNull(getJpaTemplate(),"jpaTemplate",this);
  ObjectHelper.notNull(getTransactionTemplate(),"transactionTemplate",this);
  if (engine == null) {
    engine=new ActivityMonitorEngine(getJpaTemplate(),getTransactionTemplate(),getProcessRules());
  }
  CamelContext camelContext=getContext();
  if (camelContext instanceof DefaultCamelContext) {
    DefaultCamelContext defaultCamelContext=(DefaultCamelContext)camelContext;
    defaultCamelContext.addService(engine);
  }
  for (  ActivityBuilder builder : activityBuilders) {
    from(builder.getEndpoint()).process(builder.getProcessor());
  }
  super.populateRoutes();
}
