{
  CSVPrinter printer=new CSVPrinter(new OutputStreamWriter(outputStream),format);
  try {
    List<?> list=exchange.getContext().getTypeConverter().tryConvertTo(List.class,exchange,object);
    if (list != null) {
      for (      Object child : list) {
        printer.printRecord(getRecordValues(exchange,child));
      }
    }
 else {
      printer.printRecord(getRecordValues(exchange,object));
    }
  }
  finally {
    IOHelper.close(printer);
  }
}
