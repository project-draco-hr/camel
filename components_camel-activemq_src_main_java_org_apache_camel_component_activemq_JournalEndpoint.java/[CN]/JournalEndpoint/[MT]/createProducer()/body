{
  return new DefaultProducer<Exchange>(this){
    public void process(    Exchange exchange) throws Exception {
      incrementReference();
      try {
        ByteSequence body=exchange.getIn().getBody(ByteSequence.class);
        if (body == null) {
          byte[] bytes=exchange.getIn().getBody(byte[].class);
          if (bytes != null) {
            body=new ByteSequence(bytes);
          }
        }
        if (body == null) {
          throw new CamelExchangeException("In body message could not be converted to a ByteSequence or a byte array.",exchange);
        }
        dataManager.write(body,syncProduce);
      }
  finally {
        decrementReference();
      }
    }
  }
;
}
