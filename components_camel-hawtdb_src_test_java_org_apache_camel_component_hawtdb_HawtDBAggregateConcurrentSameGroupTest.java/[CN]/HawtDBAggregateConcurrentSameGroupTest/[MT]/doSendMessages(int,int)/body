{
  MockEndpoint mock=getMockEndpoint("mock:aggregated");
  mock.setResultWaitTime(30 * 1000L);
  mock.expectedMessageCount(1);
  mock.message(0).body(String.class).regex("[0-9]{" + files + "}");
  ExecutorService executor=Executors.newFixedThreadPool(poolSize);
  for (int i=0; i < files; i++) {
    final int index=i;
    executor.submit(new Callable<Object>(){
      public Object call() throws Exception {
        int idx=index % 10;
        template.sendBodyAndHeader("direct:start",idx,"id",123);
        return null;
      }
    }
);
  }
  assertMockEndpointsSatisfied();
}
