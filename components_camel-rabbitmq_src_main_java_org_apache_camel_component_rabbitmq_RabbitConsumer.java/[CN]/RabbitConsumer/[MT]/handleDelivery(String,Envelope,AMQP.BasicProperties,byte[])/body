{
  try {
    if (!consumer.getEndpoint().isAutoAck()) {
      lock.acquire();
    }
    doHandleDelivery(consumerTag,envelope,properties,body);
    if (!consumer.getEndpoint().isAutoAck()) {
      lock.release();
    }
  }
 catch (  InterruptedException e) {
    log.error("Thread Interrupted!");
  }
}
