{
  if (messageName == null) {
    if (this.defaultConsumer != null) {
      throw new AvroComponentException("Default consumer already registered for uri: " + consumer.getEndpoint().getEndpointUri());
    }
    this.defaultConsumer=consumer;
  }
 else {
    if (consumerRegistry.putIfAbsent(messageName,consumer) != null) {
      throw new AvroComponentException("Consumer already registered for message: " + messageName + " and uri: "+ consumer.getEndpoint().getEndpointUri());
    }
  }
}
