{
  if (SKIP) {
    return;
  }
  for (int i=0; i < 3; ++i) {
    template.sendBody("direct:start3","CIAO" + i);
    Thread.sleep(2000);
  }
  stopCamelContext();
  for (int i=0; i < 3; ++i) {
    InputStream in=null;
    try {
      in=new URL("file:///" + BASE_FILE.toUri() + "3/"+ HdfsConstants.DEFAULT_SEGMENT_PREFIX+ i).openStream();
      ByteArrayOutputStream bos=new ByteArrayOutputStream();
      IOUtils.copyBytes(in,bos,4096,false);
      assertEquals("CIAO" + i,new String(bos.toByteArray()));
    }
  finally {
      IOUtils.closeStream(in);
    }
  }
}
