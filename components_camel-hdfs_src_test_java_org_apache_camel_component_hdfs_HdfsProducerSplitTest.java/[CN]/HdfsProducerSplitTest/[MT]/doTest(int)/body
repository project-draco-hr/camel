{
  if (!canTest()) {
    return;
  }
  for (int i=0; i < 10; ++i) {
    template.sendBody("direct:start" + routeNr,"CIAO" + i);
  }
  stopCamelContext();
  for (int i=0; i < 10; ++i) {
    InputStream in=null;
    try {
      in=new URL("file:///" + BASE_FILE.toUri() + routeNr+ '/'+ HdfsConstants.DEFAULT_SEGMENT_PREFIX+ i).openStream();
      ByteArrayOutputStream bos=new ByteArrayOutputStream();
      IOUtils.copyBytes(in,bos,4096,false);
      assertEquals("CIAO" + i,new String(bos.toByteArray()));
    }
  finally {
      IOUtils.closeStream(in);
    }
  }
}
