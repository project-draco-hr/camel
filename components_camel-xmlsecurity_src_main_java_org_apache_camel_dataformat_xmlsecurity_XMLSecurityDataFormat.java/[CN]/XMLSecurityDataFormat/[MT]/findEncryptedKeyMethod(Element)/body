{
  Node child=element.getFirstChild();
  while (child != null) {
    if (child.getNodeType() == Node.ELEMENT_NODE) {
      Element childElement=(Element)child;
      if (Constants._TAG_KEYINFO.equals(childElement.getLocalName()) && Constants.SignatureSpecNS.equals(childElement.getNamespaceURI())) {
        Node keyInfoChild=child.getFirstChild();
        while (keyInfoChild != null) {
          if (child.getNodeType() == Node.ELEMENT_NODE) {
            childElement=(Element)keyInfoChild;
            if (EncryptionConstants._TAG_ENCRYPTEDKEY.equals(childElement.getLocalName()) && EncryptionConstants.EncryptionSpecNS.equals(childElement.getNamespaceURI())) {
              return findEncryptionMethod(childElement);
            }
          }
          keyInfoChild=keyInfoChild.getNextSibling();
        }
      }
    }
    child=child.getNextSibling();
  }
  return null;
}
