{
  DESedeKeySpec keySpec;
  Key secretKey;
  try {
    if (algorithm.equalsIgnoreCase("DESede")) {
      keySpec=new DESedeKeySpec(passPhrase);
      SecretKeyFactory keyFactory=SecretKeyFactory.getInstance(algorithm);
      secretKey=keyFactory.generateSecret(keySpec);
    }
 else {
      secretKey=new SecretKeySpec(passPhrase,"AES");
    }
  }
 catch (  InvalidKeyException e) {
    throw new InvalidKeyException("InvalidKeyException due to invalid passPhrase: " + Arrays.toString(passPhrase));
  }
catch (  NoSuchAlgorithmException e) {
    throw new NoSuchAlgorithmException("NoSuchAlgorithmException while using XMLCipher.TRIPLEDES algorithm: DESede");
  }
catch (  InvalidKeySpecException e) {
    throw new InvalidKeySpecException("Invalid Key generated while using passPhrase: " + Arrays.toString(passPhrase));
  }
  return secretKey;
}
