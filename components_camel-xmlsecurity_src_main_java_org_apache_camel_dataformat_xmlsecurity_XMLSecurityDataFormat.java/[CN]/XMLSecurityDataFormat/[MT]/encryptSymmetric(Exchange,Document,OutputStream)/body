{
  Key keyEncryptionKey;
  Key dataEncryptionKey;
  if (xmlCipherAlgorithm.equals(XMLCipher.TRIPLEDES)) {
    keyEncryptionKey=generateKeyEncryptionKey("DESede");
    dataEncryptionKey=generateDataEncryptionKey();
  }
 else {
    keyEncryptionKey=generateKeyEncryptionKey("AES");
    dataEncryptionKey=generateDataEncryptionKey();
  }
  XMLCipher keyCipher=XMLCipher.getInstance(generateXmlCipherAlgorithmKeyWrap());
  keyCipher.init(XMLCipher.WRAP_MODE,keyEncryptionKey);
  encrypt(exchange,document,stream,dataEncryptionKey,keyCipher);
}
