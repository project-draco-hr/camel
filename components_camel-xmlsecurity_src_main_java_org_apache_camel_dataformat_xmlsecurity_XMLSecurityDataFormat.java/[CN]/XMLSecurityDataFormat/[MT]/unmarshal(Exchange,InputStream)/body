{
  Document encodedDocument=exchange.getContext().getTypeConverter().convertTo(Document.class,exchange,stream);
  if (null != keyCipherAlgorithm && (keyCipherAlgorithm.equals(XMLCipher.RSA_v1dot5) || keyCipherAlgorithm.equals(XMLCipher.RSA_OAEP))) {
    return decodeWithAsymmetricKey(exchange,encodedDocument);
  }
 else {
    return decodeWithSymmetricKey(exchange,encodedDocument);
  }
}
