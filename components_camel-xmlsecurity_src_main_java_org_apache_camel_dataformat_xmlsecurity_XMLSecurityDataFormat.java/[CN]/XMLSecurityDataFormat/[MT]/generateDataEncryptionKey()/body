{
  KeyGenerator keyGenerator=null;
  if (xmlCipherAlgorithm.equalsIgnoreCase(XMLCipher.TRIPLEDES)) {
    keyGenerator=KeyGenerator.getInstance("DESede");
  }
 else {
    keyGenerator=KeyGenerator.getInstance("AES");
  }
  if (xmlCipherAlgorithm.equalsIgnoreCase(XMLCipher.AES_128) || xmlCipherAlgorithm.equalsIgnoreCase(XMLCipher.AES_128_GCM)) {
    keyGenerator.init(128);
  }
 else   if (xmlCipherAlgorithm.equalsIgnoreCase(XMLCipher.AES_192) || xmlCipherAlgorithm.equalsIgnoreCase(XMLCipher.AES_192_GCM)) {
    keyGenerator.init(192);
  }
 else   if (xmlCipherAlgorithm.equalsIgnoreCase(XMLCipher.AES_256) || xmlCipherAlgorithm.equalsIgnoreCase(XMLCipher.AES_256_GCM)) {
    keyGenerator.init(256);
  }
  return keyGenerator.generateKey();
}
