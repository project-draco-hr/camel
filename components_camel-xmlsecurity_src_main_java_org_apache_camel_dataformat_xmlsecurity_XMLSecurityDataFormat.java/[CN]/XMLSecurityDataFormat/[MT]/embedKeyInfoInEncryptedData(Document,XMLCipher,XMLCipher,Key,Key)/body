{
  EncryptedKey encryptedKey=keyCipher.encryptKey(document,dataEncryptionkey,mgfAlgorithm,null);
  if (addKeyValueForEncryptedKey && keyEncryptionKey instanceof PublicKey) {
    KeyInfo keyInfo=new KeyInfo(document);
    keyInfo.add(((PublicKey)keyEncryptionKey));
    encryptedKey.setKeyInfo(keyInfo);
  }
  KeyInfo keyInfo=new KeyInfo(document);
  keyInfo.add(encryptedKey);
  EncryptedData encryptedDataElement=xmlCipher.getEncryptedData();
  encryptedDataElement.setKeyInfo(keyInfo);
}
