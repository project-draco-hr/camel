{
  File newName=renamer.renameFile(exchange,file);
  if (newName.exists()) {
    newName.delete();
  }
  newName.getParentFile().mkdirs();
  if (LOG.isDebugEnabled()) {
    LOG.debug("Renaming file: " + file + " to: "+ newName);
  }
  boolean renamed=file.renameTo(newName);
  if (!renamed) {
    throw new IOException("Can not rename file from: " + file + " to: "+ newName);
  }
  super.commit(endpoint,exchange,file);
}
