{
  if (to.exists()) {
    to.delete();
  }
  File parent=to.getParentFile();
  if (!parent.exists()) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Creating directory: " + parent);
    }
    boolean mkdir=parent.mkdirs();
    if (!mkdir) {
      throw new IOException("Cannot create directory: " + parent);
    }
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Renaming file: " + from + " to: "+ to);
  }
  boolean renamed=from.renameTo(to);
  if (!renamed) {
    throw new IOException("Cannot rename file from: " + from + " to: "+ to);
  }
  return to;
}
