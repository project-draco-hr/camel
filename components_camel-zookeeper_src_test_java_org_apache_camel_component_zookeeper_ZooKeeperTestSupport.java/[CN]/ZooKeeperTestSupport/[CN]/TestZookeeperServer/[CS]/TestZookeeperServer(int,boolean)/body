{
  zookeeperBaseDir=new File("./target/zookeeper" + count++);
  if (clearServerData) {
    cleanZookeeperDir();
  }
  zkServer=new ZooKeeperServer();
  File dataDir=new File(zookeeperBaseDir,"log");
  File snapDir=new File(zookeeperBaseDir,"data");
  FileTxnSnapLog ftxn=new FileTxnSnapLog(dataDir,snapDir);
  zkServer.setTxnLogFactory(ftxn);
  zkServer.setTickTime(1000);
  connectionFactory=new NIOServerCnxnFactory();
  connectionFactory.configure(new InetSocketAddress("localhost",clientPort),0);
  connectionFactory.startup(zkServer);
}
