{
  for (  File file : dir.listFiles()) {
    if (file.equals(exclude)) {
      continue;
    }
    if (file.isDirectory() && rec) {
      getFilesRecurse(file,pattern,exclude,rec,fileList);
    }
 else {
      Matcher m=pattern.matcher(file.getName());
      if (m.matches()) {
        fileList.add(file);
      }
    }
  }
  return fileList;
}
