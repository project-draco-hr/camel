{
  this.endpoint=endpoint;
  this.observer=observer;
  Processor processor=new Processor(){
    @Override public void process(    Exchange exchange) throws Exception {
      T value=func.call(exchange);
      observer.onNext(value);
    }
  }
;
  try {
    this.consumer=endpoint.createConsumer(processor);
    this.consumer.start();
  }
 catch (  Exception e) {
    observer.onError(e);
  }
}
