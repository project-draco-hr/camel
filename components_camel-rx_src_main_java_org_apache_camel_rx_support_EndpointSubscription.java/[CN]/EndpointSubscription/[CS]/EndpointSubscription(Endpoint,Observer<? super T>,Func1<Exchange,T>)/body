{
  this.endpoint=endpoint;
  this.observer=observer;
  Processor processor=new ProcessorToObserver<T>(func,observer);
  CamelInternalProcessor internal=new CamelInternalProcessor(processor);
  internal.addAdvice(new CamelInternalProcessor.UnitOfWorkProcessorAdvice(null));
  try {
    this.consumer=endpoint.createConsumer(internal);
    ServiceHelper.startService(consumer);
  }
 catch (  Exception e) {
    observer.onError(e);
  }
}
