{
  Object body=exchange.getOut().getBody();
  MediaType mediaType=MediaType.TEXT_PLAIN;
  if (body instanceof String) {
    mediaType=MediaType.TEXT_PLAIN;
  }
 else   if (body instanceof StringSource || body instanceof DOMSource) {
    mediaType=MediaType.TEXT_XML;
  }
  String text=exchange.getOut().getBody(String.class);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Populate Restlet response from exchange body: " + text);
  }
  response.setEntity(text,mediaType);
  exchange.getIn().setBody(body);
}
