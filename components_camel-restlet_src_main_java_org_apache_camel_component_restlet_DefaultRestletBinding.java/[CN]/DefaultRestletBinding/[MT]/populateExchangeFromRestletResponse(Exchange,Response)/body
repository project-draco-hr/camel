{
  for (  Map.Entry<String,Object> entry : response.getAttributes().entrySet()) {
    String key=entry.getKey();
    Object value=entry.getValue();
    if (!headerFilterStrategy.applyFilterToExternalHeaders(key,value,exchange)) {
      exchange.getOut().setHeader(key,value);
      LOG.debug("Populate exchange from Restlet response header: {} value: {}",key,value);
    }
  }
  int responseCode=response.getStatus().getCode();
  exchange.getOut().setHeader(Exchange.HTTP_RESPONSE_CODE,responseCode);
  exchange.getOut().setHeader(RestletConstants.RESTLET_RESPONSE,response);
  if (response.getEntity() != null) {
    MediaType mediaType=response.getEntity().getMediaType();
    if (mediaType != null) {
      exchange.getOut().setHeader(Exchange.CONTENT_TYPE,mediaType.toString());
    }
    String text=response.getEntity().getText();
    LOG.debug("Populate exchange from Restlet response: {}",text);
    exchange.getOut().setBody(text);
  }
  MessageHelper.copyHeaders(exchange.getIn(),exchange.getOut(),false);
}
