{
  Message in=exchange.getIn();
  Object actualBody=in.getBody();
  if (headerName != null) {
    actualHeader=in.getHeader(headerName);
  }
  if (propertyName != null) {
    actualProperty=exchange.getProperty(propertyName);
  }
  if (expectedBodyValues != null) {
    int index=actualBodyValues.size();
    if (expectedBodyValues.size() > index) {
      Object expectedBody=expectedBodyValues.get(index);
      if (expectedBody != null) {
        actualBody=in.getBody(expectedBody.getClass());
      }
      actualBodyValues.add(actualBody);
    }
  }
  if (LOG.isDebugEnabled()) {
    String msg=getEndpointUri() + " >>>> " + counter+ " : "+ exchange+ " with body: "+ actualBody;
    if (exchange.getIn().hasHeaders()) {
      msg+=" and headers:" + exchange.getIn().getHeaders();
    }
    LOG.debug(msg);
  }
  ++counter;
  exchange.setProperty(Exchange.RECEIVED_TIMESTAMP,new Date());
  receivedExchanges.add(exchange);
  Processor processor=processors.get(getReceivedCounter()) != null ? processors.get(getReceivedCounter()) : defaultProcessor;
  if (processor != null) {
    try {
      processor.process(exchange);
    }
 catch (    Exception e) {
      exchange.setException(e);
    }
  }
}
