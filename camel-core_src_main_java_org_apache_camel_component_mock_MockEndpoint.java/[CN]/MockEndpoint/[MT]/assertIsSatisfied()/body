{
  if (latch != null) {
    latch.await(10,TimeUnit.SECONDS);
  }
 else   if (expectedCount == 0) {
    Thread.sleep(1000);
  }
  if (expectedCount >= 0) {
    assertEquals("Expected message count",expectedCount,receivedCounter);
  }
}
