{
  if (actualValue == null) {
    return null;
  }
  if (actualValue instanceof Expression) {
    actualValue=((Expression)actualValue).evaluate(exchange,expectedValue != null ? expectedValue.getClass() : Object.class);
  }
 else   if (actualValue instanceof Predicate) {
    actualValue=((Predicate)actualValue).matches(exchange);
  }
 else   if (expectedValue != null) {
    String from=actualValue.getClass().getName();
    String to=expectedValue.getClass().getName();
    actualValue=getCamelContext().getTypeConverter().convertTo(expectedValue.getClass(),actualValue);
    assertTrue("There is no type conversion possible from " + from + " to "+ to,actualValue != null);
  }
  return actualValue;
}
