{
  Message in=copy.getIn();
  Object actualBody=in.getBody();
  if (expectedHeaderValues != null) {
    if (actualHeaderValues == null) {
      actualHeaderValues=new CaseInsensitiveMap();
    }
    if (in.hasHeaders()) {
      actualHeaderValues.putAll(in.getHeaders());
    }
  }
  if (expectedPropertyValues != null) {
    if (actualPropertyValues == null) {
      actualPropertyValues=new ConcurrentHashMap<String,Object>();
    }
    actualPropertyValues.putAll(copy.getProperties());
  }
  if (expectedBodyValues != null) {
    int index=actualBodyValues.size();
    if (expectedBodyValues.size() > index) {
      Object expectedBody=expectedBodyValues.get(index);
      if (expectedBody != null) {
        actualBody=in.getBody(expectedBody.getClass());
      }
      actualBodyValues.add(actualBody);
    }
  }
  if (LOG.isDebugEnabled()) {
    String msg=getEndpointUri() + " >>>> " + counter+ " : "+ copy+ " with body: "+ actualBody;
    if (copy.getIn().hasHeaders()) {
      msg+=" and headers:" + copy.getIn().getHeaders();
    }
    LOG.debug(msg);
  }
  ++counter;
  copy.setProperty(Exchange.RECEIVED_TIMESTAMP,new Date());
  receivedExchanges.add(copy);
  Processor processor=processors.get(getReceivedCounter()) != null ? processors.get(getReceivedCounter()) : defaultProcessor;
  if (processor != null) {
    try {
      processor.process(exchange);
    }
 catch (    Exception e) {
      exchange.setException(e);
    }
  }
}
