{
  Object key=node;
  if (node instanceof FromDefinition) {
    FromDefinition fromType=(FromDefinition)node;
    key=fromType.getUriOrRef();
  }
 else   if (node instanceof ToDefinition) {
    ToDefinition toType=(ToDefinition)node;
    key=toType.getUriOrRef();
  }
  NodeData answer=null;
  if (key != null) {
    answer=nodeMap.get(key);
  }
  if (answer == null) {
    String id="node" + (nodeMap.size() + 1);
    answer=new NodeData(id,node,imagePrefix);
    nodeMap.put(key,answer);
  }
  return answer;
}
