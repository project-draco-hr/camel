{
  KeyStore ks=KeyStore.getInstance(keyStoreFormat);
  ks.load(IOConverter.toInputStream(keyStoreFile),passphrase);
  KeyManagerFactory kmf=KeyManagerFactory.getInstance(securityProvider);
  kmf.init(ks,passphrase);
  sslContext=SSLContext.getInstance(SSL_PROTOCOL);
  if (trustStoreFile != null) {
    KeyStore ts=KeyStore.getInstance(keyStoreFormat);
    ts.load(IOConverter.toInputStream(trustStoreFile),passphrase);
    TrustManagerFactory tmf=TrustManagerFactory.getInstance(securityProvider);
    tmf.init(ts);
    sslContext.init(kmf.getKeyManagers(),tmf.getTrustManagers(),null);
  }
 else {
    sslContext.init(kmf.getKeyManagers(),null,null);
  }
}
