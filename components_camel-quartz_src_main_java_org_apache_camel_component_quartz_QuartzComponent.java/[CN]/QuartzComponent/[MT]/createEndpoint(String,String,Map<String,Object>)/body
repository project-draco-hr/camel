{
  URI u=new URI(uri);
  String path=ObjectHelper.after(u.getPath(),"/");
  String host=u.getHost();
  String cron=getAndRemoveParameter(parameters,"cron",String.class);
  Boolean fireNow=getAndRemoveParameter(parameters,"fireNow",Boolean.class,Boolean.FALSE);
  if (host == null) {
    host=ObjectHelper.before(remaining,"/");
  }
  String name;
  String group;
  if (ObjectHelper.isNotEmpty(path) && ObjectHelper.isNotEmpty(host)) {
    group=host;
    name=path;
  }
 else {
    group="Camel";
    name=host;
  }
  Map<String,Object> triggerParameters=IntrospectionSupport.extractProperties(parameters,"trigger.");
  Map<String,Object> jobParameters=IntrospectionSupport.extractProperties(parameters,"job.");
  Trigger trigger;
  boolean stateful="true".equals(parameters.get("stateful"));
  if (!isClustered() && !stateful) {
    trigger=getScheduler().getTrigger(name,group);
    if (trigger != null) {
      String msg="A Quartz job already exists with the name/group: " + name + "/"+ group;
      throw new IllegalArgumentException(msg);
    }
  }
  if (ObjectHelper.isNotEmpty(cron)) {
    trigger=createCronTrigger(cron);
  }
 else {
    trigger=new SimpleTrigger();
    if (fireNow) {
      String intervalString=(String)triggerParameters.get("repeatInterval");
      if (intervalString != null) {
        long interval=Long.valueOf(intervalString);
        trigger.setStartTime(new Date(System.currentTimeMillis() - interval));
      }
    }
  }
  QuartzEndpoint answer=new QuartzEndpoint(uri,this);
  setProperties(answer.getJobDetail(),jobParameters);
  setProperties(trigger,triggerParameters);
  trigger.setName(name);
  trigger.setGroup(group);
  answer.setTrigger(trigger);
  return answer;
}
