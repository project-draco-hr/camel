{
  if (scheduler != null) {
    int number=JOBS.get();
    if (number > 0) {
      LOG.info("Cannot shutdown Quartz scheduler: " + scheduler.getSchedulerName() + " as there are still "+ number+ " jobs registered.");
    }
    if (number == 0) {
      LOG.info("There are no more jobs registered, so shutting down Quartz scheduler: " + scheduler.getSchedulerName());
      scheduler.shutdown();
      scheduler=null;
    }
  }
  super.doStop();
}
