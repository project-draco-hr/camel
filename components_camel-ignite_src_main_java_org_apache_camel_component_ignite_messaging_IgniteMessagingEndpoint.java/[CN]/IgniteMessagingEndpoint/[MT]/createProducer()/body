{
  if (topic == null) {
    throw new IllegalStateException("Cannot initialize an Ignite Messaging Producer with a null topic.");
  }
  if (sendMode == IgniteMessagingSendMode.ORDERED && timeout == null) {
    throw new IllegalStateException("Cannot initialize an Ignite Messaging Producer in ORDERED send mode without a timeout.");
  }
  IgniteMessaging messaging=createIgniteMessaging();
  return new IgniteMessagingProducer(this,igniteComponent().getIgnite(),messaging);
}
