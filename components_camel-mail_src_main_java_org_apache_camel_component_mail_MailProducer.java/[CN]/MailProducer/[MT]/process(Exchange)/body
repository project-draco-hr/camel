{
  MimeMessage mimeMessage=new MimeMessage(sender.getSession());
  try {
    getEndpoint().getBinding().populateMailMessage(getEndpoint(),mimeMessage,exchange);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Sending MimeMessage: {}",MailUtils.dumpMessage(mimeMessage));
    }
    sender.send(mimeMessage);
    exchange.getIn().setHeader(MailConstants.MAIL_MESSAGE_ID,mimeMessage.getMessageID());
  }
 catch (  MessagingException e) {
    exchange.setException(e);
  }
catch (  IOException e) {
    exchange.setException(e);
  }
}
