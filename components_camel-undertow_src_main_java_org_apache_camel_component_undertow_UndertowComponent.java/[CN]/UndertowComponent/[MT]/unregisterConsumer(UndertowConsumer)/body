{
  int port=consumer.getEndpoint().getHttpURI().getPort();
  if (serversRegistry.containsKey(port)) {
    UndertowRegistry undertowRegistry=serversRegistry.get(port);
    undertowRegistry.unregisterConsumer(consumer);
    if (undertowRegistry.isEmpty()) {
      Undertow server=undertowRegistry.getServer();
      if (server != null) {
        server.stop();
      }
      serversRegistry.remove(port);
    }
 else {
      startServer(consumer);
    }
  }
}
