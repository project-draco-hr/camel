{
  int port=consumer.getEndpoint().getHttpURI().getPort();
  if (serversRegistry.containsKey(port)) {
    serversRegistry.get(port).unregisterConsumer(consumer);
  }
  if (serversRegistry.get(port).isEmpty()) {
    Undertow server=serversRegistry.get(port).getServer();
    if (server != null) {
      server.stop();
    }
    serversRegistry.remove(port);
  }
 else {
    startServer(consumer);
  }
}
