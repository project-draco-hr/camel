{
  final Endpoint endpoint=exchange.get(Endpoint.class);
  Message outMessage=null;
  if (result.isFailed()) {
    CxfMessage fault=result.getFault();
    outMessage=exchange.getInFaultMessage();
    if (outMessage == null) {
      outMessage=endpoint.getBinding().createMessage();
      outMessage.setExchange(exchange);
      exchange.setInFaultMessage(outMessage);
    }
    Exception ex=(Exception)fault.getBody();
    outMessage.setContent(Exception.class,ex);
  }
 else {
    outMessage=result.getOutMessage();
    if (LOG.isLoggable(Level.FINEST)) {
      LOG.finest("Get the response outMessage " + outMessage);
    }
    if (outMessage == null) {
      outMessage=endpoint.getBinding().createMessage();
    }
  }
  exchange.setOutMessage(outMessage);
}
