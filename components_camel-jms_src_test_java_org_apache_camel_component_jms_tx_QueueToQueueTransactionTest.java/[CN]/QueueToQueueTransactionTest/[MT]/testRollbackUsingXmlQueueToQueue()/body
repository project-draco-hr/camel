{
  context.addRoutes(new SpringRouteBuilder(){
    @Override public void configure() throws Exception {
      Policy required=bean(SpringTransactionPolicy.class,"PROPAGATION_REQUIRED_POLICY");
      from("activemq:queue:foo?transacted=true").policy(required).process(new ConditionalExceptionProcessor()).to("activemq:queue:bar?transacted=true");
    }
  }
);
  assertResult();
}
