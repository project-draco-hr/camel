{
  if (websocket != null && message != null) {
    executor.execute(new Runnable(){
      @Override public void run(){
        try {
          if (message instanceof String) {
            websocket.write((String)message);
          }
 else           if (message instanceof byte[]) {
            websocket.write((byte[])message,0,((byte[])message).length);
          }
 else {
            LOG.warn("unexpected message type {}",message.getClass());
          }
        }
 catch (        Exception e) {
          LOG.error("Error when writing to websocket",e);
        }
      }
    }
);
  }
}
