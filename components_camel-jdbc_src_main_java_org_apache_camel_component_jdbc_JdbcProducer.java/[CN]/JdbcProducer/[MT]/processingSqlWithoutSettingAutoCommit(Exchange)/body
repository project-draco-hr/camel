{
  String sql=exchange.getIn().getBody(String.class);
  Connection conn=null;
  Statement stmt=null;
  ResultSet rs=null;
  try {
    conn=dataSource.getConnection();
    stmt=conn.createStatement();
    if (parameters != null && !parameters.isEmpty()) {
      IntrospectionSupport.setProperties(stmt,parameters);
    }
    LOG.debug("Executing JDBC statement: {}",sql);
    if (stmt.execute(sql)) {
      rs=stmt.getResultSet();
      setResultSet(exchange,rs);
    }
 else {
      int updateCount=stmt.getUpdateCount();
      exchange.getOut().setHeader(JdbcConstants.JDBC_UPDATE_COUNT,updateCount);
    }
  }
  finally {
    closeQuietly(rs);
    closeQuietly(stmt);
    closeQuietly(conn);
  }
}
