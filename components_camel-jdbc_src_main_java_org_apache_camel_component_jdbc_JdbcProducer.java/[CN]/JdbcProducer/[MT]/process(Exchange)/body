{
  String sql=exchange.getIn().getBody(String.class);
  Connection conn=null;
  Statement stmt=null;
  try {
    conn=source.getConnection();
    stmt=conn.createStatement();
    if (stmt.execute(sql)) {
      ResultSet rs=stmt.getResultSet();
      setResultSet(exchange,rs);
      rs.close();
    }
 else {
      int updateCount=stmt.getUpdateCount();
      exchange.getOut().setHeader("jdbc.updateCount",updateCount);
    }
  }
  finally {
    if (stmt != null) {
      stmt.close();
    }
    if (conn != null) {
      conn.close();
    }
  }
}
