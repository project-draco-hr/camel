{
  String sql=exchange.getIn().getBody(String.class);
  Connection conn=null;
  Statement stmt=null;
  ResultSet rs=null;
  try {
    conn=dataSource.getConnection();
    stmt=conn.createStatement();
    if (parameters != null && !parameters.isEmpty()) {
      IntrospectionSupport.setProperties(stmt,parameters);
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("Executing JDBC statement: " + sql);
    }
    exchange.getOut().setHeaders(exchange.getIn().getHeaders());
    if (stmt.execute(sql)) {
      rs=stmt.getResultSet();
      setResultSet(exchange,rs);
    }
 else {
      int updateCount=stmt.getUpdateCount();
      exchange.getOut().setHeader(JdbcConstants.JDBC_UPDATE_COUNT,updateCount);
    }
  }
  finally {
    try {
      if (rs != null) {
        rs.close();
      }
      if (stmt != null) {
        stmt.close();
      }
      if (conn != null) {
        conn.close();
      }
    }
 catch (    SQLException e) {
      LOG.warn("Error closing JDBC resource: " + e,e);
    }
  }
}
