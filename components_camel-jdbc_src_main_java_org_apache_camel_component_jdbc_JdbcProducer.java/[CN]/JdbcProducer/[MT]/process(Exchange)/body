{
  String sql=exchange.getIn().getBody(String.class);
  Connection conn=null;
  Statement stmt=null;
  ResultSet rs=null;
  try {
    conn=source.getConnection();
    stmt=conn.createStatement();
    if (stmt.execute(sql)) {
      rs=stmt.getResultSet();
      setResultSet(exchange,rs);
    }
 else {
      int updateCount=stmt.getUpdateCount();
      exchange.getOut().setHeader("jdbc.updateCount",updateCount);
    }
  }
  finally {
    try {
      if (rs != null) {
        rs.close();
      }
      if (stmt != null) {
        stmt.close();
      }
      if (conn != null) {
        conn.close();
      }
    }
 catch (    SQLException e) {
      LOG.warn("Error closing JDBC resource: " + e,e);
    }
  }
}
