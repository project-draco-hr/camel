{
  String sql=exchange.getIn().getBody(String.class);
  Connection conn=null;
  Boolean autoCommit=null;
  try {
    conn=dataSource.getConnection();
    autoCommit=conn.getAutoCommit();
    if (autoCommit) {
      conn.setAutoCommit(false);
    }
    createAndExecuteSqlStatement(exchange,sql,conn);
    conn.commit();
  }
 catch (  Exception e) {
    try {
      if (conn != null) {
        conn.rollback();
      }
    }
 catch (    SQLException sqle) {
      LOG.warn("Error occurred during jdbc rollback. This exception will be ignored.",sqle);
    }
    throw e;
  }
 finally {
    resetAutoCommit(conn,autoCommit);
    closeQuietly(conn);
  }
}
