{
  boolean answer=true;
  ResultSetIterator iterator=new ResultSetIterator(conn,rs,getEndpoint().isUseJDBC4ColumnNameAndLabelSemantics(),getEndpoint().isUseGetBytesForBlob());
  exchange.getOut().getHeaders().putAll(exchange.getIn().getHeaders());
  JdbcOutputType outputType=getEndpoint().getOutputType();
  exchange.getOut().setHeader(JdbcConstants.JDBC_COLUMN_NAMES,iterator.getColumnNames());
  if (outputType == JdbcOutputType.StreamList) {
    exchange.getOut().setBody(iterator);
    exchange.addOnCompletion(new ResultSetIteratorCompletion(iterator));
    answer=false;
  }
 else   if (outputType == JdbcOutputType.SelectList) {
    List<?> list=extractRows(iterator);
    exchange.getOut().setHeader(JdbcConstants.JDBC_ROW_COUNT,list.size());
    exchange.getOut().setBody(list);
  }
 else   if (outputType == JdbcOutputType.SelectOne) {
    exchange.getOut().setBody(extractSingleRow(iterator));
  }
  return answer;
}
