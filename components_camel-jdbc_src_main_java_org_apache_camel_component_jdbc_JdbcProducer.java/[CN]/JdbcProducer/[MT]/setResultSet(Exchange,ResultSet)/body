{
  ResultSetMetaData meta=rs.getMetaData();
  int count=meta.getColumnCount();
  List<Map<String,Object>> data=new ArrayList<Map<String,Object>>();
  int rowNumber=0;
  while (rs.next() && (readSize == 0 || rowNumber < readSize)) {
    Map<String,Object> row=new HashMap<String,Object>();
    for (int i=0; i < count; i++) {
      int columnNumber=i + 1;
      String columnName=meta.getColumnName(columnNumber);
      row.put(columnName,rs.getObject(columnName));
    }
    data.add(row);
    rowNumber++;
  }
  exchange.getOut().setHeader(JdbcConstants.JDBC_ROW_COUNT,rowNumber);
  exchange.getOut().setBody(data);
}
