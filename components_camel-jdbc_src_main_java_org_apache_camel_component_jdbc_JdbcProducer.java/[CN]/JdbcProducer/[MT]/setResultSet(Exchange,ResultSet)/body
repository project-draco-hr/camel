{
  ResultSetIterator iterator=new ResultSetIterator(rs,getEndpoint().isUseJDBC4ColumnNameAndLabelSemantics());
  exchange.getOut().getHeaders().putAll(exchange.getIn().getHeaders());
  JdbcOutputType outputType=getEndpoint().getOutputType();
  exchange.getOut().setHeader(JdbcConstants.JDBC_COLUMN_NAMES,iterator.getColumnNames());
  if (outputType == JdbcOutputType.StreamList) {
    exchange.getOut().setBody(iterator);
    exchange.addOnCompletion(new ResultSetIteratorCompletion(iterator));
  }
 else   if (outputType == JdbcOutputType.SelectList) {
    List<?> list=extractRows(iterator);
    exchange.getOut().setHeader(JdbcConstants.JDBC_ROW_COUNT,list.size());
    exchange.getOut().setBody(list);
  }
 else   if (outputType == JdbcOutputType.SelectOne) {
    exchange.getOut().setBody(extractSingleRow(iterator));
  }
}
