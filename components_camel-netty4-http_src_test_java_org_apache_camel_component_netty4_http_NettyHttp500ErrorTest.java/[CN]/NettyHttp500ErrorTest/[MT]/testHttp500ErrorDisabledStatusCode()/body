{
  getMockEndpoint("mock:input").expectedBodiesReceived("Hello World");
  Exchange out=template.request("netty4-http:http://localhost:{{port}}/foo?throwExceptionOnFailure=false",new Processor(){
    @Override public void process(    Exchange exchange) throws Exception {
      exchange.getIn().setBody("Hello World");
    }
  }
);
  assertNotNull(out);
  assertEquals(500,out.getOut().getHeader(Exchange.HTTP_RESPONSE_CODE));
  assertEquals("Internal Server Error",out.getOut().getHeader(Exchange.HTTP_RESPONSE_TEXT));
  assertMockEndpointsSatisfied();
}
