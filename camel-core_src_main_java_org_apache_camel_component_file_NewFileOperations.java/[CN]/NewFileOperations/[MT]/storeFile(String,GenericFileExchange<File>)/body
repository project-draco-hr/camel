{
  ObjectHelper.notNull(endpoint,"endpoint");
  File file=new File(name);
  try {
    boolean fileSource=exchange.getIn().getBody() instanceof File;
    if (fileSource) {
      File source=ExchangeHelper.getMandatoryInBody(exchange,File.class);
      writeFileByFile(source,file);
    }
 else {
      InputStream in=ExchangeHelper.getMandatoryInBody(exchange,InputStream.class);
      writeFileByStream(in,file);
    }
  }
 catch (  IOException e) {
    throw new GenericFileOperationFailedException("Can not store file: " + file,e);
  }
catch (  InvalidPayloadException e) {
    throw new GenericFileOperationFailedException("Can not store file: " + file,e);
  }
  return true;
}
