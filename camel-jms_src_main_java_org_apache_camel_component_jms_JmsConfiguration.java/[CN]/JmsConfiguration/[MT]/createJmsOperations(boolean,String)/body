{
  JmsTemplate template=useVersion102 ? new JmsTemplate102(getProducerConnectionFactory(),pubSubDomain) : new JmsTemplate(getProducerConnectionFactory());
  template.setPubSubDomain(pubSubDomain);
  template.setDefaultDestinationName(destination);
  template.setExplicitQosEnabled(explicitQosEnabled);
  template.setDeliveryPersistent(deliveryPersistent);
  if (messageConverter != null) {
    template.setMessageConverter(messageConverter);
  }
  template.setMessageIdEnabled(messageIdEnabled);
  template.setMessageTimestampEnabled(messageTimestampEnabled);
  if (priority >= 0) {
    template.setPriority(priority);
  }
  template.setPubSubNoLocal(pubSubNoLocal);
  if (receiveTimeout >= 0) {
    template.setReceiveTimeout(receiveTimeout);
  }
  if (timeToLive >= 0) {
    template.setTimeToLive(timeToLive);
  }
  boolean transacted=TRANSACTED.equals(producerAcknowledgementMode);
  template.setSessionTransacted(transacted);
  if (!transacted) {
    template.setSessionAcknowledgeModeName(producerAcknowledgementMode);
  }
  return template;
}
