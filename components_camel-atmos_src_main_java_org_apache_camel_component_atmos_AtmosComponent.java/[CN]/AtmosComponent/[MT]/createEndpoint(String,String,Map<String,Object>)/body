{
  AtmosConfiguration configuration=new AtmosConfiguration();
  configuration.setUri((String)parameters.get("uri") == null ? AtmosPropertyManager.getInstance().getProperty("uri") : (String)parameters.get("uri"));
  configuration.setSecretKey((String)parameters.get("secretKey") == null ? AtmosPropertyManager.getInstance().getProperty("secretKey") : (String)parameters.get("secretKey"));
  configuration.setLocalPath((String)parameters.get("localPath"));
  configuration.setRemotePath((String)parameters.get("remotePath"));
  configuration.setNewRemotePath((String)parameters.get("newRemotePath"));
  configuration.setQuery((String)parameters.get("query"));
  configuration.setOperation(AtmosOperation.valueOf(remaining));
  configuration.setFullTokenId(parameters.get("fullTokenId") == null ? AtmosPropertyManager.getInstance().getProperty("fullTokenId") : (String)parameters.get("fullTokenId"));
  configuration.setEnableSslValidation(Boolean.parseBoolean((String)AtmosPropertyManager.getInstance().getProperty("sslValidation")));
  AtmosConfigurationValidator.validate(configuration);
  setProperties(configuration,parameters);
  LOG.info("atmos configuration set!");
  Endpoint endpoint=new AtmosEndpoint(uri,this,configuration);
  return endpoint;
}
