{
  Class<?> clazz=unmarshalType;
  String type=exchange.getIn().getHeader(JackconConstants.UNMARSHAL_TYPE,String.class);
  if (type == null && isAllowJmsType()) {
    type=exchange.getIn().getHeader("JMSType",String.class);
  }
  if (type != null) {
    clazz=exchange.getContext().getClassResolver().resolveMandatoryClass(type);
  }
  return this.objectMapper.readValue(stream,clazz);
}
