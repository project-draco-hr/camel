{
  getMockEndpoint("mock:handled").expectedMessageCount(1);
  getMockEndpoint("mock:dead").expectedMessageCount(0);
  getMockEndpoint("mock:result").expectedMessageCount(0);
  template.sendBody("direct:start","Hello World");
  assertMockEndpointsSatisfied();
  OnRedeliveryCounter counter=context.getRegistry().lookupByNameAndType("counter",OnRedeliveryCounter.class);
  assertEquals(3,counter.getCounter());
}
