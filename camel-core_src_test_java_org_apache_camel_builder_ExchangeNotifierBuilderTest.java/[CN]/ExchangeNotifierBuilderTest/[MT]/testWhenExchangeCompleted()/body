{
  ExchangeNotifierBuilder builder=new ExchangeNotifierBuilder(context).whenCompleted(5).create();
  assertEquals(false,builder.matches());
  template.sendBody("direct:foo","A");
  template.sendBody("direct:foo","B");
  template.sendBody("direct:bar","C");
  try {
    template.sendBody("direct:fail","D");
  }
 catch (  Exception e) {
  }
  try {
    template.sendBody("direct:fail","E");
  }
 catch (  Exception e) {
  }
  assertEquals(false,builder.matches());
  template.sendBody("direct:bar","F");
  template.sendBody("direct:foo","G");
  template.sendBody("direct:bar","H");
  assertEquals(true,builder.matches());
}
