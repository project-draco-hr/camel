{
  prepareExchangeForRedelivery(exchange);
  deliverToOnRedeliveryProcessor(exchange,data);
  log.trace("Redelivering exchangeId: {} -> {} for Exchange: {}",new Object[]{exchange.getExchangeId(),outputAsync,exchange});
  EventHelper.notifyExchangeRedelivery(exchange.getContext(),exchange,data.redeliveryCounter);
  boolean sync;
  if (data.redeliverFromSync) {
    sync=AsyncProcessorHelper.process(outputAsync,exchange,new AsyncCallback(){
      public void done(      boolean doneSync){
        log.trace("Redelivering exchangeId: {} done sync: {}",exchange.getExchangeId(),doneSync);
        data.sync=false;
        if (isDone(exchange)) {
          callback.done(false);
          return;
        }
        processAsyncErrorHandler(exchange,callback,data);
      }
    }
);
  }
 else {
    sync=AsyncProcessorHelper.process(outputAsync,exchange,new AsyncCallback(){
      public void done(      boolean doneSync){
        log.trace("Redelivering exchangeId: {} done sync: {}",exchange.getExchangeId(),doneSync);
        if (doneSync) {
          return;
        }
        data.sync=false;
        if (isDone(exchange)) {
          callback.done(doneSync);
          return;
        }
        processAsyncErrorHandler(exchange,callback,data);
      }
    }
);
  }
  return sync;
}
