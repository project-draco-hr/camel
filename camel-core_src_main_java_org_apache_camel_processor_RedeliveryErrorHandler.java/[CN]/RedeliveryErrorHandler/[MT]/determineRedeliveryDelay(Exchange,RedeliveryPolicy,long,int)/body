{
  Message message=exchange.getIn();
  Long delay=message.getHeader(Exchange.REDELIVERY_DELAY,Long.class);
  if (delay == null) {
    delay=redeliveryPolicy.calculateRedeliveryDelay(redeliveryDelay,redeliveryCounter);
    log.debug("Redelivery delay calculated as {}",delay);
  }
 else {
    log.debug("Redelivery delay is {} from Message Header [{}]",delay,Exchange.REDELIVERY_DELAY);
  }
  return delay;
}
