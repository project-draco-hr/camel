{
  if (logger == null) {
    return;
  }
  LoggingLevel newLogLevel;
  if (shouldRedeliver) {
    newLogLevel=data.currentRedeliveryPolicy.getRetryAttemptedLogLevel();
  }
 else {
    newLogLevel=data.currentRedeliveryPolicy.getRetriesExhaustedLogLevel();
  }
  if (exchange.isRollbackOnly()) {
    String msg="Rollback exchange";
    if (exchange.getException() != null) {
      msg=msg + " due: " + exchange.getException().getMessage();
    }
    if (newLogLevel == LoggingLevel.ERROR || newLogLevel == LoggingLevel.FATAL) {
      logger.log(msg,LoggingLevel.WARN);
    }
 else {
      logger.log(msg,newLogLevel);
    }
  }
 else   if (data.currentRedeliveryPolicy.isLogStackTrace() && e != null) {
    logger.log(message,e,newLogLevel);
  }
 else {
    logger.log(message,newLogLevel);
  }
}
