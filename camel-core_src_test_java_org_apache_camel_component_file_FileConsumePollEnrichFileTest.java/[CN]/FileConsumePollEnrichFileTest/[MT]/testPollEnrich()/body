{
  getMockEndpoint("mock:start").expectedBodiesReceived("Start");
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedBodiesReceived("Big file");
  template.sendBodyAndHeader("file://target/enrich","Start",Exchange.FILE_NAME,"AAA.fin");
  log.info("Sleeping for 2 sec before writing enrichdata file");
  Thread.sleep(2000);
  template.sendBodyAndHeader("file://target/enrichdata","Big file",Exchange.FILE_NAME,"AAA.dat");
  log.info("... write done");
  mock.assertIsSatisfied();
  Thread.sleep(200);
  assertFileExists("target/enrich/.done/AAA.fin");
  assertFileExists("target/enrichdata/.done/AAA.dat");
}
