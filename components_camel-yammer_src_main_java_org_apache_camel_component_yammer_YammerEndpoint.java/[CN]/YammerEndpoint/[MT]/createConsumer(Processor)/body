{
switch (YammerFunctionType.fromUri(config.getFunction())) {
case MESSAGES:
case ALGO:
case FOLLOWING:
case MY_FEED:
case PRIVATE:
case SENT:
    return new YammerMessagePollingConsumer(this,processor);
case USERS:
case CURRENT:
  return new YammerUserPollingConsumer(this,processor);
default :
throw new Exception(String.format("%s is not a valid Yammer function type.",config.getFunction()));
}
}
