{
  if (type == null) {
    notNull(ref,"ref or dataFormatType");
    DataFormat dataFormat=routeContext.lookup(ref,DataFormat.class);
    if (dataFormat == null) {
      dataFormat=routeContext.getDataFormat(ref);
    }
    if (dataFormat instanceof DataFormatType) {
      type=(DataFormatType)dataFormat;
    }
 else {
      return dataFormat;
    }
  }
  return type.getDataFormat(routeContext);
}
