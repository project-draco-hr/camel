{
  Assert.notNull(messageCreator,"MessageCreator must not be null");
  MessageProducer producer=createProducer(session,destination);
  Message message=null;
  try {
    message=messageCreator.createMessage(session);
    if (logger.isDebugEnabled()) {
      logger.debug("Sending JMS message to: " + producer.getDestination() + " with message: "+ message);
    }
    doSend(producer,message);
    if (message != null && callback != null) {
      callback.sent(message,destination);
    }
    if (session.getTransacted() && isSessionLocallyTransacted(session)) {
      JmsUtils.commitIfNecessary(session);
    }
  }
  finally {
    JmsUtils.closeMessageProducer(producer);
  }
  return null;
}
