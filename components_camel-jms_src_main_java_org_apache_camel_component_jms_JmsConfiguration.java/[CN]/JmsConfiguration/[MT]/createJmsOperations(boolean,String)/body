{
  ConnectionFactory factory=getTemplateConnectionFactory();
  JmsTemplate template=useVersion102 ? new JmsTemplate102(factory,pubSubDomain) : new JmsTemplate(factory);
  template.setPubSubDomain(pubSubDomain);
  template.setDefaultDestinationName(destination);
  template.setExplicitQosEnabled(explicitQosEnabled);
  template.setDeliveryPersistent(deliveryPersistent);
  if (messageConverter != null) {
    template.setMessageConverter(messageConverter);
  }
  template.setMessageIdEnabled(messageIdEnabled);
  template.setMessageTimestampEnabled(messageTimestampEnabled);
  if (priority >= 0) {
    template.setPriority(priority);
  }
  template.setPubSubNoLocal(pubSubNoLocal);
  if (receiveTimeout >= 0) {
    template.setReceiveTimeout(receiveTimeout);
  }
  if (timeToLive >= 0) {
    template.setTimeToLive(timeToLive);
  }
  template.setSessionTransacted(transacted);
  if (acknowledgementMode >= 0) {
    template.setSessionAcknowledgeMode(acknowledgementMode);
  }
 else   if (acknowledgementModeName != null) {
    template.setSessionAcknowledgeModeName(acknowledgementModeName);
  }
  return template;
}
