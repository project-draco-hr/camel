{
  step="";
  MockEndpoint gold=getMockEndpoint("mock:gold");
  gold.expectedMessageCount(1);
  gold.whenAnyExchangeReceived(new Processor(){
    public void process(    Exchange exchange) throws Exception {
      step+="C";
    }
  }
);
  template.sendBody("direct:start","Hello World");
  step+="D";
  assertMockEndpointsSatisfied();
  Future<String> future=(Future<String>)gold.getReceivedExchanges().get(0).getIn().getBody();
  assertEquals("Bye World",future.get());
  assertTrue("Should be either ACDB or ADCB was " + step,step.equals("ACDB") || step.equals("ADCB"));
}
