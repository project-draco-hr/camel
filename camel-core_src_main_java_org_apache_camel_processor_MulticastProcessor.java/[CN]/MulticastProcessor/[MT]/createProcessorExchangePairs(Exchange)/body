{
  List<ProcessorExchangePair> result=new ArrayList<ProcessorExchangePair>(processors.size());
  int index=0;
  for (  Processor processor : processors) {
    Exchange copy=ExchangeHelper.createCorrelatedCopy(exchange,false);
    if (copy.getProperty(Exchange.STREAM_CACHE_UNIT_OF_WORK) == null) {
      copy.setProperty(Exchange.STREAM_CACHE_UNIT_OF_WORK,exchange.getUnitOfWork());
    }
    if (isShareUnitOfWork()) {
      prepareSharedUnitOfWork(copy,exchange);
    }
    RouteContext routeContext=exchange.getUnitOfWork() != null ? exchange.getUnitOfWork().getRouteContext() : null;
    result.add(createProcessorExchangePair(index++,processor,copy,routeContext));
  }
  if (exchange.getException() != null) {
    throw exchange.getException();
  }
  return result;
}
