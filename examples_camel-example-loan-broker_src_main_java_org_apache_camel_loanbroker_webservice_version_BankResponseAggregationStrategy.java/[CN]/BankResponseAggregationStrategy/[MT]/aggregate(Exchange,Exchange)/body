{
  BankQuote oldQuote=oldExchange.getProperty(BANK_QUOTE,BankQuote.class);
  if (oldQuote == null) {
    Object[] oldResult=(Object[])oldExchange.getOut().getBody();
    oldQuote=(BankQuote)oldResult[0];
  }
  Object[] newResult=(Object[])newExchange.getOut().getBody();
  BankQuote newQuote=(BankQuote)newResult[0];
  Exchange result=null;
  BankQuote bankQuote;
  if (newQuote.getRate() >= oldQuote.getRate()) {
    result=oldExchange;
    bankQuote=oldQuote;
  }
 else {
    result=newExchange;
    bankQuote=newQuote;
  }
  result.setProperty(BANK_QUOTE,bankQuote);
  result.getOut().setBody("The best rate is " + bankQuote.toString());
  return result;
}
