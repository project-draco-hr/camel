{
  if (oldExchange == null) {
    return newExchange;
  }
  BankQuote oldQuote=oldExchange.getProperty(BANK_QUOTE,BankQuote.class);
  if (oldQuote == null) {
    oldQuote=oldExchange.getIn().getBody(BankQuote.class);
  }
  BankQuote newQuote=newExchange.getIn().getBody(BankQuote.class);
  Exchange result=null;
  BankQuote bankQuote;
  if (newQuote.getRate() >= oldQuote.getRate()) {
    result=oldExchange;
    bankQuote=oldQuote;
  }
 else {
    result=newExchange;
    bankQuote=newQuote;
  }
  result.setProperty(BANK_QUOTE,bankQuote);
  result.getOut().setBody("The best rate is " + bankQuote.toString());
  return result;
}
