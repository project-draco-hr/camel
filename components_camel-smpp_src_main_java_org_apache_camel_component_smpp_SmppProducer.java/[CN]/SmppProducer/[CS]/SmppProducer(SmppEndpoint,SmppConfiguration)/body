{
  super(endpoint);
  this.configuration=config;
  this.sessionStateListener=new SessionStateListener(){
    public void onStateChange(    SessionState newState,    SessionState oldState,    Object source){
      if (newState.equals(SessionState.CLOSED)) {
        LOG.warn("Lost connection to: " + getEndpoint().getConnectionString() + " - trying to reconnect...");
        closeSession();
        reconnect(configuration.getInitialReconnectDelay());
      }
    }
  }
;
}
