{
  if (session == null) {
    if (getConfiguration().isLazySessionCreation()) {
      if (connectLock.tryLock()) {
        try {
          if (session == null) {
            session=createSession();
          }
        }
  finally {
          connectLock.unlock();
        }
      }
    }
  }
  if (this.session == null) {
    throw new IOException("Lost connection to " + getEndpoint().getConnectionString() + " and yet not reconnected");
  }
  SmppCommand command=getEndpoint().getBinding().createSmppCommand(session,exchange);
  command.execute(exchange);
}
