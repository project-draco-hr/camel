{
  resetMocks();
  MockEndpoint mockEndpoint=getMockEndpoint("mock:result");
  mockEndpoint.expectedMessageCount(files);
  mockEndpoint.expectsNoDuplicates(body());
  for (int i=0; i < files; i++) {
    final int index=i;
    executorService.submit(new Callable<Object>(){
      public Object call() throws Exception {
        template.sendBody("direct:start","Message " + index);
        return null;
      }
    }
);
  }
  assertMockEndpointsSatisfied(20,TimeUnit.SECONDS);
}
