{
  if (channelPipeline != null) {
    if (channelPipeline.remove("ssl") != null) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Client SSL handler re-initialized on the ChannelPipeline");
      }
      channelPipeline.addFirst("ssl",configureClientSSLOnDemand());
    }
    return channelPipeline;
  }
  channelPipeline=Channels.pipeline();
  SslHandler sslHandler=configureClientSSLOnDemand();
  if (sslHandler != null) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Client SSL handler configured and added to the ChannelPipeline");
    }
    channelPipeline.addLast("ssl",sslHandler);
  }
  List<ChannelUpstreamHandler> decoders=producer.getConfiguration().getDecoders();
  for (int x=0; x < decoders.size(); x++) {
    channelPipeline.addLast("decoder-" + x,decoders.get(x));
  }
  List<ChannelDownstreamHandler> encoders=producer.getConfiguration().getEncoders();
  for (int x=0; x < encoders.size(); x++) {
    channelPipeline.addLast("encoder-" + x,encoders.get(x));
  }
  if (producer.getConfiguration().getHandler() != null) {
    channelPipeline.addLast("handler",producer.getConfiguration().getHandler());
  }
 else {
    channelPipeline.addLast("handler",new ClientChannelHandler(producer));
  }
  return channelPipeline;
}
