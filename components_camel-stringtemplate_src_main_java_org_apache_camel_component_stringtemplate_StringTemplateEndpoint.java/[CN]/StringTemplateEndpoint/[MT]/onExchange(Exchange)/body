{
  StringWriter buffer=new StringWriter();
  Map variableMap=ExchangeHelper.createVariableMap(exchange);
  String text=IOConverter.toString(getResource().getInputStream());
  StringTemplate template=new StringTemplate(text);
  template.setAttributes(variableMap);
  template.write(new AutoIndentWriter(buffer));
  Message out=exchange.getOut(true);
  out.setBody(buffer.toString());
  out.setHeader("org.apache.camel.stringtemplate.resource",getResource());
}
