{
  Queue<Exchange> exchanges=new ArrayDeque<>();
  BigIntComparisons condition=null;
  BigInteger providedSeqNum=null;
  if (lastSeenSequenceNumber != null) {
    providedSeqNum=new BigInteger(lastSeenSequenceNumber);
    condition=BigIntComparisons.Conditions.LT;
  }
switch (getEndpoint().getIteratorType()) {
case AFTER_SEQUENCE_NUMBER:
    condition=BigIntComparisons.Conditions.LT;
  providedSeqNum=new BigInteger(getEndpoint().getSequenceNumberProvider().getSequenceNumber());
break;
case AT_SEQUENCE_NUMBER:
condition=BigIntComparisons.Conditions.LTEQ;
providedSeqNum=new BigInteger(getEndpoint().getSequenceNumberProvider().getSequenceNumber());
break;
default :
}
for (Record record : records) {
BigInteger recordSeqNum=new BigInteger(record.getDynamodb().getSequenceNumber());
if (condition == null || condition.matches(providedSeqNum,recordSeqNum)) {
exchanges.add(getEndpoint().createExchange(record));
}
}
return exchanges;
}
