{
  Queue<Exchange> exchanges=new ArrayDeque<>();
  AtAfterCondition condition;
  BigInteger providedSeqNum=null;
switch (getEndpoint().getIteratorType()) {
case AFTER_SEQUENCE_NUMBER:
    condition=AtAfterCondition.Conditions.AFTER;
  providedSeqNum=new BigInteger(getEndpoint().getSequenceNumberProvider().getSequenceNumber());
break;
case AT_SEQUENCE_NUMBER:
condition=AtAfterCondition.Conditions.AT;
providedSeqNum=new BigInteger(getEndpoint().getSequenceNumberProvider().getSequenceNumber());
break;
default :
condition=null;
}
for (Record record : records) {
BigInteger recordSeqNum=new BigInteger(record.getDynamodb().getSequenceNumber());
if (condition == null || condition.matches(providedSeqNum,recordSeqNum)) {
exchanges.add(getEndpoint().createExchange(record));
}
}
return exchanges;
}
