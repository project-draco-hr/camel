{
  when(endpoint.getIncrement()).thenReturn(null);
  when(endpoint.getDecrement()).thenReturn(DECREMENT);
  when(endpoint.getLongHeader(exchange,HEADER_COUNTER_INCREMENT,null)).thenReturn(null);
  when(endpoint.getLongHeader(exchange,HEADER_COUNTER_DECREMENT,DECREMENT)).thenReturn(DECREMENT - 1);
  producer.process(exchange);
  inOrder.verify(endpoint,times(1)).getMetricsName(exchange);
  inOrder.verify(endpoint,times(1)).getRegistry();
  inOrder.verify(registry,times(1)).counter(ENDPOINT_NAME);
  inOrder.verify(endpoint,times(1)).getIncrement();
  inOrder.verify(endpoint,times(1)).getDecrement();
  inOrder.verify(endpoint,times(1)).getLongHeader(exchange,HEADER_COUNTER_INCREMENT,null);
  inOrder.verify(endpoint,times(1)).getLongHeader(exchange,HEADER_COUNTER_DECREMENT,DECREMENT);
  inOrder.verify(counter,times(1)).dec(DECREMENT - 1);
  inOrder.verifyNoMoreInteractions();
}
