{
  while (engine.size() >= capacity) {
    Thread.sleep(getTimeout());
  }
  try {
    engine.insert(exchange);
    delivery.request();
  }
 catch (  IllegalArgumentException e) {
    if (isIgnoreInvalidExchanges()) {
      LOG.debug("Invalid Exchange. This Exchange will be ignored: {}",exchange);
      return;
    }
 else {
      throw new CamelExchangeException("Error processing Exchange in StreamResequencer",exchange,e);
    }
  }
}
