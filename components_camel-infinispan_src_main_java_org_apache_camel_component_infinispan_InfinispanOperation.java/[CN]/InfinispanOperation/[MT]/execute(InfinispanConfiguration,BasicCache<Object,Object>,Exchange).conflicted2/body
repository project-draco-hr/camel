{
  if (!isInHeaderEmpty(exchange,InfinispanConstants.LIFESPAN_TIME) && !isInHeaderEmpty(exchange,InfinispanConstants.LIFESPAN_TIME_UNIT)) {
    long lifespan=exchange.getIn().getHeader(InfinispanConstants.LIFESPAN_TIME,long.class);
    String timeUnit=exchange.getIn().getHeader(InfinispanConstants.LIFESPAN_TIME_UNIT,String.class);
    if (!isInHeaderEmpty(exchange,InfinispanConstants.MAX_IDLE_TIME) && !isInHeaderEmpty(exchange,InfinispanConstants.MAX_IDLE_TIME_UNIT)) {
      long maxIdle=exchange.getIn().getHeader(InfinispanConstants.MAX_IDLE_TIME,long.class);
      String maxIdleTimeUnit=exchange.getIn().getHeader(InfinispanConstants.MAX_IDLE_TIME_UNIT,String.class);
      cache.putAll(getMap(exchange),lifespan,TimeUnit.valueOf(timeUnit),maxIdle,TimeUnit.valueOf(maxIdleTimeUnit));
    }
 else {
      cache.putAll(getMap(exchange),lifespan,TimeUnit.valueOf(timeUnit));
    }
  }
 else {
    cache.putAll(getMap(exchange));
  }
}
