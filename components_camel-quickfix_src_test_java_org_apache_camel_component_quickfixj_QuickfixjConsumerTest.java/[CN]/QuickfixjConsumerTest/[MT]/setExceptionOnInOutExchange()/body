{
  org.apache.camel.Message mockCamelOutMessage=Mockito.mock(org.apache.camel.Message.class);
  Mockito.when(mockExchange.getPattern()).thenReturn(ExchangePattern.InOut);
  Mockito.when(mockExchange.hasOut()).thenReturn(true);
  Mockito.when(mockExchange.getOut()).thenReturn(mockCamelOutMessage);
  Mockito.when(mockCamelOutMessage.getBody(Message.class)).thenReturn(new Message());
  QuickfixjConsumer consumer=new QuickfixjConsumer(mockEndpoint,mockProcessor);
  consumer.start();
  consumer.onExchange(mockExchange);
  Mockito.verify(mockExchange).setException(Mockito.isA(IllegalStateException.class));
}
