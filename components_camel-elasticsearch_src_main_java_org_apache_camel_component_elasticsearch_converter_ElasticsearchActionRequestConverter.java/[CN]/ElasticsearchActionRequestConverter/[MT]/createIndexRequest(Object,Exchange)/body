{
  IndexRequest indexRequest=new IndexRequest();
  if (document instanceof byte[]) {
    indexRequest.source((byte[])document);
  }
 else   if (document instanceof Map) {
    indexRequest.source((Map<String,Object>)document);
  }
 else   if (document instanceof String) {
    indexRequest.source((String)document);
  }
 else   if (document instanceof XContentBuilder) {
    indexRequest.source((XContentBuilder)document);
  }
 else {
    return null;
  }
  return indexRequest.consistencyLevel(exchange.getIn().getHeader(ElasticsearchConfiguration.PARAM_CONSISTENCY_LEVEL,WriteConsistencyLevel.class)).replicationType(exchange.getIn().getHeader(ElasticsearchConfiguration.PARAM_REPLICATION_TYPE,ReplicationType.class)).index(exchange.getIn().getHeader(ElasticsearchConfiguration.PARAM_INDEX_NAME,String.class)).type(exchange.getIn().getHeader(ElasticsearchConfiguration.PARAM_INDEX_TYPE,String.class));
}
