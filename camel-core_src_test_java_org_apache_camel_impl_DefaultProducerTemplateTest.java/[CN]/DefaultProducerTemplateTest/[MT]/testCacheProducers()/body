{
  ProducerTemplate template=new DefaultProducerTemplate(context);
  template.setMaximumCacheSize(500);
  template.start();
  assertEquals("Size should be 0",0,template.getCurrentCacheSize());
  for (int i=0; i < 503; i++) {
    Endpoint e=context.getEndpoint("direct:queue:" + i);
    template.sendBody(e,"Hello");
  }
  assertEquals("Size should be 500",500,template.getCurrentCacheSize());
  template.stop();
  assertEquals("Size should be 0",0,template.getCurrentCacheSize());
}
