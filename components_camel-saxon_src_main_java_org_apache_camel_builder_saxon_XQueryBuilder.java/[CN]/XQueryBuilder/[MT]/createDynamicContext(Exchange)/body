{
  Configuration config=getConfiguration();
  DynamicQueryContext dynamicQueryContext=new DynamicQueryContext(config);
  Message in=exchange.getIn();
  Item item=in.getBody(Item.class);
  Source source=null;
  if (item != null) {
    dynamicQueryContext.setContextItem(item);
  }
 else {
    source=in.getBody(Source.class);
    if (source == null) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("No body available on exchange so using an empty document: " + exchange);
      }
      source=converter.toSource(converter.createDocument());
    }
    DocumentInfo doc=getStaticQueryContext().buildDocument(source);
    dynamicQueryContext.setContextItem(doc);
  }
  configureQuery(dynamicQueryContext,exchange);
  return dynamicQueryContext;
}
