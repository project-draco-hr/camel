{
  int total=1;
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedMessageCount(total);
  ThreadPoolTaskExecutor executor=new ThreadPoolTaskExecutor();
  executor.setCorePoolSize(5);
  executor.afterPropertiesSet();
  for (int i=0; i < 1; i++) {
    final int threadCount=i;
    executor.execute(new Runnable(){
      public void run(){
        int start=threadCount * 20;
        for (int i=0; i < 1; i++) {
          template.sendBody("seda:in","<mail><subject>" + (start + i) + "</subject><body>Hello world!</body></mail>");
        }
      }
    }
);
  }
  mock.assertIsSatisfied();
  mock.assertNoDuplicates(body());
}
