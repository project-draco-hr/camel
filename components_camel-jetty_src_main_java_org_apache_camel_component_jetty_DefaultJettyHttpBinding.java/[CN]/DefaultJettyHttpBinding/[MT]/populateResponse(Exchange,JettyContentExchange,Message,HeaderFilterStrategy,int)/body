{
  Message answer=exchange.getOut();
  answer.setHeaders(in.getHeaders());
  answer.setHeader(Exchange.HTTP_RESPONSE_CODE,responseCode);
  for (  Map.Entry<String,String> entry : httpExchange.getHeaders().entrySet()) {
    String name=entry.getKey();
    String value=entry.getValue();
    if (name.toLowerCase().equals("content-type")) {
      name=Exchange.CONTENT_TYPE;
    }
    if (strategy != null && !strategy.applyFilterToExternalHeaders(name,value,exchange)) {
      answer.setHeader(name,value);
    }
  }
  answer.setBody(extractResponseBody(exchange,httpExchange));
}
