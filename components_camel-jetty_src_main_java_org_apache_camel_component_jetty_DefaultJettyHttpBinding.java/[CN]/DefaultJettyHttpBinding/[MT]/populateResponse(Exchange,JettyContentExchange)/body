{
  int responseCode=httpExchange.getResponseStatus();
  LOG.debug("HTTP responseCode: {}",responseCode);
  Message in=exchange.getIn();
  if (!isThrowExceptionOnFailure()) {
    populateResponse(exchange,httpExchange,in,getHeaderFilterStrategy(),responseCode);
  }
 else {
    if (responseCode >= 100 && responseCode < 300) {
      populateResponse(exchange,httpExchange,in,getHeaderFilterStrategy(),responseCode);
    }
 else {
      throw populateHttpOperationFailedException(exchange,httpExchange,responseCode);
    }
  }
}
