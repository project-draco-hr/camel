{
  char[] buffer=new char[10];
  expect(readerMock.read(same(buffer),eq(3),eq(5))).andDelegateTo(new ConstantReader(new char[]{'a','b','c'}));
  expect(nonXmlCharFiltererMock.filter(same(buffer),eq(3),eq(3))).andReturn(false);
  replayAll();
  int result=nonXmlFilterReader.read(buffer,3,5);
  verifyAll();
  assertEquals("Unexpected number of chars read",3,result);
  assertArrayEquals("Wrong buffer contents",new char[]{0,0,0,'a','b','c',0,0,0,0},buffer);
}
