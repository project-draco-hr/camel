{
  if (log.isTraceEnabled()) {
    log.trace("Polling directory: " + dir);
  }
  String currentDir=client.printWorkingDirectory();
  client.changeWorkingDirectory(dir);
  for (  FTPFile ftpFile : client.listFiles()) {
    if (ftpFile.isFile()) {
      pollFile(ftpFile);
    }
 else     if (ftpFile.isDirectory()) {
      if (isRecursive()) {
        pollDirectory(getFullFileName(ftpFile));
      }
    }
 else {
      log.debug("Unsupported type of FTPFile: " + ftpFile + " (not a file or directory). It is skipped.");
    }
  }
  client.changeWorkingDirectory(currentDir);
}
