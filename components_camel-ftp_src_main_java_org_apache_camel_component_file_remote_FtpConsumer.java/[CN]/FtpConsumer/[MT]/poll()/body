{
  connectIfNecessary();
  try {
    final String fileName=endpoint.getConfiguration().getFile();
    if (endpoint.getConfiguration().isDirectory()) {
      pollDirectory(fileName);
    }
 else {
      int index=fileName.lastIndexOf('/');
      if (index > -1) {
        client.changeWorkingDirectory(fileName.substring(0,index));
      }
      final FTPFile[] files=client.listFiles(fileName.substring(index + 1));
      pollFile(files[0]);
    }
    lastPollTime=System.currentTimeMillis();
  }
 catch (  FTPConnectionClosedException e) {
    LOG.warn("Disconnecting due to exception: " + e.toString());
    disconnect();
    throw e;
  }
catch (  RuntimeCamelException e) {
    LOG.warn("Caught RuntimeCamelException: " + e.toString());
    LOG.warn("Hoping an explicit disconnect/reconnect will solve the problem");
    disconnect();
    throw e;
  }
}
