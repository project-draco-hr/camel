{
  String blobName=extractBlobName(exchange);
  if (blobName != null && exchange.getIn() != null && exchange.getIn().getBody() != null) {
    Object body=exchange.getIn().getBody();
    BlobStore blobStore=blobStoreContext.getBlobStore();
    Blob blob=blobStore.newBlob(blobName);
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    ObjectOutputStream oos=null;
    try {
      oos=new ObjectOutputStream(baos);
      oos.writeObject(body);
      blob.setPayload(baos.toByteArray());
      blobStore.putBlob(container,blob);
    }
 catch (    IOException e) {
      LOG.error("Error while writing blob",e);
    }
 finally {
      if (oos != null) {
        try {
          oos.close();
        }
 catch (        IOException e) {
        }
      }
      if (baos != null) {
        try {
          baos.close();
        }
 catch (        IOException e) {
        }
      }
    }
  }
}
