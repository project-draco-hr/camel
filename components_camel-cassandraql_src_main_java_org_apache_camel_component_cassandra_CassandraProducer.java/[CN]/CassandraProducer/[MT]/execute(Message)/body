{
  String messageCql=message.getHeader(CassandraConstants.CQL_QUERY,String.class);
  Object[] cqlParams=getCqlParams(message);
  ResultSet resultSet;
  PreparedStatement lPreparedStatement;
  if (messageCql == null || messageCql.isEmpty()) {
    if (preparedStatement == null) {
      this.preparedStatement=getEndpoint().prepareStatement();
    }
    lPreparedStatement=this.preparedStatement;
  }
 else {
    lPreparedStatement=getEndpoint().prepareStatement(messageCql);
  }
  Session session=getEndpoint().getSession();
  if (cqlParams == null) {
    resultSet=session.execute(lPreparedStatement.bind());
  }
 else {
    resultSet=session.execute(lPreparedStatement.bind(cqlParams));
  }
  return resultSet;
}
