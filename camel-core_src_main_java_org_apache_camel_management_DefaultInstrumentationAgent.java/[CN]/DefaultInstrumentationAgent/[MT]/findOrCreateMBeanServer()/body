{
  if (Boolean.getBoolean(JmxSystemPropertyKeys.USE_PLATFORM_MBS) || usePlatformMBeanServer) {
    return ManagementFactory.getPlatformMBeanServer();
  }
  List<MBeanServer> servers=(List<MBeanServer>)MBeanServerFactory.findMBeanServer(null);
  for (  MBeanServer server : servers) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Found MBeanServer with default domain " + server.getDefaultDomain());
    }
    if (mBeanServerDefaultDomain.equals(server.getDefaultDomain())) {
      return server;
    }
  }
  return MBeanServerFactory.createMBeanServer(mBeanServerDefaultDomain);
}
