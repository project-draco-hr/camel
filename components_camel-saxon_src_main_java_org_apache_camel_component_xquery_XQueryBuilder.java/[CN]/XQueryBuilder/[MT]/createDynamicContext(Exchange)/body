{
  Configuration config=getConfiguration();
  DynamicQueryContext dynamicQueryContext=new DynamicQueryContext(config);
  Message in=exchange.getIn();
  Source source=null;
  try {
    Item item=in.getBody(Item.class);
    dynamicQueryContext.setContextItem(item);
  }
 catch (  NoTypeConversionAvailableException e) {
    try {
      source=in.getBody(Source.class);
    }
 catch (    NoTypeConversionAvailableException e2) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("No body available on exchange so using an empty document: " + exchange);
      }
      source=converter.toSource(converter.createDocument());
    }
    DocumentInfo doc=getStaticQueryContext().buildDocument(source);
    dynamicQueryContext.setContextItem(doc);
  }
  configureQuery(dynamicQueryContext,exchange);
  return dynamicQueryContext;
}
