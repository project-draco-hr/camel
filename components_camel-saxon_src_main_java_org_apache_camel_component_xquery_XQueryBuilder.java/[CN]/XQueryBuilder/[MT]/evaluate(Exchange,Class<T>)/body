{
  ObjectHelper.notNull(type,"type");
  try {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Evaluation: " + expression + " for exchange: "+ exchange);
    }
    if (type.equals(String.class)) {
      return (T)evaluateAsString(exchange);
    }
 else     if (type.isAssignableFrom(Collection.class)) {
      return (T)evaluateAsList(exchange);
    }
 else     if (type.isAssignableFrom(Node.class)) {
      return (T)evaluateAsDOM(exchange);
    }
 else {
      throw new IllegalArgumentException("Type: " + type.getCanonicalName() + " not supported");
    }
  }
 catch (  Exception e) {
    throw new RuntimeExpressionException(e);
  }
}
