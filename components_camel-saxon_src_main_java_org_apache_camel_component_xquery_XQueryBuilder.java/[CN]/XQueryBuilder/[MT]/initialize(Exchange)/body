{
  if (!initialized.get()) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Initializing XQueryBuilder " + this);
    }
    configuration=new Configuration();
    configuration.setHostLanguage(Configuration.XQUERY);
    configuration.setStripsWhiteSpace(isStripsAllWhiteSpace() ? Whitespace.ALL : Whitespace.IGNORABLE);
    staticQueryContext=new StaticQueryContext(getConfiguration());
    Set<Map.Entry<String,String>> entries=namespacePrefixes.entrySet();
    for (    Map.Entry<String,String> entry : entries) {
      String prefix=entry.getKey();
      String uri=entry.getValue();
      staticQueryContext.declareNamespace(prefix,uri);
      staticQueryContext.setInheritNamespaces(true);
    }
    expression=createQueryExpression(staticQueryContext);
    initialized.set(true);
  }
  exchange.setProperty("CamelSaxonConfiguration",configuration);
}
