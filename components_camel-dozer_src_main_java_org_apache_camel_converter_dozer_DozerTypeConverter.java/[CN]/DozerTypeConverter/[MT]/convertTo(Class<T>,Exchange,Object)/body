{
  if (exchange == null) {
    return mapper.map(value,type);
  }
  T answer=null;
  ClassLoader prev=Thread.currentThread().getContextClassLoader();
  ClassLoader contextCl=exchange.getContext().getApplicationContextClassLoader();
  if (contextCl != null) {
    LOG.debug("Switching TCCL to: {}.",contextCl);
    try {
      Thread.currentThread().setContextClassLoader(contextCl);
      answer=mapper.map(value,type);
    }
  finally {
      LOG.debug("Restored TCCL to: {}.",prev);
      Thread.currentThread().setContextClassLoader(prev);
    }
  }
 else {
    answer=mapper.map(value,type);
  }
  return answer;
}
