{
  context.start();
  CachedOutputStream cos=new CachedOutputStream(exchange,false);
  cos.write(TEST_STRING.getBytes("UTF-8"));
  File file=new File("target/cachedir");
  String[] files=file.list();
  assertEquals("we should have a temp file",1,files.length);
  assertTrue("The file name should start with cos",files[0].startsWith("cos"));
  InputStream is=cos.getWrappedInputStream();
  exchange.getUnitOfWork().done(exchange);
  String temp=toString(is);
  assertEquals("Get a wrong stream content",temp,TEST_STRING);
  IOHelper.close(is);
  files=file.list();
  assertEquals("we should have a temp file",0,files.length);
  IOHelper.close(cos);
}
