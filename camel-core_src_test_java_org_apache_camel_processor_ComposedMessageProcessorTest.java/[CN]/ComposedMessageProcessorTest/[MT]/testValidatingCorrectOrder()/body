{
  MockEndpoint resultEndpoint=getMockEndpoint("mock:result");
  resultEndpoint.expectedMessageCount(1);
  resultEndpoint.expectedHeaderReceived("orderId","myorderid");
  List<OrderItem> order=Arrays.asList(new OrderItem[]{new OrderItem("widget",5),new OrderItem("gadget",10)});
  template.sendBodyAndHeader("direct:start",order,"orderId","myorderid");
  assertMockEndpointsSatisfied();
  List<OrderItem> validatedOrder=resultEndpoint.getExchanges().get(0).getIn().getBody(List.class);
  assertTrue(validatedOrder.get(0).valid);
  assertTrue(validatedOrder.get(1).valid);
}
