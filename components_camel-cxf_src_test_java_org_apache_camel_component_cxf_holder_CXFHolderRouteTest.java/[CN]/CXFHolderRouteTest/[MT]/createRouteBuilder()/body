{
  return new RouteBuilder(){
    public void configure(){
      from(CXF_ENDPOINT_URI).wireTap("seda:tap").process(new Processor(){
        @SuppressWarnings("unchecked") public void process(        Exchange exchange) throws Exception {
          Message in=exchange.getIn();
          List<Object> parameters=in.getBody(List.class);
          int amount=(Integer)parameters.remove(1);
          Holder<String> customer=(Holder<String>)parameters.get(1);
          if (customer.value.length() == 0) {
            customer.value="newCustomer";
          }
          parameters.add(0,"Ordered ammount " + amount);
          exchange.getOut().setBody(parameters);
        }
      }
);
      from("seda:tap").to("log:myEndpoint");
    }
  }
;
}
