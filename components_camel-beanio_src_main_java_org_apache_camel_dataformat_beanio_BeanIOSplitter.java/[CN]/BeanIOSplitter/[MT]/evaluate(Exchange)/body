{
  Message msg=exchange.getIn();
  Object body=msg.getBody();
  if (factory == null) {
    factory=createStreamFactory(exchange.getContext());
  }
  BeanReader beanReader=null;
  if (body instanceof WrappedFile) {
    body=((WrappedFile)body).getFile();
  }
  if (body instanceof File) {
    File file=(File)body;
    beanReader=factory.createReader(getStreamName(),file);
  }
  if (beanReader == null) {
    Reader reader=msg.getMandatoryBody(Reader.class);
    beanReader=factory.createReader(getStreamName(),reader);
  }
  BeanIOIterator iterator=new BeanIOIterator(beanReader);
  BeanReaderErrorHandler errorHandler=getOrCreateBeanReaderErrorHandler(configuration,exchange,null,iterator);
  beanReader.setErrorHandler(errorHandler);
  return iterator;
}
