{
  if (started.get() && stopping.compareAndSet(false,true)) {
    try {
      doStop();
    }
  finally {
      stopped.set(true);
      started.set(false);
      stopping.set(false);
    }
  }
}
