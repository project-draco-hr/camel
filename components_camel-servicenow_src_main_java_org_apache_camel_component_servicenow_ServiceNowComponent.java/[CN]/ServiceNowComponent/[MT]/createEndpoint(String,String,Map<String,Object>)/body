{
  final CamelContext context=getCamelContext();
  final ServiceNowConfiguration configuration=new ServiceNowConfiguration();
  Map<String,Object> models=IntrospectionSupport.extractProperties(parameters,"model.");
  for (  Map.Entry<String,Object> entry : models.entrySet()) {
    configuration.addModel(entry.getKey(),EndpointHelper.resolveParameter(context,(String)entry.getValue(),Class.class));
  }
  setProperties(configuration,parameters);
  String instanceName=getCamelContext().resolvePropertyPlaceholders(remaining);
  if (!configuration.hasApiUrl()) {
    configuration.setApiUrl(String.format("https://%s.service-now.com/api",instanceName));
  }
  if (!configuration.hasOautTokenUrl()) {
    configuration.setOauthTokenUrl(String.format("https://%s.service-now.com/oauth_token.do",instanceName));
  }
  return new ServiceNowEndpoint(uri,this,configuration,instanceName);
}
