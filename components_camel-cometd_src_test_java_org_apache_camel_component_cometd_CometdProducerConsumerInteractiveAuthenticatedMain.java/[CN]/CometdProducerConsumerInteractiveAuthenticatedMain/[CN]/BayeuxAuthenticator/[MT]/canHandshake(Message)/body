{
  Map<String,Object> ext=message.getExt(false);
  if (ext == null) {
    return false;
  }
  ext.remove("authenticationData");
  @SuppressWarnings("unchecked") Map<String,Object> authentication=(Map<String,Object>)ext.get("authentication");
  if (authentication == null) {
    return false;
  }
  Object authenticationData=verify(authentication);
  if (authenticationData == null) {
    return false;
  }
  ext.put("authenticationData",authenticationData);
  return true;
}
