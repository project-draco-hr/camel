{
  if (session.isLocalSession()) {
    return true;
  }
  Map<String,Object> ext=message.getExt();
  if (ext == null) {
    return false;
  }
  @SuppressWarnings("unchecked") Map<String,Object> authentication=(Map<String,Object>)ext.get("authentication");
  if (authentication == null) {
    return false;
  }
  Object authenticationData=verify(authentication);
  if (authenticationData == null) {
    return false;
  }
  session.addListener(this);
  return true;
}
