{
  MockEndpoint mock=getMockEndpoint("mock:a01");
  mock.expectedMessageCount(1);
  mock.message(0).body().isInstanceOf(Message.class);
  String line1="MSH|^~\\&|MYSENDER|MYSENDERAPP|MYCLIENT|MYCLIENTAPP|200612211200||ADT^A01|1234|P|2.4";
  String line2="PID|||123456||Doe^John";
  StringBuffer in=new StringBuffer();
  in.append(line1);
  in.append("\n");
  in.append(line2);
  String out=(String)template.requestBody("mina:tcp://localhost:8888?sync=true&codec=hl7codec",in.toString());
  String[] lines=out.split("\r");
  assertEquals("MSH|^~\\&|MYSENDER||||200701011539||ADT^A01||||123",lines[0]);
  assertEquals("PID|||123456||Doe^John",lines[1]);
  assertMockEndpointsSatisfied();
}
