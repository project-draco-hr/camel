{
  if (isGzip(contentEncoding)) {
    ByteArrayOutputStream os=null;
    GZIPOutputStream gzip=null;
    try {
      os=new ByteArrayOutputStream();
      gzip=new GZIPOutputStream(os);
      gzip.write(data);
      gzip.finish();
      return new ByteArrayInputStream(os.toByteArray());
    }
  finally {
      IOHelper.close(gzip,"gzip");
      IOHelper.close(os,"byte array output stream");
    }
  }
 else {
    return new ByteArrayInputStream(data);
  }
}
