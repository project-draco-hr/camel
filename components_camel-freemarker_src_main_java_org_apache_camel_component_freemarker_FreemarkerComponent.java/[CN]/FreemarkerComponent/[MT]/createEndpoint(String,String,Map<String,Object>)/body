{
  FreemarkerEndpoint endpoint=new FreemarkerEndpoint(uri,this,remaining);
  Configuration config;
  String encoding=getAndRemoveParameter(parameters,"encoding",String.class);
  if (ObjectHelper.isNotEmpty(encoding)) {
    endpoint.setEncoding(encoding);
  }
  boolean cache=getAndRemoveParameter(parameters,"contentCache",Boolean.class,Boolean.TRUE);
  if (cache) {
    config=getConfiguration();
    int templateUpdateDelay=getAndRemoveParameter(parameters,"templateUpdateDelay",Integer.class,0);
    if (templateUpdateDelay > 0) {
      config.setTemplateUpdateDelay(templateUpdateDelay);
    }
  }
 else {
    config=getNoCacheConfiguration();
  }
  endpoint.setConfiguration(config);
  return endpoint;
}
