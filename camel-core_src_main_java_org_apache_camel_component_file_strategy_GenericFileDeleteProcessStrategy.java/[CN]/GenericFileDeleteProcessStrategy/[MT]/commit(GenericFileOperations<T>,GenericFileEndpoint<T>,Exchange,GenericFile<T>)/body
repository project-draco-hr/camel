{
  super.commit(operations,endpoint,exchange,file);
  int retries=3;
  boolean deleted=false;
  while (retries > 0 && !deleted) {
    retries--;
    if (operations.deleteFile(file.getAbsoluteFilePath())) {
      deleted=true;
      break;
    }
    boolean exits=operations.existsFile(file.getAbsoluteFilePath());
    if (!exits) {
      deleted=true;
    }
 else {
      log.trace("File was not deleted at this attempt will try again in 1 sec.: {}",file);
      Thread.sleep(1000);
    }
  }
  if (!deleted) {
    throw new GenericFileOperationFailedException("Cannot delete file: " + file);
  }
}
