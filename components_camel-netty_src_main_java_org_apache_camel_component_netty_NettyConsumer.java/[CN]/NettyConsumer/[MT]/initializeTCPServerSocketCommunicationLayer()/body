{
  bossExecutor=context.getExecutorServiceManager().newCachedThreadPool(this,"NettyTCPBoss");
  workerExecutor=context.getExecutorServiceManager().newCachedThreadPool(this,"NettyTCPWorker");
  if (configuration.getWorkerCount() <= 0) {
    channelFactory=new NioServerSocketChannelFactory(bossExecutor,workerExecutor);
  }
 else {
    channelFactory=new NioServerSocketChannelFactory(bossExecutor,workerExecutor,configuration.getWorkerCount());
  }
  serverBootstrap=new ServerBootstrap(channelFactory);
  serverBootstrap.setOption("child.keepAlive",configuration.isKeepAlive());
  serverBootstrap.setOption("child.tcpNoDelay",configuration.isTcpNoDelay());
  serverBootstrap.setOption("reuseAddress",configuration.isReuseAddress());
  serverBootstrap.setOption("child.reuseAddress",configuration.isReuseAddress());
  serverBootstrap.setOption("child.connectTimeoutMillis",configuration.getConnectTimeout());
  ChannelPipeline serverPipeline=pipelineFactory.getPipeline(this);
  serverBootstrap.setPipeline(serverPipeline);
  channel=serverBootstrap.bind(new InetSocketAddress(configuration.getHost(),configuration.getPort()));
  allChannels.add(channel);
}
