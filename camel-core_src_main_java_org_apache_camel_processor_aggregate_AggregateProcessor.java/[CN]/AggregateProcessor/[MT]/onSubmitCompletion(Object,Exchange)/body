{
  LOG.debug("Aggregation complete for correlation key {} sending aggregated exchange: {}",key,exchange);
  inProgressCompleteExchanges.add(exchange.getExchangeId());
  executorService.submit(new Runnable(){
    public void run(){
      LOG.debug("Processing aggregated exchange: {}",exchange);
      exchange.addOnCompletion(new AggregateOnCompletion(exchange.getExchangeId()));
      try {
        processor.process(exchange);
      }
 catch (      Throwable e) {
        exchange.setException(e);
      }
      if (exchange.getException() != null) {
        getExceptionHandler().handleException("Error processing aggregated exchange",exchange,exchange.getException());
      }
 else {
        LOG.trace("Processing aggregated exchange: {} complete.",exchange);
      }
    }
  }
);
}
