{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Aggregation complete for correlation key " + key + " sending aggregated exchange: "+ exchange);
  }
  inProgressCompleteExchanges.add(exchange.getExchangeId());
  executorService.submit(new Runnable(){
    public void run(){
      if (LOG.isDebugEnabled()) {
        LOG.debug("Processing aggregated exchange: " + exchange);
      }
      exchange.addOnCompletion(new AggregateOnCompletion(exchange.getExchangeId()));
      try {
        processor.process(exchange);
      }
 catch (      Throwable e) {
        exchange.setException(e);
      }
      if (exchange.getException() != null) {
        getExceptionHandler().handleException("Error processing aggregated exchange",exchange,exchange.getException());
      }
 else {
        if (LOG.isTraceEnabled()) {
          LOG.trace("Processing aggregated exchange: " + exchange + " complete.");
        }
      }
    }
  }
);
}
