{
  exchange.setProperty(Exchange.AGGREGATED_CORRELATION_KEY,key);
  aggregationRepository.remove(exchange.getContext(),key,exchange);
  if (!fromTimeout && timeoutMap != null) {
    timeoutMap.remove(key);
  }
  if (closedCorrelationKeys != null) {
    closedCorrelationKeys.put(key,key);
  }
  if (fromTimeout && isDiscardOnCompletionTimeout()) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Aggregation for correlation key " + key + " discarding aggregated exchange: "+ exchange);
    }
    aggregationRepository.confirm(exchange.getContext(),exchange.getExchangeId());
    redeliveryState.remove(exchange.getExchangeId());
  }
 else {
    onSubmitCompletion(key,exchange);
  }
}
