{
  final IBatisEndpoint endpoint=getEndpoint();
  final Exchange exchange=endpoint.createExchange(ExchangePattern.InOnly);
  Message msg=exchange.getIn();
  msg.setBody(data);
  msg.setHeader(IBatisConstants.IBATIS_STATEMENT_NAME,endpoint.getStatement());
  if (LOG.isDebugEnabled()) {
    LOG.debug("Processing exchange: " + exchange);
  }
  getProcessor().process(exchange);
  try {
    if (onConsume != null) {
      endpoint.getProcessingStrategy().commit(endpoint,exchange,data,onConsume);
    }
  }
 catch (  Exception e) {
    handleException(e);
  }
}
