{
  final SslContextFactory sslContextFactory=new SslContextFactory();
  sslContextFactory.setSslContext(new SSLContextParameters().createSSLContext());
  final HttpClient httpClient=new HttpClient(sslContextFactory);
  httpClient.setConnectTimeout(TIMEOUT);
  httpClient.setTimeout(TIMEOUT);
  httpClient.registerListener(RedirectListener.class.getName());
  httpClient.start();
  final SalesforceSession session=new SalesforceSession(httpClient,LoginConfigHelper.getLoginConfig());
  session.addListener(this);
  try {
    String loginToken=session.login(session.getAccessToken());
    LOG.info("First token " + loginToken);
    assertTrue("SalesforceSessionListener onLogin NOT called",onLoginTriggered);
    onLoginTriggered=false;
    loginToken=session.login(loginToken);
    LOG.info("Refreshed token " + loginToken);
    assertTrue("SalesforceSessionListener onLogout NOT called",onLogoutTriggered);
    assertTrue("SalesforceSessionListener onLogin NOT called",onLoginTriggered);
  }
  finally {
    session.logout();
  }
}
