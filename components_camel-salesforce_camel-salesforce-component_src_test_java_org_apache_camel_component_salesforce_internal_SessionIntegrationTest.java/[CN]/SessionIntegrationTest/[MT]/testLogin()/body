{
  final SslContextFactory sslContextFactory=new SslContextFactory();
  sslContextFactory.setSslContext(new SSLContextParameters().createSSLContext());
  final SalesforceHttpClient httpClient=new SalesforceHttpClient(sslContextFactory);
  httpClient.setConnectTimeout(TIMEOUT);
  final SalesforceSession session=new SalesforceSession(httpClient,TIMEOUT,LoginConfigHelper.getLoginConfig());
  session.addListener(this);
  httpClient.setSession(session);
  httpClient.start();
  try {
    String loginToken=session.login(session.getAccessToken());
    LOG.info("First token " + loginToken);
    assertTrue("SalesforceSessionListener onLogin NOT called",onLoginTriggered);
    onLoginTriggered=false;
    loginToken=session.login(loginToken);
    LOG.info("Refreshed token " + loginToken);
    assertTrue("SalesforceSessionListener onLogout NOT called",onLogoutTriggered);
    assertTrue("SalesforceSessionListener onLogin NOT called",onLoginTriggered);
  }
  finally {
    session.logout();
  }
}
