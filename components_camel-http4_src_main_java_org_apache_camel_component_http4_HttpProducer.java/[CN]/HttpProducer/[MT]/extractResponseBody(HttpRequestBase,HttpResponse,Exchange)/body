{
  HttpEntity entity=httpResponse.getEntity();
  if (entity == null) {
    return null;
  }
  InputStream is=entity.getContent();
  if (is == null) {
    return null;
  }
  Header header=httpRequest.getFirstHeader(Exchange.CONTENT_ENCODING);
  String contentEncoding=header != null ? header.getValue() : null;
  if (!exchange.getProperty(Exchange.SKIP_GZIP_ENCODING,Boolean.FALSE,Boolean.class)) {
    is=GZIPHelper.uncompressGzip(contentEncoding,is);
  }
  header=httpRequest.getFirstHeader("content-type");
  if (header != null) {
    String contentType=header.getValue();
    int index=contentType.indexOf("charset=");
    if (index > 0) {
      String charset=contentType.substring(index + 8);
      exchange.setProperty(Exchange.CHARSET_NAME,charset);
    }
  }
  return doExtractResponseBody(is,exchange);
}
