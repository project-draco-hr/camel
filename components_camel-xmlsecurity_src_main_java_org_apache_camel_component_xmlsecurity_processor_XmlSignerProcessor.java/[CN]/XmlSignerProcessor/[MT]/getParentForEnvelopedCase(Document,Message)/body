{
  NodeList parents=doc.getElementsByTagNameNS(getConfiguration().getParentNamespace(),getConfiguration().getParentLocalName());
  if (parents == null || parents.getLength() == 0) {
    throw new XmlSignatureFormatException(String.format("Incoming message has wrong format: The parent element with the local name %s and the namespace %s was not found in the message to build an enveloped XML signature.",getConfiguration().getParentLocalName(),getConfiguration().getParentNamespace()));
  }
  return (Element)parents.item(0);
}
