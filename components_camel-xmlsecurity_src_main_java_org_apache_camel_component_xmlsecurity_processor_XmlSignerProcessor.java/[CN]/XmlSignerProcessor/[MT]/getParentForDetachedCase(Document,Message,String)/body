{
  String elementId=referenceUri;
  if (elementId.startsWith("#")) {
    elementId=elementId.substring(1);
  }
  Element el=doc.getElementById(elementId);
  if (el == null) {
    throw new IllegalStateException("No element found for element ID " + elementId);
  }
  LOG.debug("Sibling element of the detached XML Signature with reference URI {}: {}  {} ",new Object[]{referenceUri,el.getLocalName(),el.getNamespaceURI()});
  Element result=getParentElement(el);
  if (result != null) {
    return result;
  }
 else {
    throw new XmlSignatureException("Either the configuration of the XML Signature component is wrong or the incoming document has an invalid structure: The element " + el.getLocalName() + "{"+ el.getNamespaceURI()+ "} which is referenced by the reference URI "+ referenceUri+ " has no parent element. The element must have a parent element in the configured detached case.");
  }
}
