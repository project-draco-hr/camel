{
  try {
    return XmlSignatureHelper.newDocumentBuilder(disallowDoctypeDecl).parse(is);
  }
 catch (  SAXException e) {
    throw new XmlSignatureFormatException("XML signature generation not possible. Sent message is not an XML document. Check the sent message.",e);
  }
 finally {
    IOHelper.close(is,"input stream");
  }
}
