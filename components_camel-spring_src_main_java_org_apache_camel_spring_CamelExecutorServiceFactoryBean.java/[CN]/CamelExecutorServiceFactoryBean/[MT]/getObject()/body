{
  if (camelContext == null && camelContextId != null) {
    camelContext=CamelContextResolverHelper.getCamelContextWithId(applicationContext,camelContextId);
  }
  notNull(camelContext,"camelContext");
  String name=getThreadName() != null ? getThreadName() : getId();
  ExecutorService answer;
  if (getPoolSize() == null || getPoolSize() <= 0) {
    answer=camelContext.getExecutorServiceStrategy().newCachedThreadPool(name);
  }
 else {
    int max=getMaxPoolSize() != null ? getMaxPoolSize() : getPoolSize();
    answer=camelContext.getExecutorServiceStrategy().newThreadPool(name,getPoolSize(),max,getKeepAliveTime(),getUnits(),isDeamon());
  }
  return answer;
}
