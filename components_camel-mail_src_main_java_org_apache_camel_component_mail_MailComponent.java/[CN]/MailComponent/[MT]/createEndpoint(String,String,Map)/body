{
  URI url=new URI(uri);
  if ("nntp".equalsIgnoreCase(url.getScheme())) {
    throw new UnsupportedOperationException("nntp protocol is not supported");
  }
  MailConfiguration config=new MailConfiguration();
  config.configure(url);
  configureAdditionalJavaMailProperties(config,parameters);
  MailEndpoint endpoint=new MailEndpoint(uri,this,config);
  setProperties(endpoint.getConfiguration(),parameters);
  return endpoint;
}
