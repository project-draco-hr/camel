{
  CxfEndpoint endpoint=(CxfEndpoint)camelContext.resolveEndpoint("cxf:http://localhost/test");
  assertNotNull(endpoint);
  LocalTransportFactory factory=endpoint.getLocalTransportFactory();
  EndpointInfo ei=new EndpointInfo(null,"http://schemas.xmlsoap.org/soap/http");
  AddressType a=new AddressType();
  a.setLocation("http://localhost/test");
  ei.addExtensor(a);
  LocalDestination d=(LocalDestination)factory.getDestination(ei);
  d.setMessageObserver(new EchoObserver());
  Exchange exchange=client.send("cxf:http://localhost/test",new Processor<Exchange>(){
    public void onExchange(    Exchange exchange){
      exchange.getIn().setBody("<hello>world</hello>");
    }
  }
);
  org.apache.camel.Message out=exchange.getOut();
  log.info("Received output message: " + out);
}
