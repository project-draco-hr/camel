{
  final AtomicInteger counter=new AtomicInteger();
  getMockEndpoint("mock:split").whenAnyExchangeReceived(new Processor(){
    @Override public void process(    Exchange exchange) throws Exception {
      counter.incrementAndGet();
    }
  }
);
  NotifyBuilder notify=new NotifyBuilder(context).whenDoneByIndex(0).create();
  assertEquals(false,notify.matches());
  template.sendBody("seda:foo","A,B,C");
  assertEquals(true,notify.matchesMockWaitTime());
  assertEquals(3,counter.get());
}
