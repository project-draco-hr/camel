{
  int files=10;
  int rows=100000;
  int batches=rows / 1000;
  int total=files + (files * rows) + (files * batches);
  LOG.info("There are " + total + " exchanges");
  NotifyBuilder notify=new NotifyBuilder(context).whenDone(total).create();
  LOG.info("Writing 10 files with 100000 rows in each file");
  for (int i=0; i < files; i++) {
    Writer out=new BufferedWriter(new FileWriter(new File("target/files","data" + i)));
    for (int j=0; j < rows; j++) {
      out.write(DATA);
    }
    out.close();
  }
  StopWatch watch=new StopWatch();
  context.startRoute("foo");
  LOG.info("Waiting to process all the files");
  boolean matches=notify.matches(3,TimeUnit.MINUTES);
  LOG.info("Should process all files " + matches);
  LOG.info("Time taken " + watch.taken() + " ms");
}
