{
  HBaseRow rowModel=new HBaseRow();
  if (parameters.containsKey(HBaseAttribute.HBASE_ROW_TYPE.asOption())) {
    String rowType=String.valueOf(parameters.remove(HBaseAttribute.HBASE_ROW_TYPE.asOption()));
    if (rowType != null && !rowType.isEmpty()) {
      rowModel.setRowType(getCamelContext().getClassResolver().resolveClass(rowType));
    }
  }
  for (int i=1; parameters.get(HBaseAttribute.HBASE_FAMILY.asOption(i)) != null && parameters.get(HBaseAttribute.HBASE_QUALIFIER.asOption(i)) != null; i++) {
    HBaseCell cellModel=new HBaseCell();
    cellModel.setFamily(String.valueOf(parameters.remove(HBaseAttribute.HBASE_FAMILY.asOption(i))));
    cellModel.setQualifier(String.valueOf(parameters.remove(HBaseAttribute.HBASE_QUALIFIER.asOption(i))));
    cellModel.setValue(String.valueOf(parameters.remove(HBaseAttribute.HBASE_VALUE.asOption(i))));
    if (parameters.containsKey(HBaseAttribute.HBASE_VALUE_TYPE.asOption(i))) {
      String valueType=String.valueOf(parameters.remove(HBaseAttribute.HBASE_VALUE_TYPE.asOption(i)));
      if (valueType != null && !valueType.isEmpty()) {
        rowModel.setRowType(getCamelContext().getClassResolver().resolveClass(valueType));
      }
    }
    rowModel.getCells().add(cellModel);
  }
  return rowModel;
}
