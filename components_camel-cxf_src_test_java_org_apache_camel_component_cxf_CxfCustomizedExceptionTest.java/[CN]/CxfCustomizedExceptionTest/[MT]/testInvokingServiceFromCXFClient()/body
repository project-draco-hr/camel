{
  ClientProxyFactoryBean proxyFactory=new ClientProxyFactoryBean();
  ClientFactoryBean clientBean=proxyFactory.getClientFactoryBean();
  clientBean.setAddress(ROUTER_ADDRESS);
  clientBean.setServiceClass(HelloService.class);
  clientBean.setBus(bus);
  HelloService client=(HelloService)proxyFactory.create();
  try {
    client.echo("hello world");
    fail("Expect to get an exception here");
  }
 catch (  Exception e) {
    assertEquals("Expect to get right exception message",EXCEPTION_MESSAGE,e.getMessage());
    assertTrue("Exception is not instance of SoapFault",e instanceof SoapFault);
    assertEquals("Expect to get right detail message",DETAIL_TEXT,((SoapFault)e).getDetail().getTextContent());
    assertEquals("Expect to get right fault-code","{http://schemas.xmlsoap.org/soap/envelope/}Client",((SoapFault)e).getFaultCode().toString());
  }
}
