{
  LOG.info("Get the bundleContext is " + bundleContext);
  LOG.info("Application installed as bundle id: " + bundleContext.getBundle().getBundleId());
  setThreadContextClassLoader();
  CamelContextFactory factory=new CamelContextFactory();
  factory.setBundleContext(bundleContext);
  SimpleRegistry registry=new SimpleRegistry();
  registry.put("mylogger1",LoggerFactory.getLogger("org.apache.camel.SIFT.l1"));
  registry.put("mylogger2",LoggerFactory.getLogger("org.apache.camel.SIFT.l2"));
  factory.setRegistry(registry);
  CamelContext camelContext=factory.createContext();
  camelContext.setApplicationContextClassLoader(getClass().getClassLoader());
  camelContext.setUseMDCLogging(true);
  return camelContext;
}
