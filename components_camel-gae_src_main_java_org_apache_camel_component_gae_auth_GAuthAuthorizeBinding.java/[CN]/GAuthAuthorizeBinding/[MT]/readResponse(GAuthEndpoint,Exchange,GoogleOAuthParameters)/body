{
  String authrUrl=endpoint.newOAuthHelper().createUserAuthorizationUrl(response);
  exchange.getOut().setHeaders(exchange.getIn().getHeaders());
  exchange.getOut().setHeader(Exchange.HTTP_RESPONSE_CODE,302);
  exchange.getOut().setHeader("Location",authrUrl);
  if (endpoint.getComponent().getKeyLoader() == null) {
    String secret=response.getOAuthTokenSecret();
    String cookie=new GAuthTokenSecret(secret).toCookie();
    exchange.getOut().setHeader("Set-Cookie",cookie);
  }
  return exchange;
}
