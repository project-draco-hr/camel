{
  String dataSourceRef=getAndRemoveParameter(parameters,"dataSourceRef",String.class);
  if (dataSourceRef != null) {
    dataSource=mandatoryLookup(dataSourceRef,DataSource.class);
  }
  return new SqlEndpoint(uri,remaining.replaceAll("#","?"),this,dataSource,parameters);
}
