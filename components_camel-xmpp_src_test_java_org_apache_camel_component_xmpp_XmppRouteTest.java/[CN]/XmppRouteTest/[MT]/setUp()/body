{
  if (isXmppServerPresent()) {
    String uriPrefx=getUriPrefix();
    final String uri1=uriPrefx + "a";
    final String uri2=uriPrefx + "b";
    LOG.info("Using URI " + uri1 + " and "+ uri2);
    container.addRoutes(new RouteBuilder(){
      public void configure(){
        from(uri1).to(uri2);
        from(uri2).process(new Processor(){
          public void process(          Exchange e){
            LOG.info("Received exchange: " + e);
            receivedExchange=(XmppExchange)e;
            latch.countDown();
          }
        }
);
      }
    }
);
    endpoint=container.getEndpoint(uri1);
    assertNotNull("No endpoint found!",endpoint);
  }
  container.start();
}
