{
  LoggingLevel level=getLoggingLevel(parameters);
  Integer groupSize=getAndRemoveParameter(parameters,"groupSize",Integer.class);
  Logger logger;
  if (groupSize != null) {
    logger=new ThroughputLogger(remaining,level,groupSize);
  }
 else {
    LogFormatter formatter=new LogFormatter();
    IntrospectionSupport.setProperties(formatter,parameters);
    logger=new Logger(remaining);
    logger.setLevel(level);
    logger.setFormatter(formatter);
  }
  LogEndpoint endpoint=new LogEndpoint(uri,this);
  setProperties(endpoint,parameters);
  return new LogEndpoint(uri,this,logger);
}
