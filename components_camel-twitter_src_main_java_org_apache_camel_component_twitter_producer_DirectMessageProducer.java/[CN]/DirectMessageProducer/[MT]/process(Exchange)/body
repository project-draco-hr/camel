{
  String toUsername=te.getProperties().getUser();
  if (ObjectHelper.isNotEmpty(exchange.getIn().getHeader(TwitterConstants.TWITTER_USER,String.class))) {
    toUsername=exchange.getIn().getHeader(TwitterConstants.TWITTER_USER,String.class);
  }
  String text=exchange.getIn().getBody(String.class);
  if (toUsername.isEmpty()) {
    throw new CamelExchangeException("Username not configured on TwitterEndpoint",exchange);
  }
 else {
    log.debug("Sending to: {} message: {}",toUsername,text);
    te.getProperties().getTwitter().sendDirectMessage(toUsername,text);
  }
}
