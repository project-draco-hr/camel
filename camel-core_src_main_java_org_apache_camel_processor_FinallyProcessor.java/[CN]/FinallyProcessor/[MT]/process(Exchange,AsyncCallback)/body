{
  final Exception e=exchange.getException();
  exchange.setException(null);
  if (e != null) {
    exchange.setProperty(Exchange.EXCEPTION_CAUGHT,e);
  }
  if (exchange.getProperty(Exchange.FAILURE_ENDPOINT) == null) {
    exchange.setProperty(Exchange.FAILURE_ENDPOINT,exchange.getProperty(Exchange.TO_ENDPOINT));
  }
  boolean sync=processor.process(exchange,new AsyncCallback(){
    public void done(    boolean doneSync){
      if (e == null) {
        exchange.removeProperty(Exchange.FAILURE_ENDPOINT);
      }
 else {
        exchange.setException(e);
        exchange.setProperty(Exchange.EXCEPTION_CAUGHT,e);
      }
      if (!doneSync) {
        ExchangeHelper.prepareOutToIn(exchange);
        LOG.trace("Processing complete for exchangeId: {} >>> {}",exchange.getExchangeId(),exchange);
      }
      callback.done(doneSync);
    }
  }
);
  return sync;
}
