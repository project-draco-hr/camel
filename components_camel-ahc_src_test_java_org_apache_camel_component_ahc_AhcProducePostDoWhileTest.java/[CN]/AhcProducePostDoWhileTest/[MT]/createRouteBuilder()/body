{
  return new RouteBuilder(){
    @Override public void configure() throws Exception {
      from("direct:start").streamCaching().loopDoWhile(body().isNotEqualTo("done")).to(getAhcEndpointUri()).to("mock:line").filter(exchangeProperty(Exchange.LOOP_INDEX).isEqualTo(3)).setBody().constant("done").end().end().to("mock:result");
      from(getTestServerEndpointUri()).transform(simple("Bye ${body}"));
    }
  }
;
}
