{
  if (isFixed()) {
    Resource resource=getDefinition();
    ObjectHelper.notNull(resource,"resource");
    return getParserFactory().newFixedLengthParser(new InputStreamReader(resource.getInputStream(),IOConverter.getCharsetName(exchange)),bodyReader);
  }
 else {
    Resource resource=getDefinition();
    if (resource == null) {
      return getParserFactory().newDelimitedParser(bodyReader,delimiter,textQualifier);
    }
 else {
      return getParserFactory().newDelimitedParser(new InputStreamReader(resource.getInputStream(),IOConverter.getCharsetName(exchange)),bodyReader,delimiter,textQualifier,ignoreFirstRecord);
    }
  }
}
