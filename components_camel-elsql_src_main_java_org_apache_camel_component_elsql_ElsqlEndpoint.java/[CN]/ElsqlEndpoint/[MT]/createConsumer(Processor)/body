{
  SqlProcessingStrategy proStrategy=new ElsqlSqlProcessingStrategy(elsqlName,elSql);
  SqlPrepareStatementStrategy preStategy=new ElsqlSqlPrepareStatementStrategy();
  JdbcTemplate template=new JdbcTemplate(getDataSource());
  ElsqlConsumer consumer=new ElsqlConsumer(this,processor,template,elsqlName,preStategy,proStrategy);
  consumer.setMaxMessagesPerPoll(getMaxMessagesPerPoll());
  consumer.setOnConsume(getOnConsume());
  consumer.setOnConsumeFailed(getOnConsumeFailed());
  consumer.setOnConsumeBatchComplete(getOnConsumeBatchComplete());
  consumer.setBreakBatchOnConsumeFail(isBreakBatchOnConsumeFail());
  consumer.setExpectedUpdateCount(getExpectedUpdateCount());
  consumer.setUseIterator(isUseIterator());
  consumer.setRouteEmptyResultSet(isRouteEmptyResultSet());
  configureConsumer(consumer);
  return consumer;
}
