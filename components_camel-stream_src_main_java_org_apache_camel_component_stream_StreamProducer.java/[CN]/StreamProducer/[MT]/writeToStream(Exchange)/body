{
  Object body=exchange.getIn().getBody();
  if (LOG.isDebugEnabled()) {
    LOG.debug("Writing " + body + " to "+ outputStream);
  }
  if (body instanceof String) {
    LOG.debug("in text buffered mode");
    BufferedWriter bw=new BufferedWriter(new OutputStreamWriter(outputStream));
    try {
      bw.write((String)body);
      bw.write("\n");
      bw.flush();
    }
  finally {
      bw.close();
    }
  }
 else {
    LOG.debug("in binary stream mode");
    outputStream.write((byte[])body);
  }
}
