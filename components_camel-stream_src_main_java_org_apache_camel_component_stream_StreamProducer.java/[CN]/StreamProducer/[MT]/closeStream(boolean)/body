{
  if (outputStream == null) {
    return;
  }
  boolean systemStream=outputStream != System.out || outputStream != System.err;
  boolean headerStream="header".equals(uri) && !systemStream;
  boolean reachedLimit=endpoint.getAutoCloseCount() > 0 && count.decrementAndGet() <= 0;
  boolean expiredStream=force || headerStream || reachedLimit;
  if (expiredStream) {
    outputStream.close();
    outputStream=null;
    LOG.debug("Closed stream '{}'",endpoint.getEndpointKey());
  }
}
