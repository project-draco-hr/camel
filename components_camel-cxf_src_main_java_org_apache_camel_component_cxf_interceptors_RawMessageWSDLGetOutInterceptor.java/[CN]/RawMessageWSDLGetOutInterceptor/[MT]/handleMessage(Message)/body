{
  Document doc=(Document)message.get(RawMessageWSDLGetInterceptor.DOCUMENT_HOLDER);
  if (doc == null) {
    return;
  }
  message.remove(RawMessageWSDLGetInterceptor.DOCUMENT_HOLDER);
  OutputStream out=message.getContent(OutputStream.class);
  String enc=null;
  try {
    enc=doc.getXmlEncoding();
  }
 catch (  Exception ex) {
  }
  if (enc == null) {
    enc="utf-8";
  }
  XMLStreamWriter writer=StaxUtils.createXMLStreamWriter(out,enc);
  try {
    StaxUtils.writeNode(doc,writer,true);
    writer.flush();
  }
 catch (  XMLStreamException e) {
    throw new Fault(e);
  }
}
