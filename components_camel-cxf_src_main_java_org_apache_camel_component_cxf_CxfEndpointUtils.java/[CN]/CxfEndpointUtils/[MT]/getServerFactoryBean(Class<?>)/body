{
  ServerFactoryBean serverFactory=null;
  try {
    if (cls == null) {
      serverFactory=new ServerFactoryBean();
      serverFactory.setServiceFactory(new WSDLSoapServiceFactoryBean());
    }
 else {
      boolean isJSR181SEnabled=CxfEndpointUtils.hasWebServiceAnnotation(cls);
      serverFactory=isJSR181SEnabled ? new JaxWsServerFactoryBean() : new ServerFactoryBean();
    }
    return serverFactory;
  }
 catch (  Exception e) {
    throw new CamelException(e);
  }
}
