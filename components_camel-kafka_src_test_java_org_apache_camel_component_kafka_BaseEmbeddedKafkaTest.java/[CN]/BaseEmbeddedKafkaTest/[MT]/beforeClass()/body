{
  zookeeperPort=AvailablePortFinder.getNextAvailable(23000);
  karfkaPort=AvailablePortFinder.getNextAvailable(24000);
  embeddedZookeeper=new EmbeddedZookeeper(zookeeperPort);
  List<Integer> kafkaPorts=new ArrayList<Integer>();
  kafkaPorts.add(karfkaPort);
  embeddedKafkaCluster=new EmbeddedKafkaCluster(embeddedZookeeper.getConnection(),new Properties(),kafkaPorts);
  try {
    embeddedZookeeper.startup();
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
  LOG.info("Embedded Zookeeper connection: " + embeddedZookeeper.getConnection());
  embeddedKafkaCluster.startup();
  LOG.info("Embedded Kafka cluster broker list: " + embeddedKafkaCluster.getBrokerList());
}
