{
  ensureFolderIsOpen();
  int count=folder.getMessageCount();
  if (count > 0) {
    Message message=folder.getMessage(1);
    processMessage(message);
    flagMessageDeleted(message);
  }
 else   if (count == -1) {
    throw new MessagingException("Folder: " + folder.getFullName() + " is closed");
  }
  folder.close(true);
}
