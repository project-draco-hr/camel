{
  Object[] params=null;
  if (endpoint.getDataFormat() == DataFormat.POJO) {
    List<?> list=exchange.getIn().getBody(List.class);
    if (list != null) {
      params=list.toArray();
    }
 else {
      Iterator it=exchange.getIn().getBody(Iterator.class);
      if (it != null && it.hasNext()) {
        list=exchange.getContext().getTypeConverter().convertTo(List.class,it);
        if (list != null) {
          params=list.toArray();
        }
      }
      if (params == null) {
        params=new Object[1];
        params[0]=exchange.getIn().getBody();
      }
    }
    checkParameterSize(endpoint,exchange,params);
  }
 else   if (endpoint.getDataFormat() == DataFormat.PAYLOAD) {
    params=new Object[1];
    params[0]=exchange.getIn().getMandatoryBody(CxfPayload.class);
  }
 else   if (endpoint.getDataFormat() == DataFormat.MESSAGE) {
    params=new Object[1];
    params[0]=exchange.getIn().getMandatoryBody(InputStream.class);
  }
  if (LOG.isTraceEnabled()) {
    if (params != null) {
      for (int i=0; i < params.length; i++) {
        LOG.trace("params[" + i + "] = "+ params[i]);
      }
    }
  }
  return params;
}
