{
  Bus bus=BusFactory.getDefaultBus();
  if (endpoint.isSpringContextEndpoint()) {
    CxfEndpointBean endpointBean=endpoint.getCxfEndpointBean();
    if (cfb == null) {
      cfb=CxfEndpointUtils.getClientFactoryBean(endpointBean.getServiceClass());
    }
    endpoint.configure(cfb);
    CxfEndpointBean cxfEndpointBean=endpoint.getCxfEndpointBean();
    if (cxfEndpointBean.getServiceName() != null) {
      cfb.setServiceName(cxfEndpointBean.getServiceName());
    }
    if (cxfEndpointBean.getEndpointName() != null) {
      cfb.setEndpointName(cxfEndpointBean.getEndpointName());
    }
  }
 else {
    if (null != endpoint.getServiceClass()) {
      try {
        Class serviceClass=ClassLoaderUtils.loadClass(endpoint.getServiceClass(),this.getClass());
        if (cfb == null) {
          cfb=CxfEndpointUtils.getClientFactoryBean(serviceClass);
        }
        cfb.setAddress(endpoint.getAddress());
        if (null != endpoint.getServiceClass()) {
          cfb.setServiceClass(ObjectHelper.loadClass(endpoint.getServiceClass()));
        }
        if (null != endpoint.getWsdlURL()) {
          cfb.setWsdlURL(endpoint.getWsdlURL());
        }
      }
 catch (      ClassNotFoundException e) {
        throw new CamelException(e);
      }
    }
 else {
      if (cfb == null) {
        cfb=new ClientFactoryBean();
      }
      if (null != endpoint.getWsdlURL()) {
        cfb.setWsdlURL(endpoint.getWsdlURL());
      }
 else {
        throw new CamelException("Insufficiency of the endpoint info");
      }
    }
    if (endpoint.getServiceName() != null) {
      cfb.setServiceName(CxfEndpointUtils.getServiceName(endpoint));
    }
    if (endpoint.getPortName() != null) {
      cfb.setEndpointName(CxfEndpointUtils.getPortName(endpoint));
    }
    if (endpoint.getWsdlURL() != null) {
      cfb.setWsdlURL(endpoint.getWsdlURL());
    }
  }
  cfb.setBus(bus);
  return cfb.create();
}
