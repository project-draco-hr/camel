{
  TypedRddCallback rddCallback=new TypedRddCallback<Long>(context,new Class[]{int.class,int.class}){
    @Override public Long doOnRdd(    AbstractJavaRDDLike rdd,    Object... payloads){
      return rdd.count() * (int)payloads[0] * (int)payloads[1];
    }
  }
;
  long pomLinesCount=template.requestBodyAndHeader(sparkUri,asList("10","10"),SPARK_RDD_CALLBACK_HEADER,rddCallback,Long.class);
  Truth.assertThat(pomLinesCount).isEqualTo(1900);
}
