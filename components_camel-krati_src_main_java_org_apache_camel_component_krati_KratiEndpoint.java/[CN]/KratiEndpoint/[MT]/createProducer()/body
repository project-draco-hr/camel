{
  DataStore<Object,Object> dataStore=null;
  KratiDataStoreRegistration registration=dataStoreRegistry.get(path);
  if (registration != null) {
    dataStore=registration.getDataStore();
  }
  if (dataStore == null || !dataStore.isOpen()) {
    dataStore=KratiHelper.<Object,Object>createDataStore(path,initialCapacity,segmentFileSize,segmentFactory,hashFunction,keySerializer,valueSerializer);
    dataStoreRegistry.put(path,new KratiDataStoreRegistration(dataStore));
  }
  return new KratiProducer(this,dataStore);
}
