{
  Map<String,List<KafkaStream<byte[],byte[]>>> consumerMap=kafkaConsumer.createMessageStreams(topicCountMap);
  ExecutorService executor=Executors.newFixedThreadPool(10);
  for (  final KafkaStream stream : consumerMap.get(TOPIC)) {
    executor.submit(new KakfaTopicConsumer(stream,messagesLatch));
  }
  for (  final KafkaStream stream : consumerMap.get(TOPIC_IN_HEADER)) {
    executor.submit(new KakfaTopicConsumer(stream,messagesLatch));
  }
}
