{
  MockEndpoint result=getMockEndpoint("mock:result");
  result.expectedMessageCount(2);
  template.sendBodyAndHeader("direct:start","100","groupSize",3);
  template.sendBodyAndHeader("direct:start","150","groupSize",3);
  template.sendBodyAndHeader("direct:start","130","groupSize",3);
  template.sendBodyAndHeader("direct:start","200","groupSize",2);
  template.sendBodyAndHeader("direct:start","190","groupSize",2);
  assertMockEndpointsSatisfied();
  Exchange out=result.getExchanges().get(0);
  List<Exchange> grouped=out.getProperty(Exchange.GROUPED_EXCHANGE,List.class);
  assertEquals(3,grouped.size());
  assertEquals("100",grouped.get(0).getIn().getBody(String.class));
  assertEquals("150",grouped.get(1).getIn().getBody(String.class));
  assertEquals("130",grouped.get(2).getIn().getBody(String.class));
  out=result.getExchanges().get(1);
  grouped=out.getProperty(Exchange.GROUPED_EXCHANGE,List.class);
  assertEquals(2,grouped.size());
  assertEquals("200",grouped.get(0).getIn().getBody(String.class));
  assertEquals("190",grouped.get(1).getIn().getBody(String.class));
}
