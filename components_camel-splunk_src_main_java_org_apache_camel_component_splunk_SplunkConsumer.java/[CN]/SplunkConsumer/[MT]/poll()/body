{
  try {
    List<SplunkEvent> events=dataReader.read();
    Queue<Exchange> exchanges=createExchanges(events);
    return processBatch(CastUtils.cast(exchanges));
  }
 catch (  Exception e) {
    if (endpoint.reconnectIfPossible(e)) {
      return 0;
    }
 else {
      getExceptionHandler().handleException(e);
      return 0;
    }
  }
}
