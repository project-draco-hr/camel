{
  try {
    List<SplunkEvent> events=dataReader.read();
    Queue<Exchange> exchanges=createExchanges(events);
    return processBatch(CastUtils.cast(exchanges));
  }
 catch (  Exception e) {
    endpoint.reset(e);
    getExceptionHandler().handleException(e);
    return 0;
  }
}
