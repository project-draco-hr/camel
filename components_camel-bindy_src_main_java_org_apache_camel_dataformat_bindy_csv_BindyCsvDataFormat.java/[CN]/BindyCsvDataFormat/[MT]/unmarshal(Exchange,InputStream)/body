{
  BindyCsvFactory factory=getFactory(exchange.getContext().getPackageScanClassResolver());
  List<Map<String,Object>> models=new ArrayList<Map<String,Object>>();
  Map<String,Object> model=factory.factory();
  InputStreamReader in=new InputStreamReader(inputStream);
  Scanner scanner=new Scanner(in);
  String separator=factory.getSeparator();
  ObjectHelper.notEmpty(separator,"The separator has not been defined in the annotation @Record or not instantiated during initModel.");
  int count=0;
  try {
    if (factory.getSkipFirstLine()) {
      scanner.nextLine();
    }
    while (scanner.hasNextLine()) {
      String line=scanner.nextLine().trim();
      if (ObjectHelper.isEmpty(line)) {
        continue;
      }
      if (LOG.isDebugEnabled()) {
        LOG.debug("Counter " + count++ + " : content : "+ line);
      }
      List<String> result=Arrays.asList(line.split(separator));
      factory.bind(result,model);
      factory.link(model);
      models.add(model);
      if (LOG.isDebugEnabled()) {
        LOG.debug("Graph of objects created : " + model);
      }
    }
    return models;
  }
  finally {
    scanner.close();
    ObjectHelper.close(in,"in",LOG);
  }
}
