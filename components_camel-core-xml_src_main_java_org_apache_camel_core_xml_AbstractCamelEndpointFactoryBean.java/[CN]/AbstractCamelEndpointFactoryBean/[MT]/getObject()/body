{
  if (endpoint == null || !endpoint.isSingleton()) {
    if (context == null && camelContextId != null) {
      context=getCamelContextWithId(camelContextId);
    }
    notNull(context,"context");
    notNull(uri,"uri");
    endpoint=context.getEndpoint(uri);
    if (endpoint == null) {
      throw new NoSuchEndpointException(uri);
    }
  }
  return endpoint;
}
