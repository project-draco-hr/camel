{
  super(endpoint,processor);
  this.endpoint=endpoint;
  this.processor=processor;
  this.consumerBarriers=new HashMap<ConsumerConnector,CyclicBarrier>();
  if (endpoint.getZookeeperConnect() == null) {
    throw new IllegalArgumentException("zookeeper host or zookeeper connect must be specified");
  }
  if (endpoint.getGroupId() == null) {
    throw new IllegalArgumentException("groupId must not be null");
  }
}
