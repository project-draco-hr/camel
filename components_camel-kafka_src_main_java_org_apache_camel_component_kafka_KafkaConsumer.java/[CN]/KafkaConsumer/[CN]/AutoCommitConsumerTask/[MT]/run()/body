{
  ConsumerIterator<byte[],byte[]> it=stream.iterator();
  while (isRunAllowed() && !isSuspendingOrSuspended() && it.hasNext()) {
    MessageAndMetadata<byte[],byte[]> mm=it.next();
    Exchange exchange=endpoint.createKafkaExchange(mm);
    try {
      processor.process(exchange);
    }
 catch (    Exception e) {
      getExceptionHandler().handleException("Error during processing",exchange,e);
    }
  }
  LOG.debug("Commit offsets on consumer: {}",ObjectHelper.getIdentityHashCode(consumer));
  consumer.commitOffsets();
}
