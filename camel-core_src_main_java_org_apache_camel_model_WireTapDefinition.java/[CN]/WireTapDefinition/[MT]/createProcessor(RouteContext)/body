{
  Endpoint endpoint=resolveEndpoint(routeContext);
  executorService=ExecutorServiceHelper.getConfiguredExecutorService(routeContext,this);
  if (executorService == null) {
    executorService=routeContext.getCamelContext().getExecutorServiceStrategy().newCachedThreadPool(this,"WireTap");
  }
  WireTapProcessor answer=new WireTapProcessor(endpoint,getPattern(),executorService);
  if (newExchangeProcessorRef != null) {
    newExchangeProcessor=routeContext.lookup(newExchangeProcessorRef,Processor.class);
  }
  answer.setNewExchangeProcessor(newExchangeProcessor);
  if (newExchangeExpression != null) {
    answer.setNewExchangeExpression(newExchangeExpression.createExpression(routeContext));
  }
  return answer;
}
