{
  context.addRoutes(new RouteBuilder(){
    @Override public void configure() throws Exception {
      NewFileEndpoint endpoint=new NewFileEndpoint();
      endpoint.setCamelContext(context);
      endpoint.setFile(new File("target/filelanguage/report5.txt"));
      endpoint.setOperations(new NewFileOperations(endpoint));
      endpoint.setDirectory(false);
      endpoint.setAutoCreate(false);
      endpoint.setExpression(BeanLanguage.bean("myguidgenerator"));
      from(endpoint).to("mock:result");
    }
  }
);
  context.start();
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedBodiesReceived("Bean Language Rules The World");
  template.sendBodyAndHeader("newfile://target/filelanguage/","Bean Language Rules The World",NewFileComponent.HEADER_FILE_NAME,"report5.txt");
  assertMockEndpointsSatisfied();
  Thread.sleep(200);
  File file=new File("target/filelanguage/123");
  file=file.getAbsoluteFile();
  assertTrue("File should have been renamed",file.exists());
}
