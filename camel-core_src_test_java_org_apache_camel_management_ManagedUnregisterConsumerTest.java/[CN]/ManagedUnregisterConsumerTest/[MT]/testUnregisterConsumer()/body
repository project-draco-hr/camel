{
  MBeanServer mbeanServer=context.getManagementStrategy().getManagementAgent().getMBeanServer();
  Set<ObjectName> set=mbeanServer.queryNames(new ObjectName("*:type=consumers,*"),null);
  assertEquals(1,set.size());
  ObjectName on=set.iterator().next();
  assertTrue("Should be registered",mbeanServer.isRegistered(on));
  String uri=(String)mbeanServer.getAttribute(on,"EndpointUri");
  assertEquals("direct://start",uri);
  String routeId=(String)mbeanServer.getAttribute(on,"RouteId");
  assertEquals("route1",routeId);
  String camelId=(String)mbeanServer.getAttribute(on,"CamelId");
  assertEquals("camel-1",camelId);
  String state=(String)mbeanServer.getAttribute(on,"State");
  assertEquals(ServiceStatus.Started.name(),state);
  context.stop();
  assertFalse("Should no longer be registered",mbeanServer.isRegistered(on));
}
