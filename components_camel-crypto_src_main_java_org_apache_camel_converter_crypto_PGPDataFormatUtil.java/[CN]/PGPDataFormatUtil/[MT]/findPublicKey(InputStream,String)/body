{
  PGPPublicKeyRingCollection pgpSec=new PGPPublicKeyRingCollection(PGPUtil.getDecoderStream(input));
  @SuppressWarnings("unchecked") Iterator<PGPPublicKeyRing> keyRingIter=(Iterator<PGPPublicKeyRing>)pgpSec.getKeyRings();
  while (keyRingIter.hasNext()) {
    PGPPublicKeyRing keyRing=keyRingIter.next();
    @SuppressWarnings("unchecked") Iterator<PGPPublicKey> keyIter=(Iterator<PGPPublicKey>)keyRing.getPublicKeys();
    while (keyIter.hasNext()) {
      PGPPublicKey key=(PGPPublicKey)keyIter.next();
      for (@SuppressWarnings("unchecked") Iterator<String> iterator=(Iterator<String>)key.getUserIDs(); iterator.hasNext(); ) {
        String userId=iterator.next();
        if (key.isEncryptionKey() && userId.contains(userid)) {
          return key;
        }
      }
    }
  }
  return null;
}
