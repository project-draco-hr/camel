{
  PGPPublicKeyRingCollection pgpSec=new PGPPublicKeyRingCollection(PGPUtil.getDecoderStream(input));
  Iterator<PGPPublicKeyRing> keyRingIter=(Iterator<PGPPublicKeyRing>)pgpSec.getKeyRings();
  while (keyRingIter.hasNext()) {
    PGPPublicKeyRing keyRing=keyRingIter.next();
    Iterator<PGPPublicKey> keyIter=(Iterator<PGPPublicKey>)keyRing.getPublicKeys();
    String keyUserId=null;
    while (keyIter.hasNext()) {
      PGPPublicKey key=keyIter.next();
      for (Iterator<String> iterator=(Iterator<String>)key.getUserIDs(); iterator.hasNext(); ) {
        keyUserId=iterator.next();
      }
      if (key.isEncryptionKey() && keyUserId != null && keyUserId.contains(userid)) {
        return key;
      }
    }
  }
  return null;
}
