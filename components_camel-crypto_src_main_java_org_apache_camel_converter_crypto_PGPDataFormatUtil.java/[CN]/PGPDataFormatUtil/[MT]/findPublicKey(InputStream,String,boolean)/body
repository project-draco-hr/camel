{
  PGPPublicKeyRingCollection pgpSec=new PGPPublicKeyRingCollection(PGPUtil.getDecoderStream(input));
  Iterator<PGPPublicKeyRing> keyRingIter=pgpSec.getKeyRings();
  while (keyRingIter.hasNext()) {
    PGPPublicKeyRing keyRing=keyRingIter.next();
    Iterator<PGPPublicKey> keyIter=keyRing.getPublicKeys();
    String keyUserId=null;
    while (keyIter.hasNext()) {
      PGPPublicKey key=keyIter.next();
      for (Iterator<String> iterator=key.getUserIDs(); iterator.hasNext(); ) {
        keyUserId=iterator.next();
      }
      if (keyUserId != null && keyUserId.contains(userid)) {
        if (forEncryption && key.isEncryptionKey()) {
          return key;
        }
 else         if (!forEncryption && isSignatureKey(key)) {
          return key;
        }
      }
    }
  }
  return null;
}
