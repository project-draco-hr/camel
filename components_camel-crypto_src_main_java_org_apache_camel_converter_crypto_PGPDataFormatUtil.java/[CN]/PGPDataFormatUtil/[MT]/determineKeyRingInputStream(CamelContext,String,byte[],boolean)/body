{
  if (filename != null && keyRing != null) {
    String encryptionOrSignature;
    if (forEncryption) {
      encryptionOrSignature="encryption";
    }
 else {
      encryptionOrSignature="signature";
    }
    throw new IllegalStateException(String.format("Either specify %s file name or key ring byte array. You can not specify both.",encryptionOrSignature));
  }
  InputStream is;
  if (keyRing != null) {
    is=new ByteArrayInputStream(keyRing);
  }
 else {
    is=ResourceHelper.resolveMandatoryResourceAsInputStream(context.getClassResolver(),filename);
  }
  return is;
}
