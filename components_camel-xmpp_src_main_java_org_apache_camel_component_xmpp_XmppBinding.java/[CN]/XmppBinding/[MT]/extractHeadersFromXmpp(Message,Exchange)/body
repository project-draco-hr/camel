{
  Map<String,Object> answer=new HashMap<String,Object>();
  for (  String name : xmppMessage.getPropertyNames()) {
    Object value=xmppMessage.getProperty(name);
    if (!headerFilterStrategy.applyFilterToExternalHeaders(name,value,exchange)) {
      answer.put(name,value);
    }
  }
  answer.put(XmppConstants.MESSAGE_TYPE,xmppMessage.getType());
  answer.put(XmppConstants.SUBJECT,xmppMessage.getSubject());
  answer.put(XmppConstants.THREAD_ID,xmppMessage.getThread());
  answer.put(XmppConstants.FROM,xmppMessage.getFrom());
  answer.put(XmppConstants.PACKET_ID,xmppMessage.getPacketID());
  answer.put(XmppConstants.TO,xmppMessage.getTo());
  return answer;
}
