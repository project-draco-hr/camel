{
  getMockEndpoint("mock:error").expectedBodiesReceived("Kaboom");
  getMockEndpoint("mock:start").expectedBodiesReceived("Kaboom","World","Kaboom");
  getMockEndpoint("mock:result").expectedBodiesReceived("Bye World");
  getMockEndpoint("mock:exception").expectedBodiesReceived("Kaboom","Kaboom");
  template.sendBody("direct:start","Kaboom");
  template.sendBody("direct:start","World");
  Thread.sleep(1000);
  assertEquals(ServiceStatus.Stopped,context.getRouteStatus("errorRoute"));
  template.sendBody("direct:start","Kaboom");
  assertMockEndpointsSatisfied();
  SedaEndpoint seda=getMandatoryEndpoint("seda:error",SedaEndpoint.class);
  SedaEndpoint seda2=getMandatoryEndpoint("seda:error2",SedaEndpoint.class);
  int size=seda.getQueue().size();
  int size2=seda2.getQueue().size();
  assertTrue("There should be 1 exchange on the seda or seda2 queue",size == 1 || size2 == 1);
}
