{
  Elements elementUtils=processingEnv.getElementUtils();
  while (true) {
    List<VariableElement> fieldElements=ElementFilter.fieldsIn(classElement.getEnclosedElements());
    for (    VariableElement fieldElement : fieldElements) {
      Metadata metadata=fieldElement.getAnnotation(Metadata.class);
      boolean deprecated=fieldElement.getAnnotation(Deprecated.class) != null;
      UriPath path=fieldElement.getAnnotation(UriPath.class);
      String fieldName=fieldElement.getSimpleName().toString();
      if (path != null) {
        String name=path.name();
        if (isNullOrEmpty(name)) {
          name=fieldName;
        }
        name=prefix + name;
        String label=path.label();
        String required=metadata != null ? metadata.required() : null;
        TypeMirror fieldType=fieldElement.asType();
        String fieldTypeName=fieldType.toString();
        TypeElement fieldTypeElement=findTypeElement(roundEnv,fieldTypeName);
        String docComment=findJavaDoc(elementUtils,fieldElement,fieldName,name,classElement,false);
        if (isNullOrEmpty(docComment)) {
          docComment=path.description();
        }
        Set<String> enums=new LinkedHashSet<String>();
        boolean isEnum;
        if (!Strings.isNullOrEmpty(path.enums())) {
          isEnum=true;
          String[] values=path.enums().split(",");
          for (          String val : values) {
            enums.add(val);
          }
        }
 else {
          isEnum=fieldTypeElement != null && fieldTypeElement.getKind() == ElementKind.ENUM;
          if (isEnum) {
            TypeElement enumClass=findTypeElement(roundEnv,fieldTypeElement.asType().toString());
            List<VariableElement> fields=ElementFilter.fieldsIn(enumClass.getEnclosedElements());
            for (            VariableElement var : fields) {
              if (var.getKind() == ElementKind.ENUM_CONSTANT) {
                String val=var.toString();
                enums.add(val);
              }
            }
          }
        }
        EndpointPath ep=new EndpointPath(name,fieldTypeName,required,docComment,deprecated,label,isEnum,enums);
        endpointPaths.add(ep);
      }
      UriParam param=fieldElement.getAnnotation(UriParam.class);
      fieldName=fieldElement.getSimpleName().toString();
      if (param != null) {
        String name=param.name();
        if (isNullOrEmpty(name)) {
          name=fieldName;
        }
        name=prefix + name;
        String defaultValue=param.defaultValue();
        String defaultValueNote=param.defaultValueNote();
        String required=metadata != null ? metadata.required() : null;
        String label=param.label();
        TypeMirror fieldType=fieldElement.asType();
        String fieldTypeName=fieldType.toString();
        TypeElement fieldTypeElement=findTypeElement(roundEnv,fieldTypeName);
        UriParams fieldParams=null;
        if (fieldTypeElement != null) {
          fieldParams=fieldTypeElement.getAnnotation(UriParams.class);
        }
        if (fieldParams != null) {
          String nestedPrefix=prefix;
          String extraPrefix=fieldParams.prefix();
          if (!isNullOrEmpty(extraPrefix)) {
            nestedPrefix+=extraPrefix;
          }
          findClassProperties(writer,roundEnv,endpointPaths,endpointOptions,fieldTypeElement,nestedPrefix);
        }
 else {
          String docComment=findJavaDoc(elementUtils,fieldElement,fieldName,name,classElement,false);
          if (isNullOrEmpty(docComment)) {
            docComment=param.description();
          }
          Set<String> enums=new LinkedHashSet<String>();
          boolean isEnum;
          if (!Strings.isNullOrEmpty(param.enums())) {
            isEnum=true;
            String[] values=param.enums().split(",");
            for (            String val : values) {
              enums.add(val);
            }
          }
 else {
            isEnum=fieldTypeElement != null && fieldTypeElement.getKind() == ElementKind.ENUM;
            if (isEnum) {
              TypeElement enumClass=findTypeElement(roundEnv,fieldTypeElement.asType().toString());
              List<VariableElement> fields=ElementFilter.fieldsIn(enumClass.getEnclosedElements());
              for (              VariableElement var : fields) {
                if (var.getKind() == ElementKind.ENUM_CONSTANT) {
                  String val=var.toString();
                  enums.add(val);
                }
              }
            }
          }
          EndpointOption option=new EndpointOption(name,fieldTypeName,required,defaultValue,defaultValueNote,docComment.trim(),deprecated,label,isEnum,enums);
          endpointOptions.add(option);
        }
      }
    }
    TypeElement baseTypeElement=null;
    TypeMirror superclass=classElement.getSuperclass();
    if (superclass != null) {
      String superClassName=canonicalClassName(superclass.toString());
      baseTypeElement=findTypeElement(roundEnv,superClassName);
    }
    if (baseTypeElement != null) {
      classElement=baseTypeElement;
    }
 else {
      break;
    }
  }
}
