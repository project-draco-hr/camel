{
  client.getParams().setParameter(ConnRoutePNames.DEFAULT_PROXY,new HttpHost(host,port));
  if (username != null && password != null) {
    Credentials defaultcreds;
    if (domain != null) {
      defaultcreds=new NTCredentials(username,password,ntHost,domain);
    }
 else {
      defaultcreds=new UsernamePasswordCredentials(username,password);
    }
    ((DefaultHttpClient)client).getCredentialsProvider().setCredentials(AuthScope.ANY,defaultcreds);
  }
}
