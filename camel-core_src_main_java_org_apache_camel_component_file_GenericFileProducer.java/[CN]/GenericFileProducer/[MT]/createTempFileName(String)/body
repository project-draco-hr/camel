{
  if (fileName != null && System.getProperty("os.name").startsWith("Windows") && fileName.indexOf("/") >= 0) {
    fileName=fileName.replaceAll("/","\\\\");
  }
  int path=fileName.lastIndexOf(File.separator);
  if (path == -1) {
    return endpoint.getTempPrefix() + fileName;
  }
 else {
    StringBuilder sb=new StringBuilder(fileName);
    sb.insert(path + 1,endpoint.getTempPrefix());
    return sb.toString();
  }
}
