{
  String pattern=endpoint.getDoneFileName();
  ObjectHelper.notEmpty(pattern,"doneFileName",endpoint);
  String path=FileUtil.onlyPath(fileName);
  String onlyName=FileUtil.stripPath(fileName);
  pattern=pattern.replaceFirst("\\$\\{file:name\\}",onlyName);
  pattern=pattern.replaceFirst("\\$\\{file:name.noext\\}",FileUtil.stripExt(onlyName));
  if (SimpleLanguage.hasStartToken(pattern)) {
    throw new ExpressionIllegalSyntaxException(fileName + ". Cannot resolve reminder: " + pattern);
  }
  if (ObjectHelper.isNotEmpty(pattern)) {
    return path + File.separator + pattern;
  }
 else {
    return pattern;
  }
}
