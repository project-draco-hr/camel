{
  ArgumentCaptor<KeyedMessage> captor=ArgumentCaptor.forClass(KeyedMessage.class);
  Mockito.verify(producer.producer).send(captor.capture());
  assertEquals(partitionKey,captor.getValue().partitionKey());
  assertEquals(messageKey,captor.getValue().key());
  assertEquals(topic,captor.getValue().topic());
}
