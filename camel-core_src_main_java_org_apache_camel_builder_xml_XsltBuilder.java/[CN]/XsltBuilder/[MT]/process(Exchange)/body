{
  Transformer transformer=getTransformer();
  if (transformer == null) {
    throw new IllegalArgumentException("No transformer configured!");
  }
  configureTransformer(transformer,exchange);
  Source source=getSource(exchange);
  ResultHandler resultHandler=resultHandlerFactory.createResult();
  Result result=resultHandler.getResult();
  transformer.transform(source,result);
  Message out=exchange.getOut(true);
  out.copyFrom(exchange.getIn());
  resultHandler.setBody(out);
}
