{
  URI uri=new URI(ep.getEndpointName());
  Map map=URISupport.parseQuery(uri.getQuery());
  String camelUri=uri.getSchemeSpecificPart();
  Endpoint camelEndpoint=getCamelContext().resolveEndpoint(camelUri);
  Processor<Exchange> processor=null;
  try {
    processor=camelEndpoint.createProducer();
  }
 catch (  Exception e) {
    throw new FailedToCreateProducerException(camelEndpoint,e);
  }
  CamelJbiEndpoint endpoint=new CamelJbiEndpoint(getServiceUnit(),camelEndpoint,getBinding(),processor);
  IntrospectionSupport.setProperties(endpoint,map);
  return endpoint;
}
