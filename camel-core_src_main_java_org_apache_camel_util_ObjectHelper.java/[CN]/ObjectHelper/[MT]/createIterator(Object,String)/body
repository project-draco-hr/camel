{
  if (value instanceof Message) {
    value=((Message)value).getBody();
  }
  if (value == null) {
    return Collections.EMPTY_LIST.iterator();
  }
 else   if (value instanceof Iterator) {
    return (Iterator)value;
  }
 else   if (value instanceof Collection) {
    Collection collection=(Collection)value;
    return collection.iterator();
  }
 else   if (value.getClass().isArray()) {
    List<Object> list=Arrays.asList((Object[])value);
    return list.iterator();
  }
 else   if (value instanceof NodeList) {
    final NodeList nodeList=(NodeList)value;
    return new Iterator<Node>(){
      int idx=-1;
      public boolean hasNext(){
        return ++idx < nodeList.getLength();
      }
      public Node next(){
        return nodeList.item(idx);
      }
      public void remove(){
        throw new UnsupportedOperationException();
      }
    }
;
  }
 else   if (value instanceof String) {
    final String s=(String)value;
    if (s.contains(delimiter)) {
      Scanner scanner=new Scanner((String)value);
      scanner.useDelimiter(delimiter);
      return scanner;
    }
 else {
      return new Iterator<String>(){
        int idx=-1;
        public boolean hasNext(){
          return ++idx == 0 && ObjectHelper.isNotEmpty(s);
        }
        public String next(){
          return s;
        }
        public void remove(){
          throw new UnsupportedOperationException();
        }
      }
;
    }
  }
 else {
    return Collections.singletonList(value).iterator();
  }
}
