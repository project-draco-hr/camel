{
  if (ObjectHelper.isEmpty(resourceUri) && ObjectHelper.isEmpty(resourceRef)) {
    throw new IllegalArgumentException("Either uri or ref must be provided for resource endpoint");
  }
  Endpoint endpoint;
  if (resourceUri != null) {
    endpoint=routeContext.resolveEndpoint(resourceUri);
  }
 else {
    endpoint=routeContext.resolveEndpoint(null,resourceRef);
  }
  Enricher enricher=new Enricher(null,endpoint.createProducer());
  AggregationStrategy strategy=createAggregationStrategy(routeContext);
  if (strategy == null) {
    enricher.setDefaultAggregationStrategy();
  }
 else {
    enricher.setAggregationStrategy(strategy);
  }
  if (getAggregateOnException() != null) {
    enricher.setAggregateOnException(getAggregateOnException());
  }
  return enricher;
}
