{
  template.sendBodyAndHeader("file:" + inputDirectory,expectedBody,FileComponent.HEADER_FILE_NAME,fileName);
  MockEndpoint result=getMockEndpoint("mock:result");
  result.expectedBodiesReceived(expectedBody);
  result.setResultWaitTime(5000);
  Thread.sleep(1000);
  deleteDirectory(outputDirectory);
  Thread.sleep(1000);
  File file=new File(inputDirectory + "/" + fileName);
  File outDir=new File(outputDirectory);
  outDir.mkdirs();
  File newFile=new File(outDir,fileName);
  assertFileExists(file);
  assertFileNotExists(newFile);
  boolean answer=file.renameTo(newFile);
  assertTrue("Move of file: " + file + " to "+ newFile+ " should have worked!",answer);
  assertFileNotExists(file);
  assertFileExists(newFile);
  Thread.sleep(2000);
  assertMockEndpointsSatisfied();
}
