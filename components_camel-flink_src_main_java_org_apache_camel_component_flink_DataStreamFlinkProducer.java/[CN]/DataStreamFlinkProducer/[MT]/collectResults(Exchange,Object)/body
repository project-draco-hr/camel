{
  if (result instanceof DataStream) {
    DataStream dsResults=(DataStream)result;
    if (getEndpoint().isCollect()) {
      throw new IllegalArgumentException("collect mode not supported for Flink DataStreams.");
    }
 else {
      exchange.getIn().setBody(result);
      exchange.getIn().setHeader(FlinkConstants.FLINK_DATASTREAM_HEADER,result);
    }
  }
 else {
    exchange.getIn().setBody(result);
  }
}
