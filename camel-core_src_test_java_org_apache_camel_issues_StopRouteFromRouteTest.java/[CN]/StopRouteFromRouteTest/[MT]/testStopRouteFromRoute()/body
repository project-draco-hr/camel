{
  CamelContext context=new DefaultCamelContext();
  context.addRoutes(createMyRoutes());
  context.start();
  assertTrue("Route myRoute should be started",context.getRouteStatus("myRoute").isStarted());
  assertTrue("Route bar should be started",context.getRouteStatus("bar").isStarted());
  MockEndpoint start=context.getEndpoint("mock:start",MockEndpoint.class);
  start.expectedMessageCount(1);
  MockEndpoint done=context.getEndpoint("mock:done",MockEndpoint.class);
  done.expectedMessageCount(1);
  ProducerTemplate template=context.createProducerTemplate();
  template.sendBody("direct:start","Hello Camel");
  Thread.sleep(1500);
  assertTrue("Route myRoute should be stopped",context.getRouteStatus("myRoute").isStopped());
  assertTrue("Route bar should be started",context.getRouteStatus("bar").isStarted());
  context.stop();
  start.assertIsSatisfied();
  done.assertIsSatisfied();
}
