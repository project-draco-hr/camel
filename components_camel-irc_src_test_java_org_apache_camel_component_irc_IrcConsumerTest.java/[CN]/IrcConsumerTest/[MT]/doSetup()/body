{
  connection=mock(IRCConnection.class);
  endpoint=mock(IrcEndpoint.class);
  processor=mock(Processor.class);
  configuration=mock(IrcConfiguration.class);
  listener=mock(IRCEventAdapter.class);
  List<String> channels=new ArrayList<String>();
  List<String> keys=new ArrayList<String>();
  channels.add("chan1");
  channels.add("chan2");
  keys.add("");
  keys.add("chan2key");
  when(configuration.getChannels()).thenReturn(channels);
  when(endpoint.getConfiguration()).thenReturn(configuration);
  consumer=new IrcConsumer(endpoint,processor,connection);
  consumer.setListener(listener);
}
