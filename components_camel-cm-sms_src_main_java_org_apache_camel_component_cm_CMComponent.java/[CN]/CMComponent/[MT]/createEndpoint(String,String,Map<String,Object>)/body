{
  LOG.debug("Creating CM Endpoint ... ");
  LOG.debug("Uri=[{}], path=[{}], parameters=[{}]",new Object[]{URISupport.sanitizeUri(uri),URISupport.sanitizePath(remaining),parameters});
  final CMConfiguration config=new CMConfiguration();
  setProperties(config,parameters);
  LOG.debug("Validating uri based configuration");
  final Set<ConstraintViolation<CMConfiguration>> constraintViolations=validator.validate(config);
  if (constraintViolations.size() > 0) {
    final StringBuffer msg=new StringBuffer();
    for (    final ConstraintViolation<CMConfiguration> cv : constraintViolations) {
      msg.append(String.format("- Invalid value for %s: %s",cv.getPropertyPath().toString(),cv.getMessage()));
    }
    throw new ResolveEndpointFailedException(uri,msg.toString());
  }
  LOG.debug("CMConfiguration - OK!");
  LOG.debug("Creating CMEndpoint");
  final CMEndpoint endpoint=new CMEndpoint(uri,this);
  endpoint.setConfiguration(config);
  endpoint.setHost(remaining);
  return endpoint;
}
