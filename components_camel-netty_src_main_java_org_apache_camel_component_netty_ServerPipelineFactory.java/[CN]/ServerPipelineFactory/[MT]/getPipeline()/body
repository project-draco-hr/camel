{
  ChannelPipeline channelPipeline=Channels.pipeline();
  SslHandler sslHandler=configureServerSSLOnDemand();
  if (sslHandler != null) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Server SSL handler configured and added as an interceptor against the ChannelPipeline");
    }
    channelPipeline.addLast("ssl",sslHandler);
  }
  channelPipeline.addLast("decoder",consumer.getConfiguration().getDecoder());
  channelPipeline.addLast("encoder",consumer.getConfiguration().getEncoder());
  if (consumer.getConfiguration().getHandler() != null) {
    channelPipeline.addLast("handler",consumer.getConfiguration().getHandler());
  }
 else {
    channelPipeline.addLast("handler",new ServerChannelHandler(consumer));
  }
  return channelPipeline;
}
