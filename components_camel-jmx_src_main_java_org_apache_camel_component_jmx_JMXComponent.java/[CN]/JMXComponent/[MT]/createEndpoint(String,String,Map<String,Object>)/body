{
  JMXEndpoint endpoint=new JMXEndpoint(uri,this);
  EndpointHelper.setReferenceProperties(getCamelContext(),endpoint,parameters);
  EndpointHelper.setProperties(getCamelContext(),endpoint,parameters);
  endpoint.setServerURL(remaining);
  if (!parameters.isEmpty()) {
    Hashtable<String,String> objectProperties=new Hashtable<String,String>();
    for (Iterator<Entry<String,Object>> it=parameters.entrySet().iterator(); it.hasNext(); ) {
      Entry<String,Object> entry=it.next();
      if (entry.getKey().startsWith("key.")) {
        objectProperties.put(entry.getKey().substring("key.".length()),entry.getValue().toString());
        it.remove();
      }
    }
    endpoint.setObjectProperties(objectProperties);
  }
  if (endpoint.getObjectDomain() == null) {
    throw new IllegalArgumentException("Must specify domain");
  }
  if (endpoint.getObjectName() == null && endpoint.getObjectProperties() == null) {
    throw new IllegalArgumentException("Must specify object name or object properties");
  }
  return endpoint;
}
