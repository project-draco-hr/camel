{
  CamelContext context=new DefaultCamelContext();
  ConnectionFactory connectionFactory=new ActiveMQConnectionFactory("vm://localhost?broker.persistent=false");
  context.addComponent("test-jms",JmsComponent.jmsComponentAutoAcknowledge(connectionFactory));
  context.addRoutes(new RouteBuilder(){
    public void configure(){
      from("test-jms:queue:test.queue").to("file://test");
      from("file://test").process(new Processor(){
        public void process(        Exchange e){
          System.out.println("Received exchange: " + e.getIn());
        }
      }
);
    }
  }
);
  ProducerTemplate template=context.createProducerTemplate();
  context.start();
  for (int i=0; i < 10; i++) {
    template.sendBody("test-jms:queue:test.queue","Test Message: " + i);
  }
  Thread.sleep(1000);
  context.stop();
}
