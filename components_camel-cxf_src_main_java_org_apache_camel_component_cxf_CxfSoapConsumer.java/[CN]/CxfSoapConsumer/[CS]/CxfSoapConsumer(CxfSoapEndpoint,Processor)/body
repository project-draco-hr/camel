{
  this.endpoint=endpoint;
  Processor soapProcessor=new CxfAroundProcessor(processor,new Processor(){
    public void process(    Exchange exchange) throws Exception {
      processSoapConsumerIn(exchange);
    }
  }
,new Processor(){
    public void process(    Exchange exchange) throws Exception {
      processSoapConsumerOut(exchange);
    }
  }
);
  this.consumer=endpoint.getInnerEndpoint().createConsumer(soapProcessor);
  Class sei=null;
  if (ObjectHelper.isNotEmpty(endpoint.getServiceClass())) {
    sei=ClassLoaderUtils.loadClass(endpoint.getServiceClass(),this.getClass());
  }
  ServerFactoryBean sfb=CxfEndpointUtils.getServerFactoryBean(sei);
  sfb.setWsdlURL(endpoint.getWsdl().getURL().toString());
  if (endpoint.getServiceName() != null) {
    sfb.setServiceName(endpoint.getServiceName());
  }
  if (endpoint.getEndpointName() != null) {
    sfb.setEndpointName(endpoint.getEndpointName());
  }
  sfb.setDestinationFactory(new NullDestinationFactory());
  sfb.setStart(false);
  server=sfb.create();
}
