{
  try {
    BufferedReader in=IOHelper.buffered(new InputStreamReader(configFile.openStream()));
    String className=null;
    while ((className=in.readLine()) != null) {
      if ("".equals(className.trim()) || className.trim().startsWith("#")) {
        continue;
      }
 else       if (className.contains("#")) {
        className=className.substring(0,className.indexOf('#')).trim();
        break;
      }
 else {
        className=className.trim();
        break;
      }
    }
    in.close();
    Class<?> cls=bundle.loadClass(className);
    if (!ScriptEngineFactory.class.isAssignableFrom(cls)) {
      throw new IllegalStateException("Invalid ScriptEngineFactory: " + cls.getName());
    }
    return (ScriptEngineFactory)cls.newInstance();
  }
 catch (  Exception e) {
    LOG.warn("Cannot create the ScriptEngineFactory: " + e.getClass().getName(),e);
    return null;
  }
}
