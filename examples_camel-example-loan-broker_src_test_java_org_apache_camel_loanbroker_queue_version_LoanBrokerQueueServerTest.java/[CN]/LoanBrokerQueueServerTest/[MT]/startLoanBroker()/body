{
  deleteDirectory("activemq-data");
  JmsBroker broker=new JmsBroker("tcp://localhost:61616");
  broker.start();
  try {
    AbstractApplicationContext applicationContext=new ClassPathXmlApplicationContext(new String[]{"/META-INF/spring/queueCamelContext.xml"});
    CamelContext camelContext=(CamelContext)applicationContext.getBean("queue");
    assertNotNull("The camel context should not be null",camelContext);
    Thread.sleep(2000);
    camelContext.stop();
    applicationContext.stop();
  }
  finally {
    broker.stop();
  }
}
