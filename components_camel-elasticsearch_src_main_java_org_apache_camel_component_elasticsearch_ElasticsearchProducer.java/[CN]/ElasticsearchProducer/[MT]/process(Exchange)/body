{
  String operation=exchange.getIn().getHeader(ElasticsearchConfiguration.PARAM_OPERATION,String.class);
  if (operation == null) {
    operation=getEndpoint().getConfig().getOperation();
  }
  if (operation == null) {
    throw new IllegalArgumentException(ElasticsearchConfiguration.PARAM_OPERATION + " is missing");
  }
  Client client=getEndpoint().getClient();
  if (operation.equalsIgnoreCase(ElasticsearchConfiguration.OPERATION_INDEX)) {
    addToIndex(client,exchange);
  }
 else   if (operation.equalsIgnoreCase(ElasticsearchConfiguration.OPERATION_GET_BY_ID)) {
    getById(client,exchange);
  }
 else   if (operation.equalsIgnoreCase(ElasticsearchConfiguration.OPERATION_DELETE)) {
    deleteById(client,exchange);
  }
 else   if (operation.equalsIgnoreCase(ElasticsearchConfiguration.OPERATION_BULK_INDEX)) {
    addToIndexUsingBulk(client,exchange);
  }
 else {
    throw new IllegalArgumentException(ElasticsearchConfiguration.PARAM_OPERATION + " value '" + operation+ "' is not supported");
  }
}
