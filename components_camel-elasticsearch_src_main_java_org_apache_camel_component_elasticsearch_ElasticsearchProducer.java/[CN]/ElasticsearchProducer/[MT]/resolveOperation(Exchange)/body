{
  Object request=exchange.getIn().getBody();
  if (request instanceof IndexRequest) {
    return ElasticsearchConfiguration.OPERATION_INDEX;
  }
 else   if (request instanceof GetRequest) {
    return ElasticsearchConfiguration.OPERATION_GET_BY_ID;
  }
 else   if (request instanceof BulkRequest) {
    return ElasticsearchConfiguration.OPERATION_BULK_INDEX;
  }
 else   if (request instanceof DeleteRequest) {
    return ElasticsearchConfiguration.OPERATION_DELETE;
  }
  String operationConfig=exchange.getIn().getHeader(ElasticsearchConfiguration.PARAM_OPERATION,String.class);
  if (operationConfig == null) {
    operationConfig=getEndpoint().getConfig().getOperation();
  }
  if (operationConfig == null) {
    throw new IllegalArgumentException(ElasticsearchConfiguration.PARAM_OPERATION + " value '" + operationConfig+ "' is not supported");
  }
  return operationConfig;
}
