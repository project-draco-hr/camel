{
  MessageProducerResources answer=null;
  Connection conn=null;
  try {
    MessageProducer messageProducer=null;
    Session session=null;
    conn=getConnectionResource().borrowConnection();
    if (isEndpointTransacted()) {
      session=conn.createSession(true,getAcknowledgeMode());
    }
 else {
      session=conn.createSession(false,getAcknowledgeMode());
    }
    if (isTopic()) {
      messageProducer=JmsObjectFactory.createMessageProducer(session,getDestinationName(),isTopic(),isPersistent(),getTtl());
    }
 else {
      messageProducer=JmsObjectFactory.createQueueProducer(session,getDestinationName());
    }
    if (session == null) {
      throw new CamelException("Message Consumer Creation Exception: Session is NULL");
    }
    if (messageProducer == null) {
      throw new CamelException("Message Consumer Creation Exception: MessageProducer is NULL");
    }
    answer=new MessageProducerResources(session,messageProducer);
  }
 catch (  Exception e) {
    log.error("Unable to create the MessageProducer: " + e.getLocalizedMessage());
  }
 finally {
    if (conn != null) {
      getConnectionResource().returnConnection(conn);
    }
  }
  return answer;
}
