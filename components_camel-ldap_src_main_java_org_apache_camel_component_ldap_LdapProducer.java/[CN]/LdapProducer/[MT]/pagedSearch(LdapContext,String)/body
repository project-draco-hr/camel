{
  List<SearchResult> data=new ArrayList<SearchResult>();
  if (log.isTraceEnabled()) {
    log.trace("Using paged ldap search, pageSize=" + pageSize);
  }
  Control[] requestControls=new Control[]{new PagedResultsControl(pageSize,Control.CRITICAL)};
  ldapContext.setRequestControls(requestControls);
  do {
    List<SearchResult> pageResult=simpleSearch(ldapContext,searchFilter);
    data.addAll(pageResult);
    if (log.isTraceEnabled()) {
      log.trace("Page returned " + pageResult.size() + " entries");
    }
  }
 while (prepareNextPage(ldapContext));
  if (log.isDebugEnabled()) {
    log.debug("Found a total of " + data.size() + " entries for ldap filter "+ searchFilter);
  }
  return data;
}
