{
  Reader reader=new InputStreamReader(getResource().getInputStream());
  StringWriter buffer=new StringWriter();
  String logTag=getClass().getName();
  Context velocityContext=new VelocityContext(ExchangeHelper.createVariableMap(exchange));
  getVelocityEngine().evaluate(velocityContext,buffer,logTag,reader);
  Message out=exchange.getOut(true);
  out.setBody(buffer.toString());
  out.setHeader("org.apache.camel.velocity.resource",getResource());
}
