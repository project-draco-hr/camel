{
  Brave brave=null;
  if (serviceName != null) {
    brave=braves.get(serviceName);
    if (brave == null && useFallbackServiceNames) {
      log.debug("Creating Brave assigned to serviceName: {}",serviceName + " as fallback");
      Brave.Builder builder=new Brave.Builder(serviceName);
      builder=builder.traceSampler(Sampler.create(rate));
      if (spanCollector != null) {
        builder=builder.spanCollector(spanCollector);
      }
      brave=builder.build();
      braves.put(serviceName,brave);
    }
  }
  return brave;
}
