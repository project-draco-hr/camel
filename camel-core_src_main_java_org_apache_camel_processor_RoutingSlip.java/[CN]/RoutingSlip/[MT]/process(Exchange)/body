{
  Message message=exchange.getIn();
  String[] recipients=recipients(message);
  Exchange current=exchange;
  for (  String nextRecipient : recipients) {
    Endpoint endpoint=resolveEndpoint(exchange,nextRecipient);
    Exchange copy=new DefaultExchange(current);
    updateRoutingSlip(current);
    copyOutToIn(copy,current);
    getProducerCache(exchange).doInProducer(endpoint,copy,null,new ProducerCallback<Object>(){
      public Object doInProducer(      Producer producer,      Exchange exchange,      ExchangePattern exchangePattern) throws Exception {
        exchange.setProperty(Exchange.TO_ENDPOINT,producer.getEndpoint().getEndpointUri());
        producer.process(exchange);
        return exchange;
      }
    }
);
    current=copy;
  }
  ExchangeHelper.copyResults(exchange,current);
}
