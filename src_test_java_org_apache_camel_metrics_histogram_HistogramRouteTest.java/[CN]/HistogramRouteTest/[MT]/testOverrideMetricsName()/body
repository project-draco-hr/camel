{
  MetricRegistry mockRegistry=endpoint.getCamelContext().getRegistry().lookupByNameAndType(MetricsComponent.METRIC_REGISTRY_NAME,MetricRegistry.class);
  Histogram mockHistogram=Mockito.mock(Histogram.class);
  InOrder inOrder=Mockito.inOrder(mockRegistry,mockHistogram);
  when(mockRegistry.histogram("B")).thenReturn(mockHistogram);
  endpoint.expectedMessageCount(1);
  producer.sendBodyAndHeader(new Object(),MetricsComponent.HEADER_METRIC_NAME,"B");
  endpoint.assertIsSatisfied();
  inOrder.verify(mockRegistry,times(1)).histogram("B");
  inOrder.verify(mockHistogram,times(1)).update(332491L);
  inOrder.verifyNoMoreInteractions();
}
