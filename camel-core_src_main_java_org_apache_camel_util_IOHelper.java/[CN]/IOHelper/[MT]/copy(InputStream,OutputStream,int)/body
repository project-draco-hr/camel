{
  int avail=input.available();
  if (avail > 262144) {
    avail=262144;
  }
  if (avail > bufferSize) {
    bufferSize=avail;
  }
  final byte[] buffer=new byte[bufferSize];
  int n=input.read(buffer);
  int total=0;
  while (-1 != n) {
    output.write(buffer,0,n);
    total+=n;
    n=input.read(buffer);
  }
  output.flush();
  return total;
}
