{
  if (is.markSupported()) {
    InputStreamPayload payload=new InputStreamPayload(is);
    long contentLength=ByteStreams.length(payload);
    is.reset();
    payload.getContentMetadata().setContentLength(contentLength);
    return payload;
  }
 else {
    CachedOutputStream cos=new CachedOutputStream(exchange);
    IOHelper.copy(is,cos);
    return toPayload(cos.getWrappedInputStream(),exchange);
  }
}
