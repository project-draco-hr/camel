{
  for (int i=0; i < expectedBodies.length; i++) {
    Object expectedBody=expectedBodies[i];
    template.sendBodyAndHeader("activemq:BrowsableQueueTest.b",expectedBody,"counter",i);
  }
  JmsQueueEndpoint endpoint=getMandatoryEndpoint("activemq:BrowsableQueueTest.b?maximumBrowseSize=6",JmsQueueEndpoint.class);
  assertEquals(6,endpoint.getMaximumBrowseSize());
  List<Exchange> list=endpoint.getExchanges();
  LOG.debug("Received: " + list);
  assertEquals("Size of list",2,endpoint.queueSize());
  for (int i=0; i < 2; i++) {
    String data=endpoint.browseExchange(i);
    assertNotNull(data);
  }
  int index=-1;
  for (  Exchange exchange : list) {
    String actual=exchange.getIn().getBody(String.class);
    LOG.debug("Received body: " + actual);
    Object expected=expectedBodies[++index];
    assertEquals("Body: " + index,expected,actual);
  }
}
