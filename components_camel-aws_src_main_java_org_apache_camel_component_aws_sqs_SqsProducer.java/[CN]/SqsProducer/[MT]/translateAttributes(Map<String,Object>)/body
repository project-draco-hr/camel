{
  Map<String,MessageAttributeValue> result=new HashMap<String,MessageAttributeValue>();
  for (  Entry<String,Object> entry : headers.entrySet()) {
    Object value=entry.getValue();
    MessageAttributeValue mav=new MessageAttributeValue();
    if (value instanceof String) {
      mav.setDataType("String");
      mav.withStringValue((String)value);
    }
 else     if (value instanceof ByteBuffer) {
      mav.setDataType("Binary");
      mav.withBinaryValue((ByteBuffer)value);
    }
    result.put(entry.getKey(),mav);
  }
  return result;
}
