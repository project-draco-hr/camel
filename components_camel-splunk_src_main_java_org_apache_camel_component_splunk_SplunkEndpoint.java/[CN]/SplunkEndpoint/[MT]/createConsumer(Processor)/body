{
  if (configuration.getInitEarliestTime() == null) {
    throw new IllegalArgumentException("Required initialEarliestTime option could not be found");
  }
  String[] uriSplit=splitUri(getEndpointUri());
  if (uriSplit.length > 0) {
    ConsumerType consumerType=ConsumerType.fromUri(uriSplit[0]);
    SplunkConsumer consumer=new SplunkConsumer(this,processor,consumerType);
    configureConsumer(consumer);
    return consumer;
  }
  throw new IllegalArgumentException("Cannot create any consumer with uri " + getEndpointUri() + ". A consumer type was not provided (or an incorrect pairing was used).");
}
