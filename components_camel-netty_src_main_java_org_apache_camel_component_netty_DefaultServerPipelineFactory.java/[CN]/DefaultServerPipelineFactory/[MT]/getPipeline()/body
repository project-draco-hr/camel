{
  ChannelPipeline channelPipeline=Channels.pipeline();
  SslHandler sslHandler=configureServerSSLOnDemand();
  if (sslHandler != null) {
    LOG.debug("Server SSL handler configured and added as an interceptor against the ChannelPipeline");
    channelPipeline.addLast("ssl",sslHandler);
  }
  List<ChannelDownstreamHandler> encoders=consumer.getConfiguration().getEncoders();
  for (int x=0; x < encoders.size(); x++) {
    channelPipeline.addLast("encoder-" + x,encoders.get(x));
  }
  List<ChannelUpstreamHandler> decoders=consumer.getConfiguration().getDecoders();
  for (int x=0; x < decoders.size(); x++) {
    channelPipeline.addLast("decoder-" + x,decoders.get(x));
  }
  channelPipeline.addLast("handler",new ServerChannelHandler(consumer));
  return channelPipeline;
}
