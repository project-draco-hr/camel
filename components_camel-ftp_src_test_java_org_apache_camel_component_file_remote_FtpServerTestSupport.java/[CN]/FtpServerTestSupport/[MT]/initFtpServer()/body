{
  if (port < 21000) {
    throw new IllegalArgumentException("Port number is not initialized in an expected range: " + getPort());
  }
  FtpServerFactory serverFactory=new FtpServerFactory();
  File file=new File("./src/test/resources/users.properties").getAbsoluteFile();
  UserManager uman=new PropertiesUserManager(new ClearTextPasswordEncryptor(),file,"admin");
  serverFactory.setUserManager(uman);
  NativeFileSystemFactory fsf=new NativeFileSystemFactory();
  fsf.setCreateHome(true);
  serverFactory.setFileSystem(fsf);
  ListenerFactory factory=new ListenerFactory();
  factory.setPort(port);
  serverFactory.addListener("default",factory.createListener());
  ftpServer=serverFactory.createServer();
}
