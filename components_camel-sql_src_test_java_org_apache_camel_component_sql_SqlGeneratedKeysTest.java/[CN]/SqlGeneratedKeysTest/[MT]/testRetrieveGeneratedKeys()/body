{
  Endpoint endpoint=context.getEndpoint("direct:insert2");
  Exchange exchange=endpoint.createExchange();
  exchange.getIn().setBody(new Object[]{"Star Swirl","Wizard"});
  exchange.getIn().setHeader(SqlConstants.SQL_RETRIEVE_GENERATED_KEYS,true);
  exchange.getIn().setHeader(SqlConstants.SQL_GENERATED_COLUMNS,new String[]{"ID1","ID2"});
  Exchange out=template.send(endpoint,exchange);
  assertNotNull(out);
  assertNotNull(out.getOut());
  assertNotNull(out.getIn().getHeader(SqlConstants.SQL_GENERATED_KEY_HOLDER));
  KeyHolder generatedKeys=out.getIn().getHeader(SqlConstants.SQL_GENERATED_KEY_HOLDER,KeyHolder.class);
  assertNotNull("out body could not be converted to a KeyHolder - was: " + out.getIn().getBody(),generatedKeys);
  assertEquals(2,generatedKeys.getKeyList().get(0).size());
  Map<String,Object> row=generatedKeys.getKeys();
  assertEquals("auto increment value of ID1 should be 5",Integer.valueOf(5),row.get("ID1"));
  assertEquals("auto increment value of ID2 should be 6",Integer.valueOf(6),row.get("ID2"));
  assertEquals("generated keys row count should be one",1,generatedKeys.getKeyList().size());
}
