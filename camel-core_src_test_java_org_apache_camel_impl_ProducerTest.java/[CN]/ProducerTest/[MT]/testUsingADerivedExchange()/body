{
  DefaultEndpoint<MyExchange> endpoint=new DefaultEndpoint<MyExchange>("foo",new DefaultComponent()){
    public Consumer<MyExchange> createConsumer(    Processor processor) throws Exception {
      return null;
    }
    public MyExchange createExchange(){
      return new MyExchange(getContext());
    }
    public Producer<MyExchange> createProducer() throws Exception {
      return null;
    }
    public boolean isSingleton(){
      return false;
    }
  }
;
  DefaultProducer producer=new DefaultProducer(endpoint){
    public void process(    Exchange exchange) throws Exception {
      log.info("Received: " + exchange);
    }
  }
;
  Exchange exchange=new DefaultExchange(context);
  producer.process(exchange);
  Class type=endpoint.getExchangeType();
  assertEquals("exchange type",MyExchange.class,type);
  MyExchange actual=endpoint.toExchangeType(exchange);
  assertNotNull(actual);
  assertTrue("Not same exchange",actual != exchange);
  MyExchange expected=new MyExchange(context);
  actual=endpoint.toExchangeType(expected);
  assertSame("Should not copy an exchange when of the correct type",expected,actual);
}
