{
  Object answer=null;
  Message in=exchange.getIn();
  if (in.getBody() instanceof GenericFile) {
    InputStream is=exchange.getContext().getTypeConverter().convertTo(InputStream.class,in.getBody());
    answer=new InputSource(is);
  }
 else   if (in.getBody() instanceof InputStream) {
    answer=new InputSource(in.getBody(InputStream.class));
  }
 else   if (in.getBody() instanceof String) {
    answer=new InputSource(new StringReader(in.getBody(String.class)));
  }
  Class type=getDocumentType();
  if (type != null) {
    answer=in.getBody(type);
  }
  if (answer == null) {
    answer=in.getBody();
  }
  if (answer instanceof BeanInvocation) {
    BeanInvocation bi=exchange.getContext().getTypeConverter().convertTo(BeanInvocation.class,answer);
    if (bi.getArgs() != null && bi.getArgs().length == 1 && bi.getArgs()[0] == null) {
      answer=null;
    }
  }
  MessageHelper.resetStreamCache(exchange.getIn());
  return answer;
}
