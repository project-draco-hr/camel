{
  Object answer=null;
  Message in=exchange.getIn();
  Class type=getDocumentType();
  if (type != null) {
    answer=in.getBody(type);
  }
  if (answer == null) {
    answer=in.getBody();
  }
  if (answer instanceof GenericFile) {
    InputStream is=exchange.getContext().getTypeConverter().convertTo(InputStream.class,answer);
    answer=new InputSource(is);
  }
 else   if (answer instanceof BeanInvocation) {
    BeanInvocation bi=exchange.getContext().getTypeConverter().convertTo(BeanInvocation.class,answer);
    if (bi.getArgs() != null && bi.getArgs().length == 1 && bi.getArgs()[0] == null) {
      answer=null;
    }
  }
 else   if (answer instanceof String) {
    answer=new InputSource(new StringReader(answer.toString()));
  }
  MessageHelper.resetStreamCache(exchange.getIn());
  return answer;
}
