{
  XPath xPath=getXPathFactory().newXPath();
  xpathFactory=null;
  xPath.setNamespaceContext(getNamespaceContext());
  xPath.setXPathVariableResolver(variableResolver);
  XPathFunctionResolver parentResolver=getFunctionResolver();
  if (parentResolver == null) {
    parentResolver=xPath.getXPathFunctionResolver();
  }
  xPath.setXPathFunctionResolver(createDefaultFunctionResolver(parentResolver));
  return xPath.compile(text);
}
