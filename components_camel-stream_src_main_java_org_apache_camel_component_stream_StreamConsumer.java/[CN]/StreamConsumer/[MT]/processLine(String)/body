{
  boolean last=line == null;
  if (endpoint.getGroupLines() > 0) {
    if (line != null) {
      lines.add(line);
    }
    if (!lines.isEmpty() && (lines.size() >= endpoint.getGroupLines() || last)) {
      Exchange exchange=endpoint.createExchange();
      Message msg=new DefaultMessage();
      List<String> copy=new ArrayList<String>(lines);
      msg.setBody(endpoint.getGroupStrategy().groupLines(copy));
      exchange.setIn(msg);
      lines.clear();
      getProcessor().process(exchange);
    }
  }
 else   if (!last) {
    Exchange exchange=endpoint.createExchange();
    Message msg=new DefaultMessage();
    msg.setBody(line);
    exchange.setIn(msg);
    getProcessor().process(exchange);
  }
}
