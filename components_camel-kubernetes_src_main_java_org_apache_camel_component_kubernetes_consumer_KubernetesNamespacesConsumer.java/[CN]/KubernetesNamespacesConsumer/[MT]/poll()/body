{
  int mapSize=map.size();
  for (  ConcurrentMap.Entry<Long,NamespaceEvent> entry : map.entrySet()) {
    NamespaceEvent namespaceEvent=(NamespaceEvent)entry.getValue();
    Exchange e=getEndpoint().createExchange();
    e.getIn().setBody(namespaceEvent.getNamespace());
    e.getIn().setHeader(KubernetesConstants.KUBERNETES_EVENT_ACTION,namespaceEvent.getAction());
    e.getIn().setHeader(KubernetesConstants.KUBERNETES_EVENT_TIMESTAMP,entry.getKey());
    getProcessor().process(e);
    map.remove(entry.getKey());
  }
  return mapSize;
}
