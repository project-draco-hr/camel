{
  if (LOG.isTraceEnabled()) {
    LOG.trace("buildDirectory(" + directory + ","+ absolute+ ")");
  }
  boolean success=false;
  String originalDirectory=getCurrentDirectory();
  try {
    try {
      channel.cd(directory);
      success=true;
    }
 catch (    SftpException e) {
    }
    if (!success) {
      if (LOG.isDebugEnabled()) {
        LOG.debug("Trying to build remote directory: " + directory);
      }
      try {
        channel.mkdir(directory);
        success=true;
      }
 catch (      SftpException e) {
        success=buildDirectoryChunks(directory);
      }
    }
  }
 catch (  IOException e) {
    throw new GenericFileOperationFailedException("Cannot build directory: " + directory,e);
  }
catch (  SftpException e) {
    throw new GenericFileOperationFailedException("Cannot build directory: " + directory,e);
  }
 finally {
    if (originalDirectory != null) {
      changeCurrentDirectory(originalDirectory);
    }
  }
  return success;
}
