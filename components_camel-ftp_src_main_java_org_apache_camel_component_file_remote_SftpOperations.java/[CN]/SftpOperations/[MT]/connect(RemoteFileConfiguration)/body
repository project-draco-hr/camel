{
  if (isConnected()) {
    return true;
  }
  boolean connected=false;
  int attempt=0;
  while (!connected) {
    try {
      if (LOG.isTraceEnabled() && attempt > 0) {
        LOG.trace("Reconnect attempt #" + attempt + " connecting to + "+ configuration.remoteServerInformation());
      }
      if (channel == null || !channel.isConnected()) {
        if (session == null || !session.isConnected()) {
          LOG.trace("Session isn't connected, trying to recreate and connect.");
          session=createSession(configuration);
          session.connect();
        }
        LOG.trace("Channel isn't connected, trying to recreate and connect.");
        channel=(ChannelSftp)session.openChannel("sftp");
        channel.connect();
        LOG.info("Connected to " + configuration.remoteServerInformation());
      }
      connected=true;
    }
 catch (    Exception e) {
      GenericFileOperationFailedException failed=new GenericFileOperationFailedException("Cannot connect to " + configuration.remoteServerInformation(),e);
      if (LOG.isTraceEnabled()) {
        LOG.trace("Cannot connect due: " + failed.getMessage());
      }
      attempt++;
      if (attempt > endpoint.getMaximumReconnectAttempts()) {
        throw failed;
      }
      if (endpoint.getReconnectDelay() > 0) {
        try {
          Thread.sleep(endpoint.getReconnectDelay());
        }
 catch (        InterruptedException e1) {
        }
      }
    }
  }
  return true;
}
