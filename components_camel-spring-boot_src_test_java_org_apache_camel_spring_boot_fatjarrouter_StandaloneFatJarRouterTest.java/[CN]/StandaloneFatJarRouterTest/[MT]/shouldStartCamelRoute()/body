{
  final int port=SocketUtils.findAvailableTcpPort();
  TestFatJarRouter.main("--spring.main.sources=org.apache.camel.spring.boot.fatjarrouter.TestFatJarRouter","--http.port=" + port);
  await().atMost(1,TimeUnit.MINUTES).until(new Callable<Boolean>(){
    @Override public Boolean call() throws Exception {
      try {
        new URL("http://localhost:" + port).openStream();
      }
 catch (      ConnectException ex) {
        return false;
      }
      return true;
    }
  }
);
  String response=IOUtils.toString(new URL("http://localhost:" + port));
  assertEquals("stringBean",response);
}
