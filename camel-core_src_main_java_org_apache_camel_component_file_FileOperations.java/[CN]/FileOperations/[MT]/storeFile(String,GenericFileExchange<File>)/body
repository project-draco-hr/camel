{
  ObjectHelper.notNull(endpoint,"endpoint");
  File file=new File(fileName);
  try {
    File source=null;
    try {
      source=exchange.getIn().getBody(File.class);
    }
 catch (    NoTypeConversionAvailableException e) {
    }
    if (source != null && source.exists()) {
      writeFileByFile(source,file);
    }
 else {
      InputStream in=ExchangeHelper.getMandatoryInBody(exchange,InputStream.class);
      writeFileByStream(in,file);
    }
  }
 catch (  IOException e) {
    throw new GenericFileOperationFailedException("Cannot store file: " + file,e);
  }
catch (  InvalidPayloadException e) {
    throw new GenericFileOperationFailedException("Cannot store file: " + file,e);
  }
  return true;
}
