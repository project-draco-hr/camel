{
  FileChannel in=new FileInputStream(source).getChannel();
  FileChannel out=null;
  try {
    out=prepareOutputFileChannel(target,out);
    if (LOG.isTraceEnabled()) {
      LOG.trace("Using FileChannel to transfer from: " + in + " to: "+ out);
    }
    long size=in.size();
    long position=0;
    while (position < size) {
      position+=in.transferTo(position,endpoint.getBufferSize(),out);
    }
  }
  finally {
    IOHelper.close(in,source.getName(),LOG);
    IOHelper.close(out,target.getName(),LOG);
  }
}
