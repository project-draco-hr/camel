{
  boolean append=endpoint.getFileExist() == GenericFileExist.Append;
  FileOutputStream os=new FileOutputStream(target,append);
  Writer out=IOConverter.toWriter(os,charset);
  try {
    LOG.debug("Using Reader to write file: {} with charset: {}",target,charset);
    int size=endpoint.getBufferSize();
    IOHelper.copy(in,out,size);
  }
  finally {
    IOHelper.close(in,target.getName(),LOG);
    IOHelper.close(out,os,target.getName(),LOG,endpoint.isForceWrites());
  }
}
