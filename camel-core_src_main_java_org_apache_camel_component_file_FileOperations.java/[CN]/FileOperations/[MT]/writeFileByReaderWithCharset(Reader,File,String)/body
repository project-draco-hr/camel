{
  boolean append=endpoint.getFileExist() == GenericFileExist.Append;
  Writer out=IOConverter.toWriter(target,append,charset);
  try {
    LOG.debug("Using Reader to write file: {} with charset: {}",target,charset);
    int size=endpoint.getBufferSize();
    IOHelper.copy(in,out,size);
  }
  finally {
    IOHelper.close(in,target.getName(),LOG);
    IOHelper.close(out,target.getName(),LOG);
  }
}
