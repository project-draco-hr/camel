{
  Expression answer=createSimpleExpressionDirectly(expression);
  if (answer != null) {
    return answer;
  }
  String remainder=ifStartsWithReturnRemainder("bodyAs",expression);
  if (remainder != null) {
    String type=ObjectHelper.between(remainder,"(",")");
    if (type == null) {
      throw new ExpressionIllegalSyntaxException("Valid syntax: ${bodyAs(type)} was: " + expression);
    }
    type=StringHelper.removeQuotes(type);
    return ExpressionBuilder.bodyExpression(type);
  }
  remainder=ifStartsWithReturnRemainder("mandatoryBodyAs",expression);
  if (remainder != null) {
    String type=ObjectHelper.between(remainder,"(",")");
    if (type == null) {
      throw new ExpressionIllegalSyntaxException("Valid syntax: ${mandatoryBodyAs(type)} was: " + expression);
    }
    type=StringHelper.removeQuotes(type);
    return ExpressionBuilder.mandatoryBodyExpression(type);
  }
  remainder=ifStartsWithReturnRemainder("body",expression);
  if (remainder == null) {
    remainder=ifStartsWithReturnRemainder("in.body",expression);
  }
  if (remainder != null) {
    boolean invalid=OgnlHelper.isInvalidValidOgnlExpression(remainder);
    if (invalid) {
      throw new ExpressionIllegalSyntaxException("Valid syntax: ${body.OGNL} was: " + expression);
    }
    return ExpressionBuilder.bodyOgnlExpression(remainder);
  }
  remainder=ifStartsWithReturnRemainder("exception",expression);
  if (remainder != null) {
    boolean invalid=OgnlHelper.isInvalidValidOgnlExpression(remainder);
    if (invalid) {
      throw new ExpressionIllegalSyntaxException("Valid syntax: ${exception.OGNL} was: " + expression);
    }
    return ExpressionBuilder.exchangeExceptionOgnlExpression(remainder);
  }
  remainder=ifStartsWithReturnRemainder("headerAs",expression);
  if (remainder != null) {
    String keyAndType=ObjectHelper.between(remainder,"(",")");
    if (keyAndType == null) {
      throw new ExpressionIllegalSyntaxException("Valid syntax: ${headerAs(key, type)} was: " + expression);
    }
    String key=ObjectHelper.before(keyAndType,",");
    String type=ObjectHelper.after(keyAndType,",");
    if (ObjectHelper.isEmpty(key) || ObjectHelper.isEmpty(type)) {
      throw new ExpressionIllegalSyntaxException("Valid syntax: ${headerAs(key, type)} was: " + expression);
    }
    key=StringHelper.removeQuotes(key);
    type=StringHelper.removeQuotes(type);
    return ExpressionBuilder.headerExpression(key,type);
  }
  if ("in.headers".equals(expression) || "headers".equals(expression)) {
    return ExpressionBuilder.headersExpression();
  }
  remainder=ifStartsWithReturnRemainder("in.headers",expression);
  if (remainder == null) {
    remainder=ifStartsWithReturnRemainder("in.header",expression);
  }
  if (remainder == null) {
    remainder=ifStartsWithReturnRemainder("headers",expression);
  }
  if (remainder == null) {
    remainder=ifStartsWithReturnRemainder("header",expression);
  }
  if (remainder != null) {
    remainder=remainder.substring(1);
    boolean invalid=OgnlHelper.isInvalidValidOgnlExpression(remainder);
    if (invalid) {
      throw new ExpressionIllegalSyntaxException("Valid syntax: ${header.name[key]} was: " + expression);
    }
    if (OgnlHelper.isValidOgnlExpression(remainder)) {
      return ExpressionBuilder.headersOgnlExpression(remainder);
    }
 else {
      return ExpressionBuilder.headerExpression(remainder);
    }
  }
  remainder=ifStartsWithReturnRemainder("out.header.",expression);
  if (remainder == null) {
    remainder=ifStartsWithReturnRemainder("out.headers.",expression);
  }
  if (remainder != null) {
    return ExpressionBuilder.outHeaderExpression(remainder);
  }
  remainder=ifStartsWithReturnRemainder("property",expression);
  if (remainder != null) {
    remainder=remainder.substring(1);
    boolean invalid=OgnlHelper.isInvalidValidOgnlExpression(remainder);
    if (invalid) {
      throw new ExpressionIllegalSyntaxException("Valid syntax: ${property.OGNL} was: " + expression);
    }
    if (OgnlHelper.isValidOgnlExpression(remainder)) {
      return ExpressionBuilder.propertyOgnlExpression(remainder);
    }
 else {
      return ExpressionBuilder.propertyExpression(remainder);
    }
  }
  remainder=ifStartsWithReturnRemainder("sys.",expression);
  if (remainder != null) {
    return ExpressionBuilder.systemPropertyExpression(remainder);
  }
  remainder=ifStartsWithReturnRemainder("sysenv.",expression);
  if (remainder != null) {
    return ExpressionBuilder.systemEnvironmentExpression(remainder);
  }
  remainder=ifStartsWithReturnRemainder("file:",expression);
  if (remainder != null) {
    Expression fileExpression=createSimpleFileExpression(remainder);
    if (expression != null) {
      return fileExpression;
    }
  }
  remainder=ifStartsWithReturnRemainder("date:",expression);
  if (remainder != null) {
    String[] parts=remainder.split(":");
    if (parts.length < 2) {
      throw new ExpressionIllegalSyntaxException("Valid syntax: ${date:command:pattern} was: " + expression);
    }
    String command=ObjectHelper.before(remainder,":");
    String pattern=ObjectHelper.after(remainder,":");
    return ExpressionBuilder.dateExpression(command,pattern);
  }
  remainder=ifStartsWithReturnRemainder("bean:",expression);
  if (remainder != null) {
    return ExpressionBuilder.beanExpression(remainder);
  }
  remainder=ifStartsWithReturnRemainder("properties:",expression);
  if (remainder != null) {
    String[] parts=remainder.split(":");
    if (parts.length > 2) {
      throw new ExpressionIllegalSyntaxException("Valid syntax: ${properties:[locations]:key} was: " + expression);
    }
    String locations=null;
    String key=remainder;
    if (parts.length == 2) {
      locations=ObjectHelper.before(remainder,":");
      key=ObjectHelper.after(remainder,":");
    }
    return ExpressionBuilder.propertiesComponentExpression(key,locations);
  }
  remainder=ifStartsWithReturnRemainder("ref:",expression);
  if (remainder != null) {
    return ExpressionBuilder.refExpression(remainder);
  }
  if (strict) {
    throw new ExpressionIllegalSyntaxException(expression);
  }
 else {
    return ExpressionBuilder.constantExpression(expression);
  }
}
