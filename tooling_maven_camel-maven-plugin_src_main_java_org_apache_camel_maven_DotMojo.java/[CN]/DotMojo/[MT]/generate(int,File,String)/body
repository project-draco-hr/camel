{
  StringWriter buffer=new StringWriter();
  PrintWriter out=new PrintWriter(buffer);
  printHtmlHeader(out,contextName);
  printHtmlFileHeader(out,file);
  for (  String format : graphvizOutputTypes) {
    String generated=convertFile(file,format);
    if (format.equals("cmapx") && generated != null) {
      addFileToBuffer(out,new File(generated));
    }
  }
  printHtmlFileFooter(out,file);
  printHtmlFooter(out);
  String content=buffer.toString();
  String name=file.getName();
  if (name.equalsIgnoreCase("routes.dot") || index == 0) {
    indexHtmlContent=content;
  }
  int idx=name.lastIndexOf(".");
  if (idx >= 0) {
    name=name.substring(0,idx);
    name+=".html";
  }
  writeIndexHtmlFile(file.getParentFile(),name,content);
}
