{
  if (runCamel) {
    if (applicationContextUri != null) {
      getLog().info("Running Camel embedded to load Spring XML files from classpath: " + applicationContextUri);
    }
 else     if (fileApplicationContextUri != null) {
      getLog().info("Running Camel embedded to load Spring XML files from file path: " + fileApplicationContextUri);
    }
 else {
      getLog().info("Running Camel embedded to load Spring XML files from default path: META-INF/spring/*.xml");
    }
    List<?> list=project.getTestClasspathElements();
    getLog().debug("Using classpath: " + list);
    EmbeddedMojo mojo=new EmbeddedMojo();
    mojo.setClasspathElements(list);
    mojo.setDotEnabled(true);
    mojo.setMainClass(mainClass);
    if ("true".equals(getAggregate())) {
      mojo.setDotAggregationEnabled(true);
    }
    mojo.setOutputDirectory(outputDirectory.getAbsolutePath());
    mojo.setDuration(duration);
    mojo.setLog(getLog());
    mojo.setPluginContext(getPluginContext());
    mojo.setApplicationContextUri(applicationContextUri);
    mojo.setFileApplicationContextUri(fileApplicationContextUri);
    try {
      mojo.executeWithoutWrapping();
    }
 catch (    Exception e) {
      getLog().error("Failed to run Camel embedded: " + e,e);
    }
  }
}
