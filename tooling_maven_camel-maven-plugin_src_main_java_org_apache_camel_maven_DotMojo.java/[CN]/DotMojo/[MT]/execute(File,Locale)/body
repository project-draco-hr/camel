{
  outputDir.mkdirs();
  List<File> files=new ArrayList<File>();
  appendFiles(files,resources);
  if (graphvizOutputTypes == null) {
    if (graphvizOutputType == null) {
      graphvizOutputTypes=DEFAULT_GRAPHVIZ_OUTPUT_TYPES;
    }
 else {
      graphvizOutputTypes=new String[]{graphvizOutputType};
    }
  }
  try {
    PrintWriter out=new PrintWriter(htmlBuffer);
    printHtmlHeader(out);
    for (int i=0; i < files.size(); i++) {
      File file=(File)((List)files).get(i);
      printHtmlFileHeader(out,file);
      for (int j=0; j < graphvizOutputTypes.length; j++) {
        String format=graphvizOutputTypes[j];
        String generated=convertFile(file,format);
        if (format.equals("cmapx")) {
          addFileToBuffer(out,new File(generated));
        }
      }
      printHtmlFileFooter(out,file);
    }
    printHtmlFooter(out);
  }
 catch (  CommandLineException e) {
    throw new MojoExecutionException("Failed: " + e,e);
  }
}
