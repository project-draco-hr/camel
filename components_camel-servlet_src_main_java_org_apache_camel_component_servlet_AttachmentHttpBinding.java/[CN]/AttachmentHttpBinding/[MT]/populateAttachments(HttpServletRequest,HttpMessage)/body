{
  try {
    Collection<Part> parts=request.getParts();
    for (    Part part : parts) {
      DataSource ds=new PartDataSource(part);
      Attachment attachment=new DefaultAttachment(ds);
      for (      String headerName : part.getHeaderNames()) {
        for (        String headerValue : part.getHeaders(headerName)) {
          attachment.addHeader(headerName,headerValue);
        }
      }
      message.addAttachmentObject(part.getName(),attachment);
    }
  }
 catch (  Exception e) {
    throw new RuntimeCamelException("Cannot populate attachments",e);
  }
}
