{
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedMinimumMessageCount(3);
  mock.message(0).body().isEqualTo("Hello");
  mock.message(1).body().isEqualTo("there");
  mock.message(2).body().isEqualTo("World");
  FileOutputStream fos=refreshFile(null);
  fos.write("Hello\n".getBytes());
  Thread.sleep(150);
  fos.write("there\n".getBytes());
  fos=refreshFile(fos);
  Thread.sleep(150);
  fos.write("World\n".getBytes());
  Thread.sleep(150);
  fos=refreshFile(fos);
  Thread.sleep(150);
  fos.write("!\n".getBytes());
  fos.close();
  assertMockEndpointsSatisfied();
}
