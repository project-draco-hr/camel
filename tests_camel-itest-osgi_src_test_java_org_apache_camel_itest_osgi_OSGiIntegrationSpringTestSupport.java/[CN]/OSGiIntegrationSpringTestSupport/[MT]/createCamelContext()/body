{
  applicationContext=createApplicationContext();
  assertNotNull("Should have created a valid spring context",applicationContext);
  applicationContext.setBundleContext(bundleContext);
  applicationContext.refresh();
  String[] names=applicationContext.getBeanNamesForType(SpringCamelContext.class);
  if (names.length == 1) {
    return (SpringCamelContext)applicationContext.getBean(names[0],SpringCamelContext.class);
  }
 else {
    throw new RuntimeCamelException("can't create a right camel context from the application context");
  }
}
