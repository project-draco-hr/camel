{
  URI dispatchUri=null;
  Exchange reply=null;
  if (LOG.isDebugEnabled()) {
    LOG.debug("Dispatching exchange" + exchange + "to endpoint "+ endpoint.getEndpointUri());
  }
  dispatchUri=selectDispatchUri(endpoint,exchange);
  if (exchange.getPattern() == ExchangePattern.InOnly) {
    reply=producer.send(dispatchUri.toASCIIString(),exchange);
  }
 else {
    reply=(Exchange)issueRequest(endpoint,ExchangePattern.InOut,exchange.getIn().getBody(),exchange.getIn().getHeaders());
  }
  return reply;
}
