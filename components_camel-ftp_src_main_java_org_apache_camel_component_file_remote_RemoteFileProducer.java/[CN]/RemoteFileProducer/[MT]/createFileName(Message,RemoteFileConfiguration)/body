{
  String answer;
  String endpointFileName=fileConfig.getFile();
  String headerFileName=message.getHeader(FileComponent.HEADER_FILE_NAME,String.class);
  if (fileConfig.isDirectory()) {
    String baseDir="";
    if (endpointFileName.length() > 0) {
      baseDir=endpointFileName + (endpointFileName.endsWith("/") ? "" : "/");
    }
    String fileName=(headerFileName != null) ? headerFileName : message.getMessageId();
    answer=baseDir + fileName;
  }
 else {
    answer=endpointFileName;
  }
  return answer;
}
