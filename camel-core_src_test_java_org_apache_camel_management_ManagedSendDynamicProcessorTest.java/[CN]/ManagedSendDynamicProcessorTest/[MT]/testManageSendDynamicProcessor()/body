{
  if (isPlatform("aix")) {
    return;
  }
  MockEndpoint foo=getMockEndpoint("mock:foo");
  foo.expectedMessageCount(2);
  MockEndpoint bar=getMockEndpoint("mock:bar");
  bar.expectedMessageCount(1);
  template.sendBodyAndHeader("direct:start","Hello World","whereto","foo");
  template.sendBodyAndHeader("direct:start","Bye World","whereto","foo");
  template.sendBodyAndHeader("direct:start","Hi World","whereto","bar");
  assertMockEndpointsSatisfied();
  MBeanServer mbeanServer=getMBeanServer();
  ObjectName on=ObjectName.getInstance("org.apache.camel:context=camel-1,type=processors,name=\"mysend\"");
  String routeId=(String)mbeanServer.getAttribute(on,"RouteId");
  assertEquals("route1",routeId);
  String camelId=(String)mbeanServer.getAttribute(on,"CamelId");
  assertEquals("camel-1",camelId);
  String state=(String)mbeanServer.getAttribute(on,"State");
  assertEquals(ServiceStatus.Started.name(),state);
  String uri=(String)mbeanServer.getAttribute(on,"Uri");
  assertEquals("direct:${header.whereto}",uri);
  String pattern=(String)mbeanServer.getAttribute(on,"MessageExchangePattern");
  assertNull(pattern);
  TabularData data=(TabularData)mbeanServer.invoke(on,"extendedInformation",null,null);
  assertNotNull(data);
  assertEquals(2,data.size());
  data=(TabularData)mbeanServer.invoke(on,"explain",new Object[]{false},new String[]{"boolean"});
  assertNotNull(data);
  assertEquals(2,data.size());
  data=(TabularData)mbeanServer.invoke(on,"explain",new Object[]{true},new String[]{"boolean"});
  assertNotNull(data);
  assertEquals(6,data.size());
  String json=(String)mbeanServer.invoke(on,"informationJson",null,null);
  assertNotNull(json);
  assertTrue(json.contains("\"description\": \"Sends the message to a dynamic endpoint (uri supports languages)"));
  assertTrue(json.contains(" \"uri\": { \"kind\": \"attribute\", \"required\": \"true\", \"type\": \"string\", \"javaType\": \"java.lang.String\"," + " \"deprecated\": \"false\", \"value\": \"direct:${header.whereto}\""));
}
