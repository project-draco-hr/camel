{
  if (LOG.isDebugEnabled()) {
    LOG.debug(endpoint + " consumer receiving JMS message: " + message);
  }
  RuntimeCamelException rce=null;
  try {
    Destination replyDestination=getReplyToDestination(message);
    final JmsExchange exchange=createExchange(message,replyDestination);
    if (eagerLoadingOfProperties) {
      exchange.getIn().getHeaders();
    }
    processor.process(exchange);
    JmsMessage body=null;
    Exception cause=null;
    boolean sendReply=false;
    if (exchange.isFailed()) {
      if (exchange.getException() != null) {
        if (endpoint.isTransferException()) {
          body=null;
          cause=exchange.getException();
          sendReply=true;
        }
 else {
          rce=wrapRuntimeCamelException(exchange.getException());
        }
      }
 else       if (exchange.getFault().getBody() != null) {
        body=exchange.getFault();
        sendReply=true;
      }
    }
 else     if (exchange.hasOut()) {
      body=exchange.getOut();
      sendReply=true;
    }
    if (rce == null && sendReply && !disableReplyTo && exchange.getPattern().isOutCapable()) {
      sendReply(replyDestination,message,exchange,body,cause);
    }
  }
 catch (  Exception e) {
    rce=wrapRuntimeCamelException(e);
  }
  if (rce != null) {
    getExceptionHandler().handleException(rce);
    throw rce;
  }
}
