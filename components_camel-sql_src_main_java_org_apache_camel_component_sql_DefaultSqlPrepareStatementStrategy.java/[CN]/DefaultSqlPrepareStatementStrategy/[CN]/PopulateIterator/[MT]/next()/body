{
  if (nextParam == null) {
    throw new NoSuchElementException();
  }
  boolean in=false;
  if (nextParam.startsWith("in:")) {
    in=true;
    nextParam=nextParam.substring(3);
  }
  Object next=null;
  try {
    next=lookupParameter(nextParam,exchange,body);
    if (in && next != null) {
      next=createInParameterIterator(next);
    }
    if (next == null) {
      throw new RuntimeExchangeException(String.format(MISSING_PARAMETER_EXCEPTION,nextParam,query),exchange);
    }
  }
  finally {
    nextParam=parser.next();
  }
  return next;
}
