{
  List<Processor> list=getProcessors();
  if (!list.isEmpty()) {
    Processor processor=chooseProcessor(list,exchange);
    if (processor == null) {
      throw new IllegalStateException("No processors could be chosen to process " + exchange);
    }
 else {
      AsyncProcessor albp=AsyncProcessorTypeConverter.convert(processor);
      boolean sync=AsyncProcessorHelper.process(albp,exchange,new AsyncCallback(){
        public void done(        boolean doneSync){
          if (doneSync) {
            return;
          }
          callback.done(false);
        }
      }
);
      if (!sync) {
        return false;
      }
      callback.done(true);
      return true;
    }
  }
  callback.done(true);
  return true;
}
