{
  MinaEndpoint endpoint=map.get(uri);
  if (endpoint == null) {
    IoAcceptor acceptor=new VmPipeAcceptor();
    endpoint=new MinaEndpoint(uri,getContext(),acceptor);
    VmPipeAddress address=new VmPipeAddress(8080);
    acceptor.bind(address,endpoint.getServerHandler());
    VmPipeConnector connector=new VmPipeConnector();
    ConnectFuture future=connector.connect(address,endpoint.getClientHandler());
    future.join();
    IoSession session=future.getSession();
    endpoint.setSession(session);
    map.put(uri,endpoint);
  }
  return endpoint;
}
