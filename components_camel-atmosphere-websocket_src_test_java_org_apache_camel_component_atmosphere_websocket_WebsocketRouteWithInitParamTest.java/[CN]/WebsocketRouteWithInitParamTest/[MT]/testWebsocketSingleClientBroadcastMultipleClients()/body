{
  final int awaitTime=5;
  connectionKeyUserMap.clear();
  TestClient wsclient1=new TestClient("ws://localhost:" + PORT + "/hola2",2);
  TestClient wsclient2=new TestClient("ws://localhost:" + PORT + "/hola2",2);
  TestClient wsclient3=new TestClient("ws://localhost:" + PORT + "/hola2",2);
  wsclient1.connect();
  wsclient1.await(awaitTime);
  wsclient2.connect();
  wsclient2.await(awaitTime);
  wsclient3.connect();
  wsclient3.await(awaitTime);
  assertTrue(connectionKeyUserMap.size() == EXISTED_USERS.length);
  broadcastMessageTo=new String[]{EXISTED_USERS[0],EXISTED_USERS[1]};
  wsclient1.sendTextMessage("Gambas");
  wsclient1.await(awaitTime);
  List<String> received1=wsclient1.getReceived(String.class);
  assertEquals(1,received1.size());
  for (int i=0; i < broadcastMessageTo.length; i++) {
    assertTrue(received1.get(0).contains(broadcastMessageTo[i]));
  }
  List<String> received2=wsclient2.getReceived(String.class);
  assertEquals(1,received2.size());
  for (int i=0; i < broadcastMessageTo.length; i++) {
    assertTrue(received2.get(0).contains(broadcastMessageTo[i]));
  }
  List<String> received3=wsclient3.getReceived(String.class);
  assertEquals(0,received3.size());
  wsclient1.close();
  wsclient2.close();
  wsclient3.close();
}
