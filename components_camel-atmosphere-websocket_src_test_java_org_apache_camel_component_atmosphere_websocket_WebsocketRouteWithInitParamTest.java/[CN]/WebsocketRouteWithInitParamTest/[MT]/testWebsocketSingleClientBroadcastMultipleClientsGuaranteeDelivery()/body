{
  final int AWAIT_TIME=5;
  connectionKeyUserMap.clear();
  TestClient wsclient1=new TestClient("ws://localhost:" + PORT + "/hola3",2);
  TestClient wsclient2=new TestClient("ws://localhost:" + PORT + "/hola3",2);
  TestClient wsclient3=new TestClient("ws://localhost:" + PORT + "/hola3",2);
  wsclient1.connect();
  wsclient1.await(AWAIT_TIME);
  wsclient2.connect();
  wsclient2.await(AWAIT_TIME);
  wsclient3.connect();
  wsclient3.await(AWAIT_TIME);
  assertTrue(connectionKeyUserMap.size() == EXISTED_USERS.length);
  wsclient2.close();
  wsclient2.await(AWAIT_TIME);
  BROADCAST_MESSAGE_TO=new String[]{EXISTED_USERS[0],EXISTED_USERS[1]};
  wsclient1.sendTextMessage("Gambas");
  wsclient1.await(AWAIT_TIME);
  List<String> received1=wsclient1.getReceived(String.class);
  assertEquals(1,received1.size());
  for (int i=0; i < BROADCAST_MESSAGE_TO.length; i++) {
    assertTrue(received1.get(0).contains(BROADCAST_MESSAGE_TO[i]));
  }
  List<String> received2=wsclient2.getReceived(String.class);
  assertEquals(0,received2.size());
  List<String> received3=wsclient3.getReceived(String.class);
  assertEquals(0,received3.size());
  wsclient1.close();
  wsclient3.close();
}
