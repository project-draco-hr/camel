{
  boolean pubSubDomain=false;
  if (remaining.startsWith(QUEUE_PREFIX)) {
    pubSubDomain=false;
    remaining=removeStartingCharacters(remaining.substring(QUEUE_PREFIX.length()),'/');
  }
 else   if (remaining.startsWith(TOPIC_PREFIX)) {
    pubSubDomain=true;
    remaining=removeStartingCharacters(remaining.substring(TOPIC_PREFIX.length()),'/');
  }
  final String subject=convertPathToActualDestination(remaining);
  JmsConfiguration newConfiguration=getConfiguration().copy();
  JmsEndpoint endpoint;
  if (pubSubDomain) {
    endpoint=new JmsEndpoint(uri,this,subject,pubSubDomain,newConfiguration);
  }
 else {
    endpoint=new JmsQueueEndpoint(uri,this,subject,newConfiguration);
  }
  String selector=(String)parameters.remove("selector");
  if (selector != null) {
    endpoint.setSelector(selector);
  }
  setProperties(endpoint.getConfiguration(),parameters);
  return endpoint;
}
