{
  Source sourcePayload=exchange.getIn().getMandatoryBody(Source.class);
  String endpointUri=exchange.getIn().getHeader(SpringWebserviceConstants.SPRING_WS_ENDPOINT_URI,String.class);
  String soapAction=exchange.getIn().getHeader(SpringWebserviceConstants.SPRING_WS_SOAP_ACTION,String.class);
  URI wsAddressingAction=exchange.getIn().getHeader(SpringWebserviceConstants.SPRING_WS_ADDRESSING_ACTION,URI.class);
  WebServiceMessageCallback callback=new DefaultWebserviceMessageCallback(soapAction,wsAddressingAction);
  Object body=null;
  if (endpointUri != null) {
    body=endpoint.getConfiguration().getWebServiceTemplate().sendSourceAndReceive(endpointUri,sourcePayload,callback,SOURCE_EXTRACTOR);
  }
 else {
    body=endpoint.getConfiguration().getWebServiceTemplate().sendSourceAndReceive(sourcePayload,callback,SOURCE_EXTRACTOR);
  }
  exchange.getOut().setBody(body);
}
