{
  MockEndpoint mock=getMockEndpoint("mock:result");
  mock.expectedBodiesReceived("My name is Arnio");
  template.sendBody("activemq:queue:hello","Hello, I'm here");
  Thread.sleep(1000);
  JmsTemplate jms=new JmsTemplate(amq.getConfiguration().getConnectionFactory());
  TextMessage msg=(TextMessage)jms.receive("nameRequestor");
  assertEquals("What's your name",msg.getText());
  Destination replyTo=msg.getJMSReplyTo();
  assertEquals("queue://nameReplyQueue",replyTo.toString());
  template.sendBody("activemq:" + replyTo.toString(),"My name is Arnio");
  Thread.sleep(2000);
  assertMockEndpointsSatisfied();
}
