{
  Map<String,Object> requestContext=CastUtils.cast((Map)message.get(Client.REQUEST_CONTEXT));
  Map<String,Object> responseContext=CastUtils.cast((Map)message.get(Client.RESPONSE_CONTEXT));
  if (requestContext != null) {
    Map<String,Object> realMap=new HashMap<String,Object>();
    WrappedMessageContext ctx=new WrappedMessageContext(realMap,null,Scope.APPLICATION);
    ctx.putAll(requestContext);
    requestContext=realMap;
  }
  if (responseContext == null) {
    responseContext=new HashMap<String,Object>();
  }
 else {
    responseContext.clear();
  }
  context.put(Client.REQUEST_CONTEXT,requestContext);
  context.put(Client.RESPONSE_CONTEXT,responseContext);
  return responseContext;
}
