{
  Message answer=exchange.getInMessage();
  CxfMessage in=exchange.getIn();
  Object body=in.getBody(List.class);
  if (body instanceof List) {
    answer.setContent(List.class,body);
    CxfHeaderHelper.propagateCamelToCxf(strategy,in.getHeaders(),answer);
  }
 else {
    body=in.getBody(InputStream.class);
    if (body instanceof InputStream) {
      answer.setContent(InputStream.class,body);
    }
  }
  Map<String,Object> requestContext=CastUtils.cast((Map)answer.get(Client.REQUEST_CONTEXT));
  if (requestContext == null) {
    requestContext=new HashMap<String,Object>();
  }
  if (exchange.getExchange() != null) {
    requestContext.putAll(exchange.getExchange());
  }
  if (exchange.getProperties() != null) {
    requestContext.putAll(exchange.getProperties());
  }
  answer.put(Client.REQUEST_CONTEXT,requestContext);
  return answer;
}
