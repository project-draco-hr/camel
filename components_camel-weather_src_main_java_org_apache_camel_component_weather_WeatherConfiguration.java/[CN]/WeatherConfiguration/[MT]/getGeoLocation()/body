{
  String geoLocation=component.getCamelContext().getTypeConverter().mandatoryConvertTo(String.class,new URL("http://freegeoip.net/json/"));
  if (isEmpty(geoLocation)) {
    throw new IllegalStateException("Retrieved an unexpected value: '" + geoLocation + "' for the geographical location");
  }
  ObjectMapper mapper=new ObjectMapper();
  JsonNode node=mapper.readValue(geoLocation,JsonNode.class);
  JsonNode latitudeNode=notNull(node.get("latitude"),"latitude");
  JsonNode longitudeNode=notNull(node.get("longitude"),"longitude");
  return "lat=" + latitudeNode.toString() + "&lon="+ longitudeNode.toString();
}
