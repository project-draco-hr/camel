{
  int redeliveryCounter=0;
  long redeliveryDelay=0;
  do {
    if (redeliveryCounter > 0) {
      redeliveryDelay=redeliveryPolicy.getRedeliveryDelay(redeliveryDelay);
      sleep(redeliveryDelay);
    }
    try {
      output.process(exchange);
      return;
    }
 catch (    RuntimeException e) {
      logger.log("On delivery attempt: " + redeliveryCounter + " caught: "+ e,e);
    }
    redeliveryCounter=incrementRedeliveryCounter(exchange);
  }
 while (redeliveryPolicy.shouldRedeliver(redeliveryCounter));
  deadLetter.process(exchange);
}
