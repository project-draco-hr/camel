{
  ExchangeHelper.setFailureHandled(exchange);
  decrementRedeliveryCounter(exchange);
  AsyncProcessor afp=AsyncProcessorTypeConverter.convert(data.failureProcessor);
  boolean sync=afp.process(exchange,new AsyncCallback(){
    public void done(    boolean sync){
      LOG.trace("Fault processor done");
      restoreExceptionOnExchange(exchange,data.handledPredicate);
      callback.done(data.sync);
    }
  }
);
  String msg="Failed delivery for exchangeId: " + exchange.getExchangeId() + ". Handled by the failure processor: "+ data.failureProcessor;
  logFailedDelivery(false,exchange,msg,data,null);
  return sync;
}
