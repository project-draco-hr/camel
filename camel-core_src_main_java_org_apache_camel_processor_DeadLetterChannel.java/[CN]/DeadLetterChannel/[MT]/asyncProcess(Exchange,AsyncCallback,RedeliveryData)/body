{
  if (!isRunAllowed()) {
    if (exchange.getException() == null) {
      exchange.setException(new RejectedExecutionException());
    }
    callback.done(data.sync);
    return;
  }
  if (exchange.isTransacted() && exchange.getException() != null) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("This is a transacted exchange, bypassing this DeadLetterChannel: " + this + " for exchange: "+ exchange);
    }
    return;
  }
  if (exchange.getException() != null) {
    handleException(exchange,data);
  }
  boolean shouldRedeliver=shouldRedeliver(exchange,data);
  if (!shouldRedeliver) {
    deliverToFaultProcessor(exchange,callback,data);
    return;
  }
  if (data.redeliveryCounter > 0) {
    if (exchange.getException() != null) {
      exchange.setException(null);
    }
    data.redeliveryDelay=data.currentRedeliveryPolicy.calculateRedeliveryDelay(data.redeliveryDelay,data.redeliveryCounter);
    timer.schedule(new RedeliverTimerTask(exchange,callback,data),data.redeliveryDelay);
    deliverToRedeliveryProcessor(exchange,callback,data);
  }
}
