{
  Map<String,Endpoint> map=getLocalCamelContext().getEndpointMap();
  if (LOG.isTraceEnabled()) {
    LOG.trace("Trying to lookup {} in local map {}",remaining,map.keySet());
  }
  Endpoint endpoint=map.get(remaining);
  if (endpoint != null) {
    logUsingEndpoint(uri,endpoint);
    return new ContextEndpoint(uri,this,endpoint);
  }
  String[] separators={":","://"};
  for (  String scheme : localProtocolSchemes) {
    for (    String separator : separators) {
      String newUri=scheme + separator + remaining;
      endpoint=map.get(newUri);
      if (endpoint != null) {
        logUsingEndpoint(uri,endpoint);
        return new ContextEndpoint(uri,this,endpoint);
      }
    }
  }
  throw new ResolveEndpointFailedException("Cannot find the endpoint with uri " + uri + " in the CamelContext "+ getLocalCamelContext().getName());
}
