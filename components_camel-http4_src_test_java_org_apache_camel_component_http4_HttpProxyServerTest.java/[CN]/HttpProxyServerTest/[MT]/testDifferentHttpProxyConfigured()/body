{
  HttpEndpoint http1=context.getEndpoint("http4://www.google.com?proxyHost=myproxy&proxyPort=1234",HttpEndpoint.class);
  HttpEndpoint http2=context.getEndpoint("http4://www.google.com?proxyHost=myotherproxy&proxyPort=2345",HttpEndpoint.class);
  HttpEndpoint http3=context.getEndpoint("http4://www.google.com?test=parameter",HttpEndpoint.class);
  HttpClient client1=http1.createHttpClient();
  HttpHost proxy1=(HttpHost)client1.getParams().getParameter(ConnRoutePNames.DEFAULT_PROXY);
  assertEquals("myproxy",proxy1.getHostName());
  assertEquals(1234,proxy1.getPort());
  HttpClient client2=http2.createHttpClient();
  HttpHost proxy2=(HttpHost)client2.getParams().getParameter(ConnRoutePNames.DEFAULT_PROXY);
  assertEquals("myotherproxy",proxy2.getHostName());
  assertEquals(2345,proxy2.getPort());
  assertTrue("Get a wrong endpoint uri of http1",http1.getEndpointUri().indexOf("proxyPort=1234") > 0);
  assertTrue("Get a wrong endpoint uri of http2",http2.getEndpointUri().indexOf("proxyHost=myotherproxy") > 0);
  assertEquals("Get a wrong endpoint uri","http4://www.google.com?test=parameter",http3.getEndpointUri());
  assertEquals("Should get the same EndpointKey",http1.getEndpointKey(),http2.getEndpointKey());
}
