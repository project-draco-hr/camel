{
  HttpEndpoint http1=context.getEndpoint("http4://www.google.com?proxyAuthHost=myproxy&proxyAuthPort=1234",HttpEndpoint.class);
  HttpEndpoint http2=context.getEndpoint("http4://www.google.com?test=parameter&proxyAuthHost=myotherproxy&proxyAuthPort=2345",HttpEndpoint.class);
  HttpClient client1=http1.createHttpClient();
  HttpHost proxy1=(HttpHost)client1.getParams().getParameter(ConnRoutePNames.DEFAULT_PROXY);
  assertEquals("myproxy",proxy1.getHostName());
  assertEquals(1234,proxy1.getPort());
  HttpClient client2=http2.createHttpClient();
  HttpHost proxy2=(HttpHost)client2.getParams().getParameter(ConnRoutePNames.DEFAULT_PROXY);
  assertEquals("myotherproxy",proxy2.getHostName());
  assertEquals(2345,proxy2.getPort());
  assertEquals("Get a wrong endpoint uri of http1","http4://www.google.com?proxyAuthHost=myproxy&proxyAuthPort=1234",URISupport.normalizeUri(http1.getEndpointUri()));
  assertEquals("Get a wrong endpoint uri of http2","http4://www.google.com?proxyAuthHost=myotherproxy&proxyAuthPort=2345&test=parameter",URISupport.normalizeUri(http2.getEndpointUri()));
  assertEquals("Should get the same EndpointKey",http1.getEndpointKey(),http2.getEndpointKey());
}
