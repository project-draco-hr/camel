{
  QueueReplyHandler handler=new QueueReplyHandler(replyManager,exchange,callback,originalCorrelationId,correlationId,requestTimeout);
  ReplyHandler result=correlation.put(correlationId,handler,requestTimeout);
  if (result != null) {
    String logMessage=String.format("The correlationId [%s] is not unique.",correlationId);
    log.warn("{}, some reply message would be ignored and the request thread could be blocked.",logMessage);
    throw new IllegalArgumentException(logMessage);
  }
  return correlationId;
}
