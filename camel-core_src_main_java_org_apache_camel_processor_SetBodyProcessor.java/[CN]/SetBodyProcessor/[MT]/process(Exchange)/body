{
  Object newBody=expression.evaluate(exchange,Object.class);
  boolean out=exchange.hasOut();
  Message old=out ? exchange.getOut() : exchange.getIn();
  Message msg=new DefaultMessage();
  msg.copyFrom(old);
  msg.setBody(newBody);
  if (out) {
    exchange.setOut(msg);
  }
 else {
    exchange.setIn(msg);
  }
}
