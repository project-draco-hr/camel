{
  if (!getEndpoint().isConsumeDelete() || !getEndpoint().isConsumeLockEntity()) {
    return true;
  }
  try {
    LOG.debug("Acquiring exclusive lock on entity: {}",entity);
    if (isSkipLockedEntity()) {
      entityManager.lock(entity,lockModeType,NOWAIT);
    }
 else {
      entityManager.lock(entity,lockModeType);
    }
    return true;
  }
 catch (  Exception e) {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Failed to achieve lock on entity: " + entity + ". Reason: "+ e,e);
    }
    if (e instanceof PessimisticLockException || e instanceof OptimisticLockException) {
      throw (PersistenceException)e;
    }
    if (entity.getClass().isArray()) {
      return true;
    }
    return false;
  }
}
