{
switch (determineOperation(exchange)) {
case createAndRunInstances:
    createAndRunInstance(getEndpoint().getEc2Client(),exchange);
  break;
case startInstances:
startInstances(getEndpoint().getEc2Client(),exchange);
break;
case stopInstances:
stopInstances(getEndpoint().getEc2Client(),exchange);
break;
case terminateInstances:
terminateInstances(getEndpoint().getEc2Client(),exchange);
break;
default :
throw new IllegalArgumentException("Unsupported operation");
}
}
