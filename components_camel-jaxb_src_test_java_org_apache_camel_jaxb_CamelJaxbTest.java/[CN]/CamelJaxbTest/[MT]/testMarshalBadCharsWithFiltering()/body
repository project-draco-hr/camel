{
  PersonType person=new PersonType();
  person.setFirstName("foo\u0004");
  person.setLastName("bar");
  MockEndpoint resultEndpoint=resolveMandatoryEndpoint("mock:result",MockEndpoint.class);
  resultEndpoint.expectedMessageCount(1);
  template.sendBody("direct:marshalFilteringEnabled",person);
  resultEndpoint.assertIsSatisfied();
  String body=resultEndpoint.getReceivedExchanges().get(0).getIn().getBody(String.class);
  assertFalse("Non-xml character wasn't replaced",body.contains("\u0004"));
}
