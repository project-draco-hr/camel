{
  ReportData data=exchange.getIn().getBody(ReportData.class);
  XPathFactory xpfactory=XPathFactory.newInstance();
  XPath xpath=xpfactory.newXPath();
  String city=xpath.evaluate("//forecast_information/city/@data",data.getWeather());
  String cond=xpath.evaluate("//current_conditions/condition/@data",data.getWeather());
  String temp=xpath.evaluate("//current_conditions/temp_c/@data",data.getWeather());
  if (city == null || city.length() == 0) {
    city=data.getCity();
    cond="<error retrieving current condition>";
    temp="<error retrieving current temperature>";
  }
  exchange.getIn().setBody(new StringBuffer().append("\n").append("Weather report for:  ").append(city).append("\n").append("Current condition:   ").append(cond).append("\n").append("Current temperature: ").append(temp).append(" (Celsius)").toString());
}
