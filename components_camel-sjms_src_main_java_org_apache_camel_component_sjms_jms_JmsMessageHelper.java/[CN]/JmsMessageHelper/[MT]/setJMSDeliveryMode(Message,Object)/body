{
  Integer mode;
  if (deliveryMode instanceof String) {
    String s=(String)deliveryMode;
    if ("PERSISTENT".equalsIgnoreCase(s)) {
      mode=DeliveryMode.PERSISTENT;
    }
 else     if ("NON_PERSISTENT".equalsIgnoreCase(s)) {
      mode=DeliveryMode.NON_PERSISTENT;
    }
 else {
      Integer value=null;
      try {
        value=Integer.valueOf(s);
      }
 catch (      NumberFormatException e) {
      }
      if (value != null) {
        mode=value;
      }
 else {
        throw new IllegalArgumentException("Unknown delivery mode with value: " + deliveryMode);
      }
    }
  }
 else   if (deliveryMode instanceof Integer) {
    mode=(Integer)deliveryMode;
  }
 else {
    throw new IllegalArgumentException("Unable to convert the given delivery mode of type " + deliveryMode.getClass().getName() + " with value: "+ deliveryMode);
  }
  message.setJMSDeliveryMode(mode);
}
