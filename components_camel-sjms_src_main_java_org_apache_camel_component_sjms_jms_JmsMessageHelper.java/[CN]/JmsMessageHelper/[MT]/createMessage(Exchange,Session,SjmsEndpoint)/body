{
  Message answer;
  Object body;
  Map<String,Object> bodyHeaders;
  if (exchange.getOut().getBody() != null) {
    body=exchange.getOut().getBody();
    bodyHeaders=new HashMap<String,Object>(exchange.getOut().getHeaders());
  }
 else {
    body=exchange.getIn().getBody();
    bodyHeaders=new HashMap<String,Object>(exchange.getIn().getHeaders());
  }
  answer=createMessage(session,body,bodyHeaders,endpoint);
  return answer;
}
