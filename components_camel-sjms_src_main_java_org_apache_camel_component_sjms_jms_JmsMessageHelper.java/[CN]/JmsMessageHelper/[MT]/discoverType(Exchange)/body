{
  JmsMessageType answer=(JmsMessageType)exchange.getIn().getHeader(JMS_MESSAGE_TYPE);
  if (answer == null) {
    final Object value=exchange.getIn().getBody();
    if (value != null) {
      if (Byte[].class.isInstance(value)) {
        answer=JmsMessageType.Bytes;
      }
 else       if (Collection.class.isInstance(value)) {
        answer=JmsMessageType.Map;
      }
 else       if (String.class.isInstance(value)) {
        answer=JmsMessageType.Text;
      }
 else       if (Serializable.class.isInstance(value)) {
        answer=JmsMessageType.Object;
      }
 else {
        answer=JmsMessageType.Message;
      }
    }
  }
  return answer;
}
