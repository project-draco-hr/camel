{
  Exchange exchange=new DefaultExchange(this,pattern);
  Message message=exchange.getIn();
  message.setBody(msg.getBody());
  message.setHeaders(new HashMap<String,Object>(msg.getAttributes()));
  message.setHeader(SqsConstants.MESSAGE_ID,msg.getMessageId());
  message.setHeader(SqsConstants.MD5_OF_BODY,msg.getMD5OfBody());
  message.setHeader(SqsConstants.RECEIPT_HANDLE,msg.getReceiptHandle());
  message.setHeader(SqsConstants.ATTRIBUTES,msg.getAttributes());
  message.setHeader(SqsConstants.MESSAGE_ATTRIBUTES,msg.getMessageAttributes());
  HeaderFilterStrategy headerFilterStrategy=getHeaderFilterStrategy();
  for (  Entry<String,MessageAttributeValue> entry : msg.getMessageAttributes().entrySet()) {
    String header=entry.getKey();
    Object value=translateValue(entry.getValue());
    if (!headerFilterStrategy.applyFilterToExternalHeaders(header,value,exchange)) {
      message.setHeader(header,value);
    }
  }
  return exchange;
}
