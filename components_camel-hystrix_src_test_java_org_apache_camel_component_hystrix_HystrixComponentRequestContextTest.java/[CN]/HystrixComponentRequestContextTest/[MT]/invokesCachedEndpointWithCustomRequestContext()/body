{
  resultEndpoint.expectedMessageCount(1);
  errorEndpoint.expectedMessageCount(0);
  HystrixRequestContext customContext=HystrixRequestContext.initializeContext();
  final Map headers=new HashMap<>();
  headers.put("key","cachedKey");
  headers.put(HystrixConstants.CAMEL_HYSTRIX_REQUEST_CONTEXT,customContext);
  template.sendBodyAndHeaders("body",headers);
  final CountDownLatch latch=new CountDownLatch(1);
  new Thread(new Runnable(){
    @Override public void run(){
      template.sendBodyAndHeaders("body",headers);
      latch.countDown();
    }
  }
).start();
  latch.await(2,TimeUnit.SECONDS);
  assertMockEndpointsSatisfied();
}
